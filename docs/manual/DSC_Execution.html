<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-107286198-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments)};
  gtag('js', new Date());
  gtag('config', 'UA-107286198-1');
</script>

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="ipynb_website:version" content="0.9.3" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<link rel="stylesheet" type="text/css" href="../css/jt.css">

<link rel="stylesheet" type="text/css" href="../css/toc2.css">

<link href="../site_libs/jqueryui-1.11.4/jquery-ui.css">
<link rel="stylesheet" href="../site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<link rel="stylesheet" href="../site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/jquery-ui.min.js"></script>
<script src="../site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="../site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="../site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>

<link rel="stylesheet"
      href="../site_libs/highlightjs-1.1/textmate.css"
      type="text/css" />

<script src="../site_libs/highlightjs-1.1/highlight.js"></script>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>

<script src="../js/doc_toc.js"></script>
<script src="../js/docs.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script>
    MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
        },
        "HTML-CSS": {
            preferredFont: "TeX",
            availableFonts: ["TeX"],
            styles: {
                scale: 110,
                ".MathJax_Display": {
                    "font-size": "110%",
                }
            }
        }
    });
</script>
<script>
function filterDataFrame(id) {
    var input = document.getElementById("search_" + id);
    var filter = input.value.toUpperCase();
    var table = document.getElementById("dataframe_" + id);
    var tr = table.getElementsByTagName("tr");
    // Loop through all table rows, and hide those who don't match the search query
    for (var i = 1; i < tr.length; i++) {
        for (var j = 0; j < tr[i].cells.length; ++j) {
            var matched = false;
            if (tr[i].cells[j].innerHTML.toUpperCase().indexOf(filter) != -1) {
                tr[i].style.display = "";
                matched = true
                break;
            }
            if (!matched)
                tr[i].style.display = "none";
        } 
    }
}
function sortDataFrame(id, n, dtype) {
    var table = document.getElementById("dataframe_" + id);
    var tb = table.tBodies[0]; // use `<tbody>` to ignore `<thead>` and `<tfoot>` rows
    var tr = Array.prototype.slice.call(tb.rows, 0); // put rows into array
    if (dtype === 'numeric') {
        var fn = function(a, b) { 
            return parseFloat(a.cells[n].textContent) <= parseFloat(b.cells[n].textContent) ? -1 : 1;
        }
    } else {
        var fn = function(a, b) {
            var c = a.cells[n].textContent.trim().localeCompare(b.cells[n].textContent.trim()); 
            return c > 0 ? 1 : (c < 0 ? -1 : 0) }
    }
    var isSorted = function(array, fn) {
        if (array.length < 2)
            return 1;
        var direction = fn(array[0], array[1]); 
        for (var i = 1; i < array.length - 1; ++i) {
            var d = fn(array[i], array[i+1]);
            if (d == 0)
                continue;
            else if (direction == 0)
                direction = d;
            else if (direction != d)
                return 0;
            }
        return direction;
    }
    var sorted = isSorted(tr, fn);
    if (sorted == 1 || sorted == -1) {
        // if sorted already, reverse it
        for(var i = tr.length - 1; i >= 0; --i)
            tb.appendChild(tr[i]); // append each row in order
    } else {
        tr = tr.sort(fn);
        for(var i = 0; i < tr.length; ++i)
            tb.appendChild(tr[i]); // append each row in order
    }
}
</script>

<script>
$( document ).ready(function(){
            var cfg={'threshold':3,     // depth of toc (number of levels)
             'number_sections': false,
             'toc_cell': false,          // useless here
             'toc_window_display': true, // display the toc window
             "toc_section_display": "block", // display toc contents in the window
             'sideBar':true,       // sidebar or floating window
             'navigate_menu':false       // navigation menu (only in liveNotebook -- do not change)
            }
            var st={};                  // some variables used in the script
            st.rendering_toc_cell = false;
            st.config_loaded = false;
            st.extension_initialized=false;
            st.nbcontainer_marginleft = $('#notebook-container').css('margin-left')
            st.nbcontainer_marginright = $('#notebook-container').css('margin-right')
            st.nbcontainer_width = $('#notebook-container').css('width')
            st.oldTocHeight = undefined
            st.cell_toc = undefined;
            st.toc_index=0;
            // fire the main function with these parameters
            table_of_contents(cfg, st);
            var file=manualDict[$("h1:first").attr("id")];
            $("#toc-level0 a").css("color","#126dce");
            $('a[href="#'+$("h1:first").attr("id")+'"]').hide()
            var docs=manualArray;
            var pos=manualArray.indexOf(file);
            for (var a=pos;a>=0;a--){
                  var name=docs[a]
                  $('<li><a href="'+name+'.html"><font color="#073642"><b>'+name.replace(/_/g," ")+'</b></font></a></li>').insertBefore("#toc-level0 li:eq(0)");
            }
            $('a[href="'+file+'.html'+'"]').css("color","#126dce");
            for (var a=pos+1;a<docs.length;a++){
                  var name=docs[a]
                  $(".toc #toc-level0").append('<li><a href="'+name+'.html"><font color="#073642"><b>'+name.replace(/_/g," ")+'</b></font></a></li>');
            }
            $("#toc-header").hide();
    });
</script>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');
  // mark it active
  menuAnchor.parent().addClass('active');
  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>
<div class="container-fluid main-container">
<!-- tabsets -->
<script src="../site_libs/navigation-1.1/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>



<title>Dynamic Statistical Comparisons</title>

<style type = "text/css">
body {
  font-family: "Droid Sans";
  padding-top: 66px;
  padding-bottom: 40px;
}
</style>
</head>

<body>
<div tabindex="-1" id="notebook" class="border-box-sizing">
<div class="container" id="notebook-container">

<!-- code folding -->

<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">Dynamic Statistical Comparisons</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
<li>
  <a href="../index.html">Overview</a>
</li>
        
<li>
  <a href="../quick_start.html">Quick Start</a>
</li>
        
<li>
  <a href="../manual.html">Manual</a>
</li>
        
<li>
  <a href="../tutorials.html">Tutorials</a>
</li>
        
<li>
  <a href="../examples.html">Examples</a>
</li>
        
      </ul>
        
<ul class="nav navbar-nav navbar-right">
<li>
   <a href="https://github.com/stephenslab/dsc2"> <span class="fa fa-github"></span> </a>
</li>
</ul>
        
      </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="DSC-syntax:-basics-of-benchmark-execution">DSC syntax: basics of benchmark execution<a class="anchor-link" href="#DSC-syntax:-basics-of-benchmark-execution">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This document is continuation of discussion in <a href="DSC_Configuration.html">DSC syntax: basics of modules</a>. We will use toy DSC examples (including breaking down <a href="https://github.com/stephenslab/dsc2/blob/master/vignettes/one_sample_location/settings.dsc">this toy</a>) to introduce a special syntax block called <code>DSC</code> that defines benchmark pipelines and execution. This block has a reserved headline <code>DSC</code> and is required for all DSC scripts. In this document we refer to its contents by <code>DSC::&lt;key&gt;</code> where <code>&lt;key&gt;</code> is the identifier on the left side of <code>:</code> in each line of the <code>DSC</code> block.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Pipeline-operators">Pipeline operators<a class="anchor-link" href="#Pipeline-operators">&#182;</a></h2><p>To put together modules into pipelines, two logic are available: "alternating" modules refers to groups of modules that achieve the same goal (able to take similar input and provide the same type of output) as if they are exchangable; "concatenating" modules refers to groups of modules that acts one after another as if concatenated into a chain of actions. These logic are implemented via <code>*</code>, <code>,</code> and <code>()</code> operators:</p>
<ul>
<li><code>*</code>: connects concatenating modules, ie, right hand side (RHS) is executed after the left hand side (LHS).</li>
<li><code>,</code>: connects alternating modules, ie, RHS and LHS are exchangable.</li>
<li><code>()</code>: when alternating modules and concatenating modules are combined, it is used to re-define operator precedence (by default <code>*</code> has higher precedence than <code>,</code>).</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Module-ensembles-and-pipelines">Module ensembles and pipelines<a class="anchor-link" href="#Module-ensembles-and-pipelines">&#182;</a></h2><p><code>DSC::define</code> defines module ensembles, that is, groups of "alternating" or "concatenating" modules. For example:</p>

<pre><code>normal, t: rnorm.R, rt.R
    ...
mean, median: mean.R, median.R
    ...

DSC:
    define:
      simulate: normal, t
      estimate: mean, median</code></pre>
<p>Here 2 ensembles are defined: <code>simulate</code>, of alternating modules <code>normal</code> and <code>t</code> for data generation, and <code>estimate</code>, of alternating modules <code>mean</code> and <code>median</code> for parameter estimation.</p>
<p>To illustrate concatenating modules and its combination with alternating modules we can add an additional <code>winsorize</code> module to <code>estimate</code>:</p>

<pre><code>DSC:
    define:
      simulate: normal, t
      winsorized_estimate: winsorize * (mean, median)</code></pre>
<p>These ensembles, once defined, can be used as if they are modules, to define DSC benchmark as will be discussed next.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="DSC-benchmark">DSC benchmark<a class="anchor-link" href="#DSC-benchmark">&#182;</a></h2><p>DSC benchmark, defined by <code>DSC::run</code>, is one or multiple DSC pipelines each consisted of logically connected modules or module ensembles via pipeline operators. We will use a series of examples to illustrate how benchmarks are created.</p>
<h4 id="Example-1:-ensembles-in-pipeline">Example 1: ensembles in pipeline<a class="anchor-link" href="#Example-1:-ensembles-in-pipeline">&#182;</a></h4>
<pre><code>run: simulate * estimate * score</code></pre>
<p>Here <code>simulate</code> and <code>estimate</code> are module ensembles (see <code>DSC::define</code> of previous section). This is equivalent to writing:</p>

<pre><code>run: (normal, t) * (mean, median) * score</code></pre>
<h4 id="Example-2:-combination-of-concatenating-and-alternating-modules">Example 2: combination of concatenating and alternating modules<a class="anchor-link" href="#Example-2:-combination-of-concatenating-and-alternating-modules">&#182;</a></h4>
<pre><code>run: simulate * (winsorize * mean, mean) * score</code></pre>
<p>DSC will run 2 types of pipelines: 1) that involves <code>winsorize</code> followed by <code>mean</code>, and 2) "mean" only.</p>
<h4 id="Example-3:-expansion-of-pipeline-operators">Example 3: expansion of pipeline operators<a class="anchor-link" href="#Example-3:-expansion-of-pipeline-operators">&#182;</a></h4>
<pre><code>run: simulate * (voom, sqrt, identity) * (RUV, SVA) * (DESeq, edgeRglm, ash) * score</code></pre>
<p>will be expanded to:</p>

<pre><code>run: simulate * sqrt * RUV * DESeq * score,
   simulate * sqrt * SVA * DESeq * score,
   simulate * identity * RUV * DESeq * score,
   simulate * voom * RUV * DESeq * score,
   simulate * identity * SVA * DESeq * score,
   simulate * voom * SVA * DESeq * score,
   simulate * sqrt * RUV * ash * score,
   simulate * sqrt * RUV * edgeRglm * score,
   simulate * sqrt * SVA * ash * score,
   simulate * sqrt * SVA * edgeRglm * score,
   simulate * identity * RUV * ash * score,
   simulate * voom * RUV * ash * score,
   simulate * identity * RUV * edgeRglm * score,
   simulate * voom * RUV * edgeRglm * score,
   simulate * identity * SVA * ash * score,
   simulate * voom * SVA * ash * score,
   simulate * identity * SVA * edgeRglm * score,
   simulate * voom * SVA * edgeRglm * score</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Command-interface-to-DSC-benchmark">Command interface to DSC benchmark<a class="anchor-link" href="#Command-interface-to-DSC-benchmark">&#182;</a></h2><p>By default, DSC will execute all pipelines defined in <code>DSC::run</code>. But one can overwrite sequence from <a href="Command_Options.html">command line</a>. For example to execute the complete <code>Example 1</code></p>

<pre><code>dsc file.dsc ... --target "simulate * estimate * score"</code></pre>
<p>or a subset of <code>Example 1</code>:</p>

<pre><code>dsc file.dsc ... --target "norm * estimate * score"</code></pre>
<p>You can also execute a single module / ensemble <strong>for debug purpose</strong>:</p>

<pre><code>dsc file.dsc ... --target "simulate"</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Benchmark-parameters">Benchmark parameters<a class="anchor-link" href="#Benchmark-parameters">&#182;</a></h2><p>These parameters are specified in the rest of <code>DSC</code> block:</p>
<ul>
<li><code>DSC::exec_path</code>: search path for executable files.</li>
<li><code>DSC::lib_path</code>: search path for library files, such as R script to be <code>source</code>-ed or Python scripts to be <code>import</code>-ed.</li>
<li><code>DSC::R_libs</code>: check required R libraries and if not available, automatically install them from cran, bioconductor or github. 3 formats are accepted:<ul>
<li><code>&lt;package&gt;</code>: DSC will check / install <code>package</code> from cran or bioconductor.</li>
<li><code>&lt;package@github_repo/subdir&gt;</code>: DSC will install <code>package</code> from <code>github_repo</code> on github. <code>/subdir</code> is optional -- only applicable when the package is not in the root of the repository.</li>
<li><code>&lt;package (version[s])&gt;</code>: DSC will install <code>package</code> and check version as required. A warning message will be generated if version do not match. It is possible to specify several versions such as <code>edgeR (3.12.0, 3.12.1)</code> or simply <code>edgeR (3.12.0+)</code>.</li>
</ul>
</li>
<li><code>python_modules</code>: check required Python3 modules, and install from pip if not available.</li>
<li><code>work_dir</code>: work directory where benchmarking will take place.</li>
<li><code>output</code>: folder name to store benchmark output files.</li>
<li><code>global</code>: defines global variables which can be used in definition of modules through <a href="DSC_Configuration.html#Substitution-operator-131">substitution operator <code>$()</code></a>.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Ready-to-indulge?">Ready to indulge?<a class="anchor-link" href="#Ready-to-indulge?">&#182;</a></h2><p>At this point we have covered the basics to compose a DSC benchmark. To see how it works in practice with a simple example, please follow through this <a href="../tutorials/Quick_Start.html">Quick Start tutorial</a>.</p>

</div>
</div>
</div>
<hr>
&copy 2016-2018 <a href="http://home.uchicago.edu/gaow">Gao Wang</a> at Stephens Lab, the University of Chicago.<br>&nbsp;&nbsp;&nbsp;This wiki is available under the <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution license</a> (read <a href="https://creativecommons.org/licenses/by/4.0/legalcode">full legal text</a>).

</div>
</div>
</body>
</html>
