
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="robots" content="noindex">
<meta name="ipynb_website:version" content="0.9.4" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<link rel="stylesheet" type="text/css" href="../css/jt.css">

<link rel="stylesheet" type="text/css" href="../css/toc2.css">

<link href="../site_libs/jqueryui-1.11.4/jquery-ui.css">
<link rel="stylesheet" href="../site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<link rel="stylesheet" href="../site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/jquery-ui.min.js"></script>
<script src="../site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="../site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="../site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>

<link rel="stylesheet"
      href="../site_libs/highlightjs-1.1/textmate.css"
      type="text/css" />

<script src="../site_libs/highlightjs-1.1/highlight.js"></script>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>

<script src="../js/doc_toc.js"></script>
<script src="../js/docs.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script>
    MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
        },
        "HTML-CSS": {
            preferredFont: "TeX",
            availableFonts: ["TeX"],
            styles: {
                scale: 110,
                ".MathJax_Display": {
                    "font-size": "110%",
                }
            }
        }
    });
</script>
<script>
function filterDataFrame(id) {
    var input = document.getElementById("search_" + id);
    var filter = input.value.toUpperCase();
    var table = document.getElementById("dataframe_" + id);
    var tr = table.getElementsByTagName("tr");
    // Loop through all table rows, and hide those who don't match the search query
    for (var i = 1; i < tr.length; i++) {
        for (var j = 0; j < tr[i].cells.length; ++j) {
            var matched = false;
            if (tr[i].cells[j].innerHTML.toUpperCase().indexOf(filter) != -1) {
                tr[i].style.display = "";
                matched = true
                break;
            }
            if (!matched)
                tr[i].style.display = "none";
        }
    }
}
function sortDataFrame(id, n, dtype) {
    var table = document.getElementById("dataframe_" + id);
    var tb = table.tBodies[0]; // use `<tbody>` to ignore `<thead>` and `<tfoot>` rows
    var tr = Array.prototype.slice.call(tb.rows, 0); // put rows into array
    if (dtype === 'numeric') {
        var fn = function(a, b) { 
            return parseFloat(a.cells[n].textContent) <= parseFloat(b.cells[n].textContent) ? -1 : 1;
        }
    } else {
        var fn = function(a, b) {
            var c = a.cells[n].textContent.trim().localeCompare(b.cells[n].textContent.trim()); 
            return c > 0 ? 1 : (c < 0 ? -1 : 0) }
    }
    var isSorted = function(array, fn) {
        if (array.length < 2)
            return 1;
        var direction = fn(array[0], array[1]); 
        for (var i = 1; i < array.length - 1; ++i) {
            var d = fn(array[i], array[i+1]);
            if (d == 0)
                continue;
            else if (direction == 0)
                direction = d;
            else if (direction != d)
                return 0;
            }
        return direction;
    }
    var sorted = isSorted(tr, fn);
    if (sorted == 1 || sorted == -1) {
        // if sorted already, reverse it
        for(var i = tr.length - 1; i >= 0; --i)
            tb.appendChild(tr[i]); // append each row in order
    } else {
        tr = tr.sort(fn);
        for(var i = 0; i < tr.length; ++i)
            tb.appendChild(tr[i]); // append each row in order
    }
}
</script>

<script>
$( document ).ready(function(){
            var cfg={'threshold':3,     // depth of toc (number of levels)
             'number_sections': false,
             'toc_cell': false,          // useless here
             'toc_window_display': true, // display the toc window
             "toc_section_display": "block", // display toc contents in the window
             'sideBar':true,       // sidebar or floating window
             'navigate_menu':false       // navigation menu (only in liveNotebook -- do not change)
            }
            var st={};                  // some variables used in the script
            st.rendering_toc_cell = false;
            st.config_loaded = false;
            st.extension_initialized=false;
            st.nbcontainer_marginleft = $('#notebook-container').css('margin-left')
            st.nbcontainer_marginright = $('#notebook-container').css('margin-right')
            st.nbcontainer_width = $('#notebook-container').css('width')
            st.oldTocHeight = undefined
            st.cell_toc = undefined;
            st.toc_index=0;
            // fire the main function with these parameters
            table_of_contents(cfg, st);
            var file=manualDict[$("h1:first").attr("id")];
            $("#toc-level0 a").css("color","#126dce");
            $('a[href="#'+$("h1:first").attr("id")+'"]').hide()
            var docs=manualArray;
            var docs_map=manualArrayMap;
            var pos=manualArray.indexOf(file);
            for (var a=pos;a>=0;a--){
                  $('<li><a href="'+docs[a]+'.html"><font color="#073642"><b>'+docs_map[docs[a]].replace(/_/g," ")+'</b></font></a></li>').insertBefore("#toc-level0 li:eq(0)");
            }
            $('a[href="'+file+'.html'+'"]').css("color","#126dce");
            for (var a=pos+1;a<docs.length;a++){
                  $(".toc #toc-level0").append('<li><a href="'+docs[a]+'.html"><font color="#073642"><b>'+docs_map[docs[a]].replace(/_/g," ")+'</b></font></a></li>');
            }
            // $("#toc-header").hide(); // comment out because it prevents search bar from displaying
    });
</script>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');
  // mark it active
  menuAnchor.parent().addClass('active');
  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>
<div class="container-fluid main-container">
<!-- tabsets -->
<script src="../site_libs/navigation-1.1/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>



<title>Dynamic Statistical Comparisons</title>

<style type = "text/css">
body {
  font-family: "Droid Sans";
  padding-top: 66px;
  padding-bottom: 40px;
}
</style>
</head>

<body>
<div tabindex="-1" id="notebook" class="border-box-sizing">
<div class="container" id="notebook-container">

<!-- code folding -->

<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">Dynamic Statistical Comparisons</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
<li>
  <a href="../index.html">Home</a>
</li>
        
<li>
  <a href="../tutorials.html">Tutorials</a>
</li>
        
<li>
  <a href="../installation.html">Installation</a>
</li>
        
<li>
  <a href="../examples.html">Examples</a>
</li>
        
<li>
  <a href="../manual.html">Manual</a>
</li>
        
      </ul>
        
<ul class="nav navbar-nav navbar-right">
<li>
   <a href="https://github.com/stephenslab/dsc2"> <span class="fa fa-github"></span> </a>
</li>
</ul>
        
      </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Release-1.0-roadmap">Release 1.0 roadmap<a class="anchor-link" href="#Release-1.0-roadmap">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Unit-tests">Unit tests<a class="anchor-link" href="#Unit-tests">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Module-names">Module names<a class="anchor-link" href="#Module-names">&#182;</a></h3><ul>
<li>[x] module name cannot start with <code>pipeline_</code></li>
<li>[?] module names have to be SQL friendly</li>
<li>[!] modules that are identical in every way except names</li>
<li>[x] module names match number of executables</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Parser">Parser<a class="anchor-link" href="#Parser">&#182;</a></h3><ul>
<li>[] More tests to @FILTER</li>
<li>[x] More tests to @ALIAS</li>
<li>[x] More tests to @CONF</li>
<li>[x] Module inherit omitting exec</li>
<li>[x] No multiple module input <code>$x</code>, <code>$y</code> or any mixture of them with module parameters</li>
<li>[!] All module output in the same block should have same name (a required good practice)</li>
<li>[] <code>DSC::run</code> we support only <code>()</code> <code>*</code> and  <code>,</code></li>
<li>[x] Module names / parameters cannot start / end with <code>_</code> and cannot have <code>.</code> in them</li>
<li>[x] Duplicate module / parameter names</li>
<li>[] Different length of params in different exec. e.g. mybeta = 1,2,3 vs. mybeta = (4,5,6) will lead to file lock fail. </li>
<li>[] Strings ending with <code>,</code> intentionally</li>
<li>[] Check if @ALIAS is of the right type (is a number or str?)</li>
<li>[] Check if all parameter names are of the right type</li>
<li>[x] <code>@FILTER</code> cannot have pipeline variables <code>$</code></li>
<li>[x] Packages installed from github also has version option</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Execution">Execution<a class="anchor-link" href="#Execution">&#182;</a></h3><ul>
<li>[] Identical tasks will result in complaint. check for identical jobs ie same parameter twice </li>
<li>[] Both in <code>DSC::run</code> and in <code>--target</code>: what if the first module has upstream dependency? Should catch and report an error.</li>
<li>[] Unsupported keywords in <code>DSC</code> block</li>
<li>[] Bad pipeline logic specification (resulting in failure as said in #22 )</li>
<li>[] Looped steps. Actually this should be a feature when desired ...</li>
<li>[] Downstream pipeline did not use any of upstream variables</li>
<li>[] All modules are valid (defined)</li>
<li>[x] Find some Rmd source code and test if they work as executables<ul>
<li><code>mashr</code> intro works</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Query">Query<a class="anchor-link" href="#Query">&#182;</a></h3><ul>
<li>[x] dsc-query strip path for dsc_output argument</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Misc">Misc<a class="anchor-link" href="#Misc">&#182;</a></h3><ul>
<li>[x] Do not write library installed files if installation fails</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Documentation">Documentation<a class="anchor-link" href="#Documentation">&#182;</a></h2><p>Add these related discussions to documentation</p>
<h3 id="Best-practices">Best practices<a class="anchor-link" href="#Best-practices">&#182;</a></h3><ul>
<li>[] RE seeds -- users should ensure seeds for modules are always the same, when applicable.</li>
</ul>
<h3 id="Examples">Examples<a class="anchor-link" href="#Examples">&#182;</a></h3><ul>
<li>[x] Convert all previous examples to new syntax</li>
<li>[] Add a tutorial that compares computation time / speed between modules</li>
<li>[] Add a tutorial for benchmark output managing, eg, remove / rerun specified steps and moving project from one computer to another<ul>
<li>Explain how DSC signature works</li>
</ul>
</li>
<li>[] Add a documentation page on remote execution, and a tutorial for it (<code>ash</code> example)</li>
<li>[x] Add a doucmentation for <code>dscrutils</code>, and a tutorial on data extraction using <a href="https://stephenslab.github.io/dsc-wiki/tutorials/Explore_Output.html"><code>one_sample_location</code> example</a>; and update <a href="https://stephenslab.github.io/dsc-wiki/tutorials/Intermediate_R_1.html"><code>ash</code> example</a> to include result exploration</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Engineering">Engineering<a class="anchor-link" href="#Engineering">&#182;</a></h2><ul>
<li>[] Use HDF5 to replace msgpack and reimplement IO_DB to only load the chunk necessary.</li>
<li>[] Optimize <code>build_result_db</code> and <code>build_io_db</code> via line profiler.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Small-features">Small features<a class="anchor-link" href="#Small-features">&#182;</a></h2><ul>
<li>[!] Add exec <code>depend</code> property to track source files</li>
<li>[x] Create a switch / or --debug switch to generate mock run file</li>
<li>[!] Pipeline seed batch has to be used / tested; based on total number of jobs distribute it smartly.</li>
<li>[x] Remove old Rlib info files</li>
<li>[x] Fix github R package arbitary paths</li>
<li>[!] Add tags for queries</li>
<li>[x] Support <code>(N,P):(100,1000)</code></li>
<li>[!] Unsupport nested tuples <code>((100,200),(300,400)), ((9,8))</code> -- i actually have attempted to handle this in R</li>
<li>[!] Properly handle grouped input eg <code>g: (N,P)</code> (then in the table has to have 2 columns g_N and g_P) -- no need. just query with <code>"(N,P)"</code> as a string, otherwise users should use paired parameter.</li>
<li>[x] <code>file()</code> / <code>file(ext)</code> behavior is reversed ... need to fix</li>
<li>[x] Replace eg <code>simulate_n</code> with <code>simulate:n</code> in the column names</li>
<li>[] Reimplement the underlying <code>args</code> and <code>sys.argv</code> for plugins -- make them more general</li>
<li>[x] Support <code>Rmd</code> file as executable</li>
<li>[x] Rmd file chunk name</li>
<li>[x] Make operator <code>Python()</code> smarter, along the lines of <code>R()</code> operator</li>
<li>[] #98 </li>
<li>[] #99</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Major-features">Major features<a class="anchor-link" href="#Major-features">&#182;</a></h2><p>Many were existing features removed due to new syntax and SoS advances etc. We need to bring them back in.</p>
<h3 id="Enhanced-interface-syntax">Enhanced interface syntax<a class="anchor-link" href="#Enhanced-interface-syntax">&#182;</a></h3><ul>
<li>[x] <code>inline</code> executables</li>
</ul>
<h3 id="R-interface">R interface<a class="anchor-link" href="#R-interface">&#182;</a></h3><ul>
<li>[x] Make operator <code>R()</code> smarter: basically make a <code>dscrutils::run_r()</code> function that runs input string as R code and format result as a comma separated string. Raise an error if it fails to format.</li>
<li>[!] <strong>New data exchange format in HDF5</strong><ul>
<li>[x] Might stick to <code>rpy2</code> until we need to support Matlab</li>
</ul>
</li>
<li>[x] New data extraction interface / basic data exploration features in R</li>
<li>[x] A more self-contained way to load DSC related functions: a companion R package eventually?</li>
</ul>
<h3 id="Python-interface">Python interface<a class="anchor-link" href="#Python-interface">&#182;</a></h3><ul>
<li>[x] Switch from RDS/rpy2 to HDF5</li>
</ul>
<h3 id="Shell-command-executable-related-issues">Shell command executable related issues<a class="anchor-link" href="#Shell-command-executable-related-issues">&#182;</a></h3><ul>
<li>[] Multiple output files</li>
<li><p>[] Executable command options</p>

<pre><code>  `exec` specifies the names of executable computational routines as well as their command line arguments if applicable. For example an `exec` entry reads:

   exec: datamaker.R, ms $nsam $nreps -t $theta -seed $seed</code></pre>
<ul>
<li>[] index slicing
<pre><code>Index for parameters, for example `exec: makeped.py $data $output[1]` where `output` parameter takes the form of `output: (1.ped, 1.map), (2.ped, 2.map)`. In this case `output[1]` will only use the first value of each parameter group.</code></pre>
</li>
</ul>
</li>
</ul>
<h3 id="Engineering">Engineering<a class="anchor-link" href="#Engineering">&#182;</a></h3><ul>
<li>[x] optimize performance / minimize overhead to the best of my knowledge<ul>
<li>this is never ending -- i mostly only deal with noticible bottleneck and I use line profiler to identify the culprit.</li>
</ul>
</li>
</ul>
<h3 id="Large-scale-computations">Large scale computations<a class="anchor-link" href="#Large-scale-computations">&#182;</a></h3><ul>
<li>[x] <code>--host</code> option<ul>
<li>To check: <code>scp</code>, <code>ssh</code> commands are available</li>
<li>To sync by DSC: <ul>
<li>the output folder</li>
<li>the host config file</li>
</ul>
</li>
</ul>
</li>
<li>[!] CONF <code>merge</code> feature:
<pre><code> `inline`: True or False, of whether or not an R script is executed inline with the next procedure instead of producing return files. This feature is useful when the cost of computation for a procedure is trivial compared to the cost of storing its output. For example if a simulation procedure is simply `runif(500000)` it makes more sense to save this line of code and execute it inline with the next step, rather than to save a vector of 500,000 random numbers to disk.</code></pre>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Known-issues">Known issues<a class="anchor-link" href="#Known-issues">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>SoS issues that needs to be fixed:</p>
<ul>
<li>[] Build node not working</li>
<li>[] <code>stderr</code> should remove empty files</li>
</ul>
<p>SoS issues that cannot be fixed:</p>
<ul>
<li>Multiple loads of I/O data for each task distribution</li>
</ul>
<p>SoS issues that has been fixed to the best of our knowledge yet might still be problematic:</p>
<ul>
<li>Hang on dead-lock</li>
</ul>

</div>
</div>
</div>
<hr>
Copyright (c) 2016-2018 <a href="http://home.uchicago.edu/gaow">Gao Wang</a>, <a href="http://stephenslab.uchicago.edu">Matthew Stephens</a>, <a href="https://pcarbo.github.io">Peter Carbonetto</a> and contributors.<br>&nbsp;&nbsp;&nbsp; Except where otherwise noted, this website is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/3.0/deed.en_US">Creative Commons Attribution 3.0 Unported License</a>.

</div>
</div>
</body>
</html>
