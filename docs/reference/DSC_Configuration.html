
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="ipynb_website:version" content="0.9.4" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<link rel="stylesheet" type="text/css" href="../css/jt.css">

<link rel="stylesheet" type="text/css" href="../css/toc2.css">

<link href="../site_libs/jqueryui-1.11.4/jquery-ui.css">
<link rel="stylesheet" href="../site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<link rel="stylesheet" href="../site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/jquery-ui.min.js"></script>
<script src="../site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="../site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="../site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>

<link rel="stylesheet"
      href="../site_libs/highlightjs/jnbinder.min.css"
      type="text/css" />

<script src="../site_libs/highlightjs/highlight.dsc.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>

<script src="../js/doc_toc.js"></script>
<script src="../js/docs.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script>
    MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
        },
        "HTML-CSS": {
            preferredFont: "TeX",
            availableFonts: ["TeX"],
            styles: {
                scale: 110,
                ".MathJax_Display": {
                    "font-size": "110%",
                }
            }
        }
    });
</script>
<script>
function filterDataFrame(id) {
    var input = document.getElementById("search_" + id);
    var filter = input.value.toUpperCase();
    var table = document.getElementById("dataframe_" + id);
    var tr = table.getElementsByTagName("tr");
    // Loop through all table rows, and hide those who don't match the search query
    for (var i = 1; i < tr.length; i++) {
        for (var j = 0; j < tr[i].cells.length; ++j) {
            var matched = false;
            if (tr[i].cells[j].innerHTML.toUpperCase().indexOf(filter) != -1) {
                tr[i].style.display = "";
                matched = true
                break;
            }
            if (!matched)
                tr[i].style.display = "none";
        }
    }
}
function sortDataFrame(id, n, dtype) {
    var table = document.getElementById("dataframe_" + id);
    var tb = table.tBodies[0]; // use `<tbody>` to ignore `<thead>` and `<tfoot>` rows
    var tr = Array.prototype.slice.call(tb.rows, 0); // put rows into array
    if (dtype === 'numeric') {
        var fn = function(a, b) { 
            return parseFloat(a.cells[n].textContent) <= parseFloat(b.cells[n].textContent) ? -1 : 1;
        }
    } else {
        var fn = function(a, b) {
            var c = a.cells[n].textContent.trim().localeCompare(b.cells[n].textContent.trim()); 
            return c > 0 ? 1 : (c < 0 ? -1 : 0) }
    }
    var isSorted = function(array, fn) {
        if (array.length < 2)
            return 1;
        var direction = fn(array[0], array[1]); 
        for (var i = 1; i < array.length - 1; ++i) {
            var d = fn(array[i], array[i+1]);
            if (d == 0)
                continue;
            else if (direction == 0)
                direction = d;
            else if (direction != d)
                return 0;
            }
        return direction;
    }
    var sorted = isSorted(tr, fn);
    if (sorted == 1 || sorted == -1) {
        // if sorted already, reverse it
        for(var i = tr.length - 1; i >= 0; --i)
            tb.appendChild(tr[i]); // append each row in order
    } else {
        tr = tr.sort(fn);
        for(var i = 0; i < tr.length; ++i)
            tb.appendChild(tr[i]); // append each row in order
    }
}
</script>

<script>
$( document ).ready(function(){
            var cfg={'threshold':3,     // depth of toc (number of levels)
             'number_sections': false,
             'toc_cell': false,          // useless here
             'toc_window_display': true, // display the toc window
             "toc_section_display": "block", // display toc contents in the window
             'sideBar':true,       // sidebar or floating window
             'navigate_menu':false       // navigation menu (only in liveNotebook -- do not change)
            }
            var st={};                  // some variables used in the script
            st.rendering_toc_cell = false;
            st.config_loaded = false;
            st.extension_initialized=false;
            st.nbcontainer_marginleft = $('#notebook-container').css('margin-left')
            st.nbcontainer_marginright = $('#notebook-container').css('margin-right')
            st.nbcontainer_width = $('#notebook-container').css('width')
            st.oldTocHeight = undefined
            st.cell_toc = undefined;
            st.toc_index=0;
            // fire the main function with these parameters
            table_of_contents(cfg, st);
            var file=referenceDict[$("h1:first").attr("id")];
            $("#toc-level0 a").css("color","#126dce");
            $('a[href="#'+$("h1:first").attr("id")+'"]').hide()
            var docs=referenceArray;
            var docs_map=referenceArrayMap;
            var pos=referenceArray.indexOf(file);
            for (var a=pos;a>=0;a--){
                  $('<li><a href="'+docs[a]+'.html"><font color="#073642"><b>'+docs_map[docs[a]].replace(/_/g," ")+'</b></font></a></li>').insertBefore("#toc-level0 li:eq(0)");
            }
            $('a[href="'+file+'.html'+'"]').css("color","#126dce");
            for (var a=pos+1;a<docs.length;a++){
                  $(".toc #toc-level0").append('<li><a href="'+docs[a]+'.html"><font color="#073642"><b>'+docs_map[docs[a]].replace(/_/g," ")+'</b></font></a></li>');
            }
            // $("#toc-header").hide(); // comment out because it prevents search bar from displaying
    });
</script>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');
  // mark it active
  menuAnchor.parent().addClass('active');
  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>
<div class="container-fluid main-container">
<!-- tabsets -->
<script src="../site_libs/navigation-1.1/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>



<title>Dynamic Statistical Comparisons</title>

<style type = "text/css">
body {
  font-family: "Droid Sans";
  padding-top: 66px;
  padding-bottom: 40px;
}
</style>
</head>

<body>
<div tabindex="-1" id="notebook" class="border-box-sizing">
<div class="container" id="notebook-container">

<!-- code folding -->

<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">Dynamic Statistical Comparisons</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
<li>
  <a href="../index.html">Home</a>
</li>
        
<li>
  <a href="../tutorials.html">Tutorials</a>
</li>
        
<li>
  <a href="../installation.html">Installation</a>
</li>
        
<li>
  <a href="../FAQ.html">FAQ</a>
</li>
        
<li>
  <a href="../examples.html">Examples</a>
</li>
        
<li>
  <a href="../reference.html">Reference</a>
</li>
        
      </ul>
        
<ul class="nav navbar-nav navbar-right">
<li>
   <a href="https://github.com/stephenslab/dsc"> <span class="fa fa-github"></span> </a>
</li>
</ul>
        
      </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="DSC-syntax:-basics-of-modules">DSC syntax: basics of modules<a class="anchor-link" href="#DSC-syntax:-basics-of-modules">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this document we mainly use partial DSC examples (along the lines of <a href="https://github.com/stephenslab/dsc/blob/master/vignettes/one_sample_location/settings.dsc">this toy</a> but with advanced features not used there) to introduce basic DSC syntax. Before indulging, please refer to <a href="Design_and_Features.html">Design and Features</a> and <a href="Terminology.html">Terminology</a> for high-level discussions that will help better understanding DSC syntax.</p>
<p>We endeavor to maintain DSC syntax simple and intuitive. This documentation covers the basic DSC syntax for users to get started quickly. We will use dedicated tutorial examples on various specific user cases separatedly, such as using other languages / command tools, using DSC in exploratory phase of research projects, and working with remote computers or HPC clusters for large scale computation. (<strong>FIXME: create these tutorials and add links to them</strong>)</p>
<p>A DSC file consists of one or more syntax blocks to configure <em>modules</em>, and one block to configure <em>pipelines</em> and <em>benchmark</em>. Here we focus on discussing modules. DSC pipelines and benchmark execution will be discussed in <a href="DSC_Execution.html">a separate document</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Modules">Modules<a class="anchor-link" href="#Modules">&#182;</a></h2><p>A module block is conceptually consisted of:</p>
<ul>
<li><code>property</code></li>
<li><code>input</code></li>
<li><code>parameters</code></li>
<li><code>output</code></li>
</ul>
<p>and, optionally, <code>decorators</code> that provide customization to flavors of modules. Note that we do not use these exact terms as keywords in module syntax, yet as will be illustrated soon, these components distinguish from each other syntactically.</p>
<h3 id="Module-property">Module property<a class="anchor-link" href="#Module-property">&#182;</a></h3><p>Modules, the building blocks of DSC, can be minimally specified as follows:</p>

<pre><code>normal, t: rnorm.R, rt.R
    n: 1000
    $x: x</code></pre>
<p>Here we focus on the first line (aka the "module property" line):</p>

<pre><code>normal, t: rnorm.R, rt.R</code></pre>
<p>The two elements separated by <code>:</code> are module names and executables. The module named <code>normal</code> corresponds to <code>rnorm.R</code>, <code>t</code> corresponds to <code>rt.R</code>. For cases when there are multiple module names on the left of <code>:</code> yet only one executable on the right, eg:</p>

<pre><code>normal, t: simulate.R</code></pre>
<p>then the two modules will share the same executable (yet, to be discussed later, possibly different module parameters).</p>
<h4 id="Compound-module-executables">Compound module executables<a class="anchor-link" href="#Compound-module-executables">&#182;</a></h4><p>Multiple scripts can be connected with <code>+</code> for one module to allow them be loaded sequentially as if they are concatenated to one script. For example:</p>

<pre><code>method: utils.R + main.R</code></pre>
<p>will load <code>utils.R</code> followed by <code>main.R</code>.</p>
<p><a href="#Tuple-operator-132">Tuple operator</a> <code>()</code> can be used in conjuction with <code>+</code> to expand the logic of concatenation, as a shorthand to define multiple compound executables. For example:</p>

<pre><code>method1, method2: (utils1.R, utils2.R) + main.R</code></pre>
<p>will load <code>utils1.R</code> followed by <code>main.R</code> for module <code>method1</code>, <code>utils2.R</code> followed by <code>main.R</code> for module <code>method2</code>.</p>
<h4 id="Inline-executables">Inline executables<a class="anchor-link" href="#Inline-executables">&#182;</a></h4><p>Instead of having to use scripts to specify module executables, <a href="#Language-interpreters-133">language interpreter</a> operators can be used to define codes for modules inline. For example:</p>

<pre><code>normal: R(x = rnorm(n))
    n: 1000
    $x: x</code></pre>
<p>It can also be combined with scripts as a concatenation:</p>

<pre><code>method: utils.R + R(res = main(...))</code></pre>
<p>Or,</p>

<pre><code>method1, method2: (utils1.R, utils2.R) + R(res = main(...))</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Module-Inheritance">Module Inheritance<a class="anchor-link" href="#Module-Inheritance">&#182;</a></h3><p>Modules can be <em>inherited</em> as follows, a shorthand to define new modules based on existing ones:</p>

<pre><code>normal: R( x = mu + rnorm(n) )
  n: 100, 1000
  mu: 0
  $data: x
  $true_mean: mu

shifted_normal(normal): 
  mu: 1</code></pre>
<p><code>shifted_normal</code> is a derived module from <code>normal</code>. The complete definition of <code>shifted_normal</code>, after expanding the derived contents, is in fact:</p>

<pre><code>shifted_normal: R( x = mu + rnorm(n) )
  n: 100, 1000
  mu: 1
  $data: x
  $true_mean: mu</code></pre>
<p>The inheritance syntax makes module definitions not only succint but also conceptually more clear to define new modules -- in this example we can tell that <code>shifted_normal</code> is essentially <code>normal</code> with different parameters.</p>
<p>Module inheritance can also be used to add parameters, eg,</p>

<pre><code>normal: R( x = mu + rnorm(n) )
  n: 100, 1000
  mu: 0
  $data: x
  $true_mean: mu

t(normal): R( x = mu + rt(n,df) )
  df: 2</code></pre>
<p>Then <code>t</code> is inherited from <code>normal</code> with a different script and additional parameter, which will get expanded to:</p>

<pre><code>t: R( x = mu + rt(n,df) )
  n: 100, 1000
  mu: 0
  df: 2
  $data: x
  $true_mean: mu</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Module-parameters">Module parameters<a class="anchor-link" href="#Module-parameters">&#182;</a></h3><p>Each module parameter is an indented property under module property line. In the example above, <code>n</code> is module input parameter for both modules <code>normal</code> and <code>t</code>, corresponding to the variable <code>n</code> in both <a href="https://github.com/stephenslab/dsc/blob/master/vignettes/one_sample_location/R/scenarios/rnorm.R">rnorm.R</a> and <a href="https://github.com/stephenslab/dsc/blob/master/vignettes/one_sample_location/R/scenarios/rt.R">rt.R</a> scripts. Here <code>n</code> is set to <code>1000</code>. When set to an array-like value, eg <code>n: 100, 500, 1000</code> then effectively 3 modules are defined for <code>normal</code> and <code>t</code> each. Take <code>normal</code> for example:</p>
<ul>
<li>module 1: <code>rnorm.R</code> with <code>n</code> set to 100</li>
<li>module 2: <code>rnorm.R</code> with <code>n</code> set to 500</li>
<li>module 3: <code>rnorm.R</code> with <code>n</code> set to 1000</li>
</ul>
<p>It is also possible to specify a parameter with groups of values, for example, <code>p: (0.1, 0.9), (0.2, 0.8)</code> will initialize 2 modules each with parameter <code>p</code> of length 2.</p>
<p>When multiple parameters are specified, eg:</p>

<pre><code>    n: 10, 20
    p: 0.1, 0.2</code></pre>
<p>Combinations of parameters (Cartesian product style by default) will be assigned to all modules unless otherwise instructed via <a href="#Decorator-FILTER-123"><code>@FILTER</code></a> decorator. In the example above each module will take 4 sets of parameters : <code>(n = 10, p = 0.1), (n = 10, p = 0.2), (n = 20, p = 0.1), (n = 20, p = 0.2)</code>.</p>
<p>To get "paired" parameters instead, the <a href="#Tuple-operator-132">Tuple operator</a> can be used on both sides of the property. For example,</p>

<pre><code>(n, p): (10, 0.1), (20, 0.2)</code></pre>
<p>results in <code>(n = 10, p = 0.1), (n = 20, p = 0.2)</code>.</p>
<p>Caution that module parameter names must match with variable names, or command-line arguments, for module executables. For example, module parameter <code>n</code> is specified at DSC level and passed to <a href="https://github.com/stephenslab/dsc/blob/master/vignettes/one_sample_location/R/scenarios/rnorm.R">rnorm.R</a> and <a href="https://github.com/stephenslab/dsc/blob/master/vignettes/one_sample_location/R/scenarios/rt.R">rt.R</a> -- neither of these executables has definition for <code>n</code> because they rely on DSC to provide it. It is the user's responsibility to ensure that they match.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Module-output">Module output<a class="anchor-link" href="#Module-output">&#182;</a></h3><p>Module output are pipeline variables that can be accessed by other downstream modules in the pipeline. These variables have a leading <code>$</code> symbol followed by variable names. For example:</p>

<pre><code>normal, t: rnorm.R, rt.R
    n: 1000
    $x: x</code></pre>
<p><code>$x</code> on the left hand side of <code>:</code> is a module output. Under the hood, the <a href="https://github.com/stephenslab/dsc/blob/master/vignettes/one_sample_location/R/scenarios/rnorm.R"><code>rnorm.R</code></a> script generates a variable <code>x</code>, which is an <code>n</code> vector of normally distributed numbers. By specifying <code>$x: x</code>, <code>x</code> becomes a "module output". That is, other downstream steps will be able to use it via <code>$x</code> as their input, as will be discussed later in detail.</p>
<p>Language specific syntax can be used to extract specific data from objects for use as module output. For example <code>$beta: data$meta_info$beta</code> extracts <code>beta</code> from an <code>R</code> nested list and save it directly as module output <code>beta</code>.</p>
<p>For modules whose executables are R or Python scripts, a module output can match any arbitary variable name inside the script, thus may or may not appear in module parameters. In the above example, <code>x</code> is not a module parameter. For command-line executables module output will have to be files (see <a href="#File-generator"><code>file()</code> operator</a> below).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Module-input">Module input<a class="anchor-link" href="#Module-input">&#182;</a></h3><p>Module input are pipeline variables generated by other upstream modules in the pipeline. Same as module output, module input has the pipeline variable syntax <code>$</code> followed by variable names. What distinguishes module input and output syntactically is whether they appear on the left side or the right side of <code>:</code>. For example:</p>

<pre><code>normal, t: rnorm.R, rt.R
    n: 1000
    $x: x

shrink: method.R
    x: $x</code></pre>
<p>Here in the <code>shrink</code> module, <code>$x</code> is a module input, whose value will be assigned to a variable <code>x</code> that will be used in <code>method.R</code> script. The runtime environment determines which module this variable comes from. For example if the pipeline is <code>normal -&gt; shrink</code> then module input <code>$x</code> of <code>shrink</code> is output <code>$x</code> of <code>normal</code> module.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Decorators">Decorators<a class="anchor-link" href="#Decorators">&#182;</a></h2><p>The word "decorator" is borrowed from the term "decorator pattern" in object-oriented programming (a design pattern that allows behavior to be added to an individual object without affecting the behavior of other objects from the same class). A DSC decorator, when applied, will modify behavior of modules specified without impacting other modules in the same syntax block. Available decorators are:</p>
<ul>
<li>@ &lt; module &gt;</li>
<li>@ALIAS</li>
<li>@FILTER</li>
<li>@CONF</li>
</ul>
<p><code>@&lt;module&gt;</code> is specifically used to adjust settings for one module, when multiple modules are specified in the same code block. The other 3 decorators can also be used even when only single module is present in a code block -- this typically applies to derived modules whose behavior is adjusted by decorators to distinguish from the module they inherited.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Module-as-decorator">Module as decorator<a class="anchor-link" href="#Module-as-decorator">&#182;</a></h3><p>Module decorator sepcifies parameters or inputs unique to one module but not applicable to others. for example</p>

<pre><code>normal, t: rnorm.R, rt.R
    n: 1000
    @t:
        df: 5, 10
...</code></pre>
<p>where <code>n</code> is shared by both modules but parameter <code>df</code> is only used by module <code>t</code>. Module decorator always took precedence over parameters / inputs shared by modules when assigning new variables or modify existing ones, that is:</p>

<pre><code>normal, t: rnorm.R, rt.R
    n: 1000
    @t:
        n: 200
...</code></pre>
<p>will set <code>n = 200</code> for <code>t</code>, rather than using <code>n = 1000</code>.</p>
<p>Bulk syntax is supported:</p>

<pre><code>normal, t, cauchy: rnorm.R, rt.R, rcauchy.R
    n: 1000
    @t,cauchy:
        n: 200</code></pre>
<p>Caution that module decorators cannot be used to configure module output variables, because module output are required to be the same for all modules specified in the same syntax block.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Decorator-ALIAS">Decorator ALIAS<a class="anchor-link" href="#Decorator-ALIAS">&#182;</a></h3><p><code>@ALIAS</code> is used to adjust the way inputs and parameters are passed to modules. DSC module parameter are of "simple" types (single elements or an array of single elements). In practice parameters specification may get complicated. <code>@ALIAS</code> can be used to compose a commonly used parameter input theme: all parameters are nested inside a "key-value" system.</p>
<p>For example an R script <code>method.R</code> accepts one "List" variable <code>args</code> that contains <code>var_a</code> and <code>var_b</code>:</p>
<div class="highlight"><pre><span></span>f1 <span class="o">=</span> <span class="kr">function</span><span class="p">(</span>x<span class="p">)</span> <span class="p">{</span> <span class="kc">...</span> <span class="p">}</span>
f2 <span class="o">=</span> <span class="kr">function</span><span class="p">(</span>x<span class="p">)</span> <span class="p">{</span> <span class="kc">...</span> <span class="p">}</span>
result <span class="o">=</span> f1<span class="p">(</span><span class="kp">args</span><span class="o">$</span>var_a<span class="p">)</span> <span class="o">/</span> f2<span class="p">(</span><span class="kp">args</span><span class="o">$</span>var_b<span class="p">)</span>
</pre></div>
<p>Then instead of modifying <code>method.R</code> to take "simple" parameters, we can use <code>@ALIAS</code>,</p>

<pre><code>method: method.R
    a: 1
    b: 2
    @ALIAS: args = List(var_a = a, var_b = b)</code></pre>
<p>such that <code>a</code> and <code>b</code> are properly consolidated into an R List <code>args</code> as <code>var_a</code> and <code>var_b</code> respectively. Currently we allow for <code>List()</code> and <code>Dict()</code> for R's List and Python's Dictionary though more object types may be supported as needed in future versions.</p>
<p>Another usage of <code>@ALIAS</code> is to adjust parameter names for the module specified. For example, suppose the variable <code>n</code> in script <code>rnorm.R</code> is <code>n</code> but in <code>rt.R</code> it is <code>n_samples</code>, then we can use <code>@ALIAS</code> to adjust module <code>t</code>:</p>

<pre><code>normal, t: rnorm.R, rt.R
    n: 1000
    @ALIAS:
        t: n_samples = n</code></pre>
<p>Then <code>n</code> is renamed to <code>n_samples</code> for input to module <code>t</code>.</p>
<p>When both module specific <code>@ALIAS</code> and global <code>@ALIAS</code> are to be specified, one can either use module decorator in combination with <code>@ALIAS</code>, or use wildcard <code>*</code> in addition to module specific adjustment. For example the following two code blocks are equivalent:</p>

<pre><code>normal, t, rcauchy: rnorm.R, rt.R, rcauchy.R
    n: 1000
    mu: 5
    @ALIAS:
        *: args = List(mu)
        t: args = List(mu), n_samples = n</code></pre>

<pre><code>normal, t, rcauchy: rnorm.R, rt.R, rcauchy.R
    n: 1000
    mu: 5
    @ALIAS: args = List(mu)
    @t:
        @ALIAS: args = List(mu), n_samples = n</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Decorator-FILTER">Decorator FILTER<a class="anchor-link" href="#Decorator-FILTER">&#182;</a></h3><p><code>@FILTER</code> can be used to modify default logic that all parameters are combined the Cartesian product style. The <code>@FILTER</code> syntax is the same as the <code>condition</code> statement in <code>dsc-query</code> command; both <a href="DSC_Filtering.html">documented elsewhere</a>. Here we elaborate on some examples:</p>

<pre><code>normal, t: normal.R, t.R
    n: 100, 200, 300, 400, 500
    k: 0, 1
    @FILTER:
        t: (n &lt;= 300 and k = 0) or (n &gt; 300 and k = 1)
        normal: n = 500</code></pre>
<p>Without <code>@FILTER</code> DSC will exhaust all combinations of 5 values of <code>n</code> and 2 of <code>k</code> for both modules, creating a total of 20 parallel jobs. The <code>@FILTER</code> here states that instead of running all 20 jobs, DSC will run for <code>t</code> 3 values from <code>n</code> with <code>k = 0</code>, then run the rest 2 values of <code>n</code> with <code>k = 1</code>, which is a total of 5 jobs for <code>t</code>. Then it runs for <code>normal</code> with <code>n = 500</code> combined with 2 values from <code>k</code>, a total of 2 jobs. Therefore only 7 jobs will be executed after applying the <code>@FILTER</code>.</p>
<p>When no module name is specified, eg. <code>n</code>, then all modules will subject to the filter:</p>

<pre><code>    @FILTER: (n in [100,200,300] and k = 0)</code></pre>
<p>Wildcard <code>*</code> is also supported,</p>

<pre><code>    @FILTER: 
        *: n in [100,200,300]
        t: n = 300</code></pre>
<p>then for <code>t</code> we restrict <code>n</code> to <code>300</code>, and for all other modules we set <code>n</code> to loop over <code>100,200,300</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Decorator-CONF">Decorator CONF<a class="anchor-link" href="#Decorator-CONF">&#182;</a></h3><p><code>@CONF</code> provides interface to override certain properties in benchmark configuration section (<code>DSC</code> section), including <code>work_dir</code>, <code>exec_path</code>, <code>lib_path</code>. See <a href="DSC_Execution.html">this document</a> for more details.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Operators">Operators<a class="anchor-link" href="#Operators">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Tuple-operator">Tuple operator<a class="anchor-link" href="#Tuple-operator">&#182;</a></h3><p>When used to specify module parameters, tuple operator <code>()</code> simply creates grouped values as module parameters, for example</p>

<pre><code>method: method.R
    K: (1,2,3), (4,5,6)</code></pre>
<p>With <code>()</code>, <code>(1,2,3)</code> will be translated as a group to <code>c(1, 2, 3)</code> in <code>R</code>, <code>(1,2,3)</code> in <code>Python</code>, or space separated argument sequence <code>1 2 3</code> for command-line tools. Values will be assigned in groups defined by <code>()</code> instead of separately.</p>
<p>When used to define <a href="#Compound-module-executables">module executables</a>, in conjunction with concatenating operator <code>+</code> it helps matching compound executables to each module in the same block.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Language-interpreters">Language interpreters<a class="anchor-link" href="#Language-interpreters">&#182;</a></h3><p>Currently <code>R()/R{}</code>, <code>Python()/Python{}</code>, and <code>Shell()/Shell{}</code> are supported to specify module parameters. Codes inside these operators will be interpreted while DSC parses the configuration file; output will be evaluated as parameter values. For example <code>n: R((1:5)*10)</code> results in <code>n: (10, 20, 30, 40, 50)</code> and <code>n: R{(1:5)*10}</code> results in <code>n: 10, 20, 30, 40, 50</code>. This provides handy tool for generating input parameters with R, Python or Shell languages.</p>
<p><code>R()</code> and <code>Python()</code> can also be used to <a href="#Inline-executables">create inline module executables</a>. They will be interpreted at runtime as part of the module executable scripts.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Raw-string-indicator">Raw string indicator<a class="anchor-link" href="#Raw-string-indicator">&#182;</a></h3><p>In DSC file, numeric vs. string data-types are automatically determined and there is no need to add quotes (<code>'</code> or <code>"</code>) to strings. This is convenient in most cases but can be problematic when the input are automatically converted to quoted strings when in fact they should not -- such as cases when we want to input a chunk of R codes that will be executed only at runtime not when constructing DSC. <code>raw()</code> indicator will protect them from having quotes added. For example,</p>

<pre><code>g: raw(normalmix(c(2/3,1/3),c(0,0),c(1,2)))</code></pre>
<p>will result in the <code>R</code> code</p>
<div class="highlight"><pre><span></span>g <span class="o">=</span> normalmix<span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="m">2</span><span class="o">/</span><span class="m">3</span><span class="p">,</span><span class="m">1</span><span class="o">/</span><span class="m">3</span><span class="p">),</span><span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">),</span><span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
</pre></div>
<p>which is what we'd expect. But without <code>raw()</code> it will result in <code>R</code> code</p>
<div class="highlight"><pre><span></span>g <span class="o">=</span> <span class="s">&quot;normalmix(c(2/3,1/3),c(0,0),c(1,2))&quot;</span>
</pre></div>
<p>which is problematic.</p>
<p>Since <code>raw()</code> protects its input from any type of conversions, it can be used to pass in <em>strings</em> verbatim, for example:</p>

<pre><code>g: (1, 2, 3)
k: ('1', '2', '3')
l: (raw('1', '2', '3'))</code></pre>
<p>will result in</p>
<div class="highlight"><pre><span></span>g <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
k <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="s">&#39;2&#39;</span><span class="p">,</span> <span class="s">&#39;3&#39;</span><span class="p">)</span>
l <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;&#39;1&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;&#39;2&#39;&quot;</span><span class="p">,</span> <span class="s">&quot;&#39;3&#39;&quot;</span><span class="p">)</span>
</pre></div>
<p>Another example:</p>

<pre><code>normal: R(x &lt;- rnorm(n,mean = mu,sd = 1))
  mu: raw(0.0)</code></pre>
<p>will result in</p>
<div class="highlight"><pre><span></span>x <span class="o">&lt;-</span> rnorm<span class="p">(</span>n<span class="p">,</span>mean <span class="o">=</span> <span class="m">0.0</span><span class="p">,</span>sd <span class="o">=</span> <span class="m">1</span><span class="p">)</span>
</pre></div>
<p>However replacing <code>raw(0.0)</code> with <code>0.0</code> it will result in</p>
<div class="highlight"><pre><span></span>x <span class="o">&lt;-</span> rnorm<span class="p">(</span>n<span class="p">,</span>mean <span class="o">=</span> <span class="m">0</span><span class="p">,</span>sd <span class="o">=</span> <span class="m">1</span><span class="p">)</span>
</pre></div>
<p>Caution that whatever goes into <code>raw()</code> will be treated as strings in the <code>condition</code> parameter of <a href="https://github.com/stephenslab/dsc/blob/master/dscrutils/man/dscquery.Rd"><code>dscrutils::dscquery</code></a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="File-generator">File generator<a class="anchor-link" href="#File-generator">&#182;</a></h3><p><strong>FIXME: multiple output file generator objects are not yet allowed, and will not be available until DSC 0.3.x.</strong></p>
<p>File generator <code>file()</code> will generate two types of files:</p>
<ol>
<li>With an extension specified, eg. <code>file(txt)</code> or equivalently <code>file(.txt)</code> it generates files with unique names in DSC output folder.</li>
<li>Without an extension it generates a temporary file.</li>
</ol>
<h4 id="Extension-specified">Extension specified<a class="anchor-link" href="#Extension-specified">&#182;</a></h4><p>When a parameter specifies a filename yet to be created by a module instance, <code>file()</code> can be used to ensure a file is properly generated without racing with other module instances. This is achieved by properly name the file for each module instance. <code>file()</code> takes a <em>file extension</em> string, and DSC will automatically give it a unique and informative basename. The file can either be a module output that DSC will keep track of as pipeline variable, or an intermediate file that will not be used in other modules. For example:</p>

<pre><code>kinship: kinship.sh ...
    data: $sim
    K: 1, 2, 3, 4, 5
    plink_bed: file(bed)
    $score: file(score)</code></pre>
<p>Here the output <code>score</code> is a file, generated by the module taking parameter <code>data</code> and parameter <code>K</code>. This will result in multiple <code>score</code> output files. Names of these <code>score</code> files will be automatically assigned so that users do not have to worry about naming them.</p>
<p>Parameter <code>plink_bed</code> is also a file, but it is not a module output. This will create a situation where a properly named file <code>*.bed</code> is generated to the output directory yet we do not keep track of it: this means deleting this file manually afterwards will not trigger rerun of the pipelines involved. We keep these files just in case we may want to examine them to debug.</p>
<p>One can also use the <code>.</code> notation for file extensions to enhance readability, for example <code>file(.bed)</code> is equivalent to <code>file(bed)</code>.</p>
<h4 id="Extension-not-specified">Extension not specified<a class="anchor-link" href="#Extension-not-specified">&#182;</a></h4><p>When using <code>file()</code> without specifing the extension, it generates a file path in the system <a href="https://en.wikipedia.org/wiki/Temporary_folder">temporary folder</a> and can be used as a "temp file". It will not appear in users' work directory, and as with other system temp files there is generally no need to worry about their management / maintenance. In the example above the parameter <code>plink_bed</code> can well be made a temporary file if users deem that there is no need to keep it for trouble-shooting:</p>

<pre><code>...
    plink_bed: file()
...</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Improving-DSC-script-readability">Improving DSC script readability<a class="anchor-link" href="#Improving-DSC-script-readability">&#182;</a></h2><h3 id="Use-comments">Use comments<a class="anchor-link" href="#Use-comments">&#182;</a></h3><p>As with many scripting languages (R, Python, shell), <code>#</code> can be used to make human-readable explanation to the contents of DSC script. We suggest using single <code>#</code> to distinguish between various types of syntax groups introduced in this document, and double <code>##</code> to annotate parameters. For example:</p>

<pre><code># Various modules to estimate location parameter
mean, median: mean.R, median.R
    # parameters
    ## set to 0 for no winsorization
    winsorize: 0, 0.02
    # input
    x: $x
    # output
    $mean: mean
    # decorators
    @ALIAS:
        median: w = winsorize</code></pre>
<h3 id="Turn-on-YAML-syntax-highlighter">Turn on YAML syntax highlighter<a class="anchor-link" href="#Turn-on-YAML-syntax-highlighter">&#182;</a></h3><p>Although DSC script is not compatible with YAML, the syntax highlighter for YAML is good enough to enhance readability of DSC scripts. You may turn on the YAML syntax highlighter in your text editor when composing DSC scripts.</p>

</div>
</div>
</div>
<hr>
Copyright (c) 2016-2018 <a href="http://home.uchicago.edu/gaow">Gao Wang</a>, <a href="http://stephenslab.uchicago.edu">Matthew Stephens</a>, <a href="https://pcarbo.github.io">Peter Carbonetto</a> and contributors.<br>&nbsp;&nbsp;&nbsp; Except where otherwise noted, this website is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/3.0/deed.en_US">Creative Commons Attribution 3.0 Unported License</a>.

</div>
</div>
</body>
</html>
