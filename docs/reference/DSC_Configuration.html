<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">

  <title>DSC configuration syntax</title>
  <meta name="description" content="DSC syntax: basics of modules">

  <link rel="canonical" href="https://stephenslab.github.io/dsc-wiki/reference/DSC_Configuration.html">
  <link rel="alternate" type="application/rss+xml" title="DSC" href="https://stephenslab.github.io/dsc-wiki/feed.xml">

  <meta property="og:url"         content="https://stephenslab.github.io/dsc-wiki/reference/DSC_Configuration.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="DSC configuration syntax" />
<meta property="og:description" content="DSC syntax: basics of modules" />
<meta property="og:image"       content="" />


  <script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage":
    "https://stephenslab.github.io/dsc-wiki/reference/DSC_Configuration.html",
  "headline":
    "DSC configuration syntax",
  "datePublished":
    "2019-01-23T16:11:57-06:00",
  "dateModified":
    "2019-01-23T16:11:57-06:00",
  "description":
    "DSC syntax: basics of modules",
  "author": {
    "@type": "Person",
    "name": "Stephens Lab, University of Chicago"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Data 100 at UC Berkeley",
    "logo": {
      "@type": "ImageObject",
      "url": "https://stephenslab.github.io/dsc-wiki",
      "width": 60,
      "height": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "https://stephenslab.github.io/dsc-wiki",
    "height": 60,
    "width": 60
  }
}

  </script>
  <link rel="stylesheet" href="/dsc-wiki/assets/css/styles.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css ">
  <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">

  <!-- <link rel="manifest" href="/manifest.json"> -->
  <!-- <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#efae0a"> -->
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#233947">

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="/dsc-wiki/images/favicon.ico">

  <!-- MathJax Config -->
  <!-- Allow inline math using $ and automatically break long math lines -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    CommonHTML: {
        linebreaks: {
            automatic: true,
        },
    },
});
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML' async></script>

  <!-- DOM updating function -->
  <script>
const runWhenDOMLoaded = cb => {
  if (document.readyState != 'loading') {
    cb()
  } else if (document.addEventListener) {
    document.addEventListener('DOMContentLoaded', cb)
  } else {
    document.attachEvent('onreadystatechange', function() {
      if (document.readyState == 'complete') cb()
    })
  }
}

// Helper function to init things quickly
initFunction = function(myfunc) {
  runWhenDOMLoaded(myfunc);
  document.addEventListener('turbolinks:load', myfunc);
};
</script>

  <!-- Define some javascript variables that will be useful in other javascript -->
  <script>
    const site_basename = '/dsc-wiki';
  </script>

  <!-- Add AnchorJS to let headers be linked -->
  <script src="/dsc-wiki/assets/js/anchor.min.js"  type="text/javascript"></script>
  <script>

initFunction(function () {
    anchors.add("main h1, main h2, main h3, main h4")
});

</script>

  <!-- Include Turbolinks to make page loads fast -->
  <!-- https://github.com/turbolinks/turbolinks -->
  <script src="/dsc-wiki/assets/js/turbolinks.js" async></script>
  <meta name="turbolinks-cache-control" content="no-cache">

  <!-- Load nbinteract for widgets -->
  <script src="https://unpkg.com/nbinteract-core" async></script>

  <!-- Load Thebelab for interactive widgets -->
  <!-- Include Thebelab for interactive code if it's enabled -->


  <!-- Google analytics -->
  <script src="/dsc-wiki/assets/js/ga.js" async></script>

  <!-- Clipboard copy button -->
  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" async></script>

  <!-- Load JS that depends on site variables -->
  <script>
/**
 * Set up copy/paste for code blocks
 */
const codeCellId = index => `codecell${index}`

const clipboardButton = id =>
  `<a class="btn copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#${id}">
    <img src="/dsc-wiki/assets/images/copy-button.svg" alt="Copy to clipboard">
  </a>`

// Clears selected text since ClipboardJS will select the text when copying
const clearSelection = () => {
  if (window.getSelection) {
    window.getSelection().removeAllRanges()
  } else if (document.selection) {
    document.selection.empty()
  }
}

// Changes tooltip text for two seconds, then changes it back
const temporarilyChangeTooltip = (el, newText) => {
  const oldText = el.getAttribute('data-tooltip')
  el.setAttribute('data-tooltip', newText)
  setTimeout(() => el.setAttribute('data-tooltip', oldText), 2000)
}

const addCopyButtonToCodeCells = () => {
  // If ClipboardJS hasn't loaded, wait a bit and try again. This
  // happens because we load ClipboardJS asynchronously.
  if (window.ClipboardJS === undefined) {
    setTimeout(addCopyButtonToCodeCells, 250)
    return
  }

  const codeCells = document.querySelectorAll('.input_area pre')
  codeCells.forEach((codeCell, index) => {
    const id = codeCellId(index)
    codeCell.setAttribute('id', id)
    if (document.querySelector(`pre#${id} + a`) == null) {
      codeCell.insertAdjacentHTML('afterend', clipboardButton(id));
    }
  })

  const clipboard = new ClipboardJS('.copybtn')
  clipboard.on('success', event => {
    clearSelection()
    temporarilyChangeTooltip(event.trigger, 'Copied!')
  })

  clipboard.on('error', event => {
    temporarilyChangeTooltip(event.trigger, 'Failed to copy')
  })

  // Get rid of clipboard before the next page visit to avoid memory leak
  document.addEventListener('turbolinks:before-visit', () =>
    clipboard.destroy()
  )
}

initFunction(addCopyButtonToCodeCells);
</script>

  <!-- Hide cell code -->
  
<script>
/**
Add buttons to hide code cells
*/


var setCodeCellVisibility = function(inputField, kind) {
    // Update the image and class for hidden
    var id = inputField.getAttribute('data-id');
    var codeCell = document.querySelector(`#${id}`);

    if (kind === "visible") {
        codeCell.classList.remove('hidden');
        inputField.checked = true;
    } else {
        codeCell.classList.add('hidden');
        inputField.checked = false;
    }
}

var toggleCodeCellVisibility = function (event) {
    // The label is clicked, and now we decide what to do based on the input field's clicked status
    if (event.target.tagName === "LABEL") {
        var inputField = event.target.previousElementSibling;
    } else {
        // It is the span inside the target
        var inputField = event.target.parentElement.previousElementSibling;
    }

    if (inputField.checked === true) {
        setCodeCellVisibility(inputField, "visible");
    } else {
        setCodeCellVisibility(inputField, "hidden");
    }
}


// Button constructor
const hideCodeButton = id => `<input class="hidebtn" type="checkbox" id="hidebtn${id}" data-id="${id}"><label title="Toggle cell" for="hidebtn${id}" class="plusminus"><span class="pm_h"></span><span class="pm_v"></span></label>`

var addHideButton = function () {
  // If a hide button is already added, don't add another
  if (document.querySelector('div.hidecode input') !== null) {
      return;
  }

  // Find the input cells and add a hide button
  document.querySelectorAll('div.input_area div.highlight').forEach(function (item, index) {
    if (!item.parentElement.classList.contains("hidecode")) {
        // Skip the cell if it doesn't have a hidecode class
        return;
    }

    const id = codeCellId(index)
    item.setAttribute('id', id);
    item.insertAdjacentHTML('afterend', hideCodeButton(id))

    // Set up the visibility toggle
    hideLink = document.querySelector(`#${id} + input + label`);
    hideLink.addEventListener('click', toggleCodeCellVisibility)
  });
}


// Initialize the hide buttos
var initHiddenCells = function () {
    // Add hide buttons to the cells
    addHideButton();

    // Toggle the code cells that should be hidden
    document.querySelectorAll('div.hidecode input').forEach(function (item) {
        setCodeCellVisibility(item, 'hidden');
        item.checked = true;
    })
}

initFunction(initHiddenCells);

</script>


  <!-- Load custom website scripts -->
  <script src="/dsc-wiki/assets/js/scripts.js" async></script>

  <!-- Load custom user CSS and JS  -->
  <script src="/dsc-wiki/assets/custom/custom.js" async></script>
  <link rel="stylesheet" href="/dsc-wiki/assets/custom/custom.css">

  <!-- Update interact links w/ REST param, is defined in includes so we can use templates -->
  

  <!-- Lunr search code - will only be executed on the /search page -->
  <script src="/dsc-wiki/assets/js/lunr/lunr.min.js" type="text/javascript"></script>
  <script>var initQuery = function() {
  // See if we have a search box
  var searchInput = document.querySelector('input#lunr_search');
  if (searchInput === null) {
    return;
  }

  // Function to parse our lunr cache
  var idx = lunr(function () {
    this.field('title')
    this.field('excerpt')
    this.field('categories')
    this.field('tags')
    this.ref('id')

    this.pipeline.remove(lunr.trimmer)

    for (var item in store) {
      this.add({
        title: store[item].title,
        excerpt: store[item].excerpt,
        categories: store[item].categories,
        tags: store[item].tags,
        id: item
      })
    }
  });

  // Run search upon keyup
  searchInput.addEventListener('keyup', function () {
    var resultdiv = document.querySelector('#results');
    var query = document.querySelector("input#lunr_search").value.toLowerCase();
    var result =
      idx.query(function (q) {
        query.split(lunr.tokenizer.separator).forEach(function (term) {
          q.term(term, { boost: 100 })
          if(query.lastIndexOf(" ") != query.length-1){
            q.term(term, {  usePipeline: false, wildcard: lunr.Query.wildcard.TRAILING, boost: 10 })
          }
          if (term != ""){
            q.term(term, {  usePipeline: false, editDistance: 1, boost: 1 })
          }
        })
      });

      // Empty the results div
      while (resultdiv.firstChild) {
        resultdiv.removeChild(resultdiv.firstChild);
      }

    resultdiv.insertAdjacentHTML('afterbegin', '<p class="results__found">'+result.length+' Result(s) found</p>');
    for (var item in result) {
      var ref = result[item].ref;
      if(store[ref].teaser){
        var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<div class="archive__item-teaser">'+
                '<img src="'+store[ref].teaser+'" alt="">'+
              '</div>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      else{
    	  var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      resultdiv.insertAdjacentHTML('beforeend', searchitem);
    }
  });
};

initFunction(initQuery);
</script>
</head>

  <body>
    <!-- .js-show-sidebar shows sidebar by default -->
    <div id="js-textbook" class="c-textbook js-show-sidebar">
      



<nav id="js-sidebar" class="c-textbook__sidebar">
  <a href="https://github.com/stephenslab/dsc"><img src="/dsc-wiki/images/logo.png" class="textbook_logo" id="sidebar-logo" data-turbolinks-permanent/></a>
  <h2 class="c-sidebar__title">DSC</h2>
  <ul class="c-sidebar__chapters">
    
      
      
        <li class="c-sidebar__chapter"><a class="c-sidebar__entry" href="/dsc-wiki/search.html"><img src="/dsc-wiki/images/search.svg" alt="Search This Wiki"></a></li>
        
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsc-wiki/overview.html"
        >
          
          Home
        </a>

        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsc-wiki/installation.html"
        >
          
          Installation
        </a>

        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsc-wiki/faq.html"
        >
          
          FAQ
        </a>

        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsc-wiki/reference/reference.html"
        >
          
          Reference manual
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/reference/Terminology.html"
                >
                  
                  Terminology
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry c-sidebar__entry--active"
                  href="/dsc-wiki/reference/DSC_Configuration.html"
                >
                  
                  DSC configuration syntax
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/reference/DSC_Execution.html"
                >
                  
                  Running DSC
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/reference/DSC_Filtering.html"
                >
                  
                  Extracting DSC results
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/reference/Command_Options.html"
                >
                  
                  Command-line reference
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/reference/Road_Map.html"
                >
                  
                  Development roadmap
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/reference/Implementation_Details.html"
                >
                  
                  Implementation details
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/reference/Unsupported_Features.html"
                >
                  
                  Unsupported features
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      
        <li class="c-sidebar__divider"></li>
        
      
      
        <li><h2 class="c-sidebar__title">User guide</li>
        
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsc-wiki/first_course/first_course.html"
        >
          
          First course on DSC
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/first_course/Intro_DSC.html"
                >
                  
                  A brief introduction to DSC
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/first_course/Intro_Syntax_I.html"
                >
                  
                  DSC basics, part I
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/first_course/Intro_Syntax_II.html"
                >
                  
                  DSC basics, part II
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/first_course/Prototype_Tips.html"
                >
                  
                  Developing benchmarks
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/first_course/Debug_Tips.html"
                >
                  
                  Debug in DSC
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/first_course/Syntax_Tips.html"
                >
                  
                  Syntax tips
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsc-wiki/faq.html"
        >
          
          Other tutorials
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/advanced_course/5_Minutes_Python.html"
                >
                  
                  Working with Python
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/advanced_course/DSC_Data.html"
                >
                  
                  DSC data flow
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/advanced_course/5_Minutes_RPY.html"
                >
                  
                  Working with R and Python
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/advanced_course/Multiple_Pipelines.html"
                >
                  
                  Running multiple pipelines
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/advanced_course/Rmd_Executable.html"
                >
                  
                  Using Rmd files as module executables
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/advanced_course/Remote_Computations.html"
                >
                  
                  Running DSC on remote computers
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/advanced_course/DSC_Docker.html"
                >
                  
                  Running DSC in Docker
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsc-wiki/examples.html"
        >
          
          Benchmark examples
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/examples/R_Example_1.html"
                >
                  
                  R Example 1
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/examples/R_Example_2.html"
                >
                  
                  R Example 2
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
  </ul>
  <p class="sidebar_footer">Copyright (c) 2016-2018 <br> <a href="http://home.uchicago.edu/gaow">Gao Wang</a>, <a href="http://stephenslab.uchicago.edu">Matthew Stephens</a>, <a href="https://pcarbo.github.io">Peter Carbonetto</a> and contributors.<br></p>
</nav>

      
      <!-- Shamelessly copied from minimal mistakes -->


<!-- TOC will only show up if it has at least one item -->


  <aside class="sidebar__right">
    <nav class="onthispage">
      <header><h4 class="nav__title"><i class="fa fa-list"></i>   Contents</h4></header>
      <ul class="toc__menu">
  <li><a href="#modules">Modules</a>
    <ul>
      <li><a href="#module-property">Module property</a></li>
      <li><a href="#module-inheritance">Module Inheritance</a></li>
      <li><a href="#module-parameters">Module parameters</a></li>
      <li><a href="#module-output">Module output</a></li>
      <li><a href="#module-input">Module input</a></li>
    </ul>
  </li>
  <li><a href="#decorators">Decorators</a>
    <ul>
      <li><a href="#module-as-decorator">Module as decorator</a></li>
      <li><a href="#decorator-alias">Decorator ALIAS</a></li>
      <li><a href="#alias-operators">ALIAS operators</a></li>
      <li><a href="#decorator-filter">Decorator FILTER</a></li>
      <li><a href="#decorator-conf">Decorator CONF</a></li>
    </ul>
  </li>
  <li><a href="#operators">Operators</a>
    <ul>
      <li><a href="#tuple-operator">Tuple operator</a></li>
      <li><a href="#language-interpreters">Language interpreters</a></li>
      <li><a href="#raw-string-indicator">Raw string indicator</a></li>
      <li><a href="#file-generator">File generator</a></li>
    </ul>
  </li>
  <li><a href="#load-modules-from-other-files">Load modules from other files</a></li>
  <li><a href="#improving-dsc-script-readability">Improving DSC script readability</a>
    <ul>
      <li><a href="#use-comments">Use comments</a></li>
      <li><a href="#turn-on-yaml-syntax-highlighter">Turn on YAML syntax highlighter</a></li>
    </ul>
  </li>
</ul>
    </nav>
  </aside>


      
      <main class="c-textbook__page" tabindex="-1">
          <div class="o-wrapper">
            <div class="c-sidebar-toggle">
  <!-- We show the sidebar by default so we use .is-active -->
  <button
    id="js-sidebar-toggle"
    class="hamburger hamburger--arrowalt is-active"
  >
    <span class="hamburger-box">
      <span class="hamburger-inner"></span>
    </span>
    <span class="c-sidebar-toggle__label">Toggle Sidebar</span>
  </button>
</div>

            

            <div class="c-textbook__content">
              <h1 id="dsc-syntax-basics-of-modules">DSC syntax: basics of modules</h1>

<p>In this document we mainly use partial DSC examples (along the lines of <a href="https://github.com/stephenslab/dsc/blob/master/vignettes/one_sample_location/settings.dsc">this toy</a> but with advanced features not used there) to introduce basic DSC syntax. Before diving into the details, you may find <a href="../first_course/first_course">DSC introduction tutorials</a> a useful first-read to help better understand DSC syntax.</p>

<p>We endeavor to maintain DSC syntax simple and intuitive. This documentation covers the basic DSC syntax for users to get started quickly. We will use dedicated tutorial examples on various specific user cases separatedly, such as using other languages / command tools, using DSC in exploratory phase of research projects, and working with remote computers or HPC clusters for large scale computation. (<strong>FIXME: create these tutorials and add links to them</strong>)</p>

<p>A DSC file consists of one or more syntax blocks to configure <em>modules</em>, and one block to configure <em>pipelines</em> and <em>benchmark</em>. Here we focus on discussing modules. DSC pipelines and benchmark execution will be discussed in <a href="DSC_Execution">a separate document</a>.</p>

<h2 id="modules">Modules</h2>

<p>A module block is conceptually consisted of:</p>

<ul>
  <li><code class="highlighter-rouge">property</code></li>
  <li><code class="highlighter-rouge">input</code></li>
  <li><code class="highlighter-rouge">parameters</code></li>
  <li><code class="highlighter-rouge">output</code></li>
</ul>

<p>and, optionally, <code class="highlighter-rouge">decorators</code> that provide customization to flavors of modules. Note that we do not use these exact terms as keywords in module syntax, yet as will be illustrated soon, these components distinguish from each other syntactically.</p>

<h3 id="module-property">Module property</h3>

<p>Modules, the building blocks of DSC, can be minimally specified as follows:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">normal, t</span><span class="pi">:</span> <span class="s">rnorm.R, rt.R</span>
    <span class="s">n</span><span class="pi">:</span> <span class="s">1000</span>
    <span class="s">$x</span><span class="pi">:</span> <span class="s">x</span>
</code></pre></div></div>

<p>Here we focus on the first line (aka the “module property” line):</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">normal, t</span><span class="pi">:</span> <span class="s">rnorm.R, rt.R</span>
</code></pre></div></div>

<p>The two elements separated by <code class="highlighter-rouge">:</code> are module names and executables. The module named <code class="highlighter-rouge">normal</code> corresponds to <code class="highlighter-rouge">rnorm.R</code>, <code class="highlighter-rouge">t</code> corresponds to <code class="highlighter-rouge">rt.R</code>. For cases when there are multiple module names on the left of <code class="highlighter-rouge">:</code> yet only one executable on the right, eg:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">normal, t</span><span class="pi">:</span> <span class="s">simulate.R</span>
</code></pre></div></div>

<p>then the two modules will share the same executable (yet, to be discussed later, possibly different module parameters).</p>

<h4 id="compound-module-executables">Compound module executables</h4>

<p>Multiple scripts can be connected with <code class="highlighter-rouge">+</code> for one module to allow them be loaded sequentially as if they are concatenated to one script. For example:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">method</span><span class="pi">:</span> <span class="s">utils.R + main.R</span>
</code></pre></div></div>

<p>will load <code class="highlighter-rouge">utils.R</code> followed by <code class="highlighter-rouge">main.R</code>.</p>

<p><a href="#tuple-operator">Tuple operator</a> <code class="highlighter-rouge">()</code> can be used in conjuction with <code class="highlighter-rouge">+</code> to expand the logic of concatenation, as a shorthand to define multiple compound executables. For example:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">method1, method2</span><span class="pi">:</span> <span class="s">(utils1.R, utils2.R) + main.R</span>
</code></pre></div></div>

<p>will load <code class="highlighter-rouge">utils1.R</code> followed by <code class="highlighter-rouge">main.R</code> for module <code class="highlighter-rouge">method1</code>, <code class="highlighter-rouge">utils2.R</code> followed by <code class="highlighter-rouge">main.R</code> for module <code class="highlighter-rouge">method2</code>.</p>

<h4 id="inline-executables">Inline executables</h4>

<p>Instead of having to use scripts to specify module executables, <a href="#language-interpreters">language interpreter</a> operators can be used to define codes for modules inline. For example:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">normal</span><span class="pi">:</span> <span class="s">R(x = rnorm(n))</span>
    <span class="s">n</span><span class="pi">:</span> <span class="s">1000</span>
    <span class="s">$x</span><span class="pi">:</span> <span class="s">x</span>
</code></pre></div></div>

<p>It can also be combined with scripts as a concatenation:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">method</span><span class="pi">:</span> <span class="s">utils.R + R(res = main(...))</span>
</code></pre></div></div>

<p>Or,</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">method1, method2</span><span class="pi">:</span> <span class="s">(utils1.R, utils2.R) + R(res = main(...))</span>
</code></pre></div></div>

<h3 id="module-inheritance">Module Inheritance</h3>

<p>Modules can be <em>inherited</em> as follows, a shorthand to define new modules based on existing ones:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">normal</span><span class="pi">:</span> <span class="s">R( x = mu + rnorm(n) )</span>
  <span class="s">n</span><span class="pi">:</span> <span class="s">100, 1000</span>
  <span class="s">mu</span><span class="pi">:</span> <span class="s">0</span>
  <span class="s">$data</span><span class="pi">:</span> <span class="s">x</span>
  <span class="s">$true_mean</span><span class="pi">:</span> <span class="s">mu</span>

<span class="s">shifted_normal(normal)</span><span class="pi">:</span> 
  <span class="na">mu</span><span class="pi">:</span> <span class="s">1</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">shifted_normal</code> is a derived module from <code class="highlighter-rouge">normal</code>. The complete definition of <code class="highlighter-rouge">shifted_normal</code>, after expanding the derived contents, is in fact:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">shifted_normal</span><span class="pi">:</span> <span class="s">R( x = mu + rnorm(n) )</span>
  <span class="s">n</span><span class="pi">:</span> <span class="s">100, 1000</span>
  <span class="s">mu</span><span class="pi">:</span> <span class="s">1</span>
  <span class="s">$data</span><span class="pi">:</span> <span class="s">x</span>
  <span class="s">$true_mean</span><span class="pi">:</span> <span class="s">mu</span>
</code></pre></div></div>

<p>The inheritance syntax makes module definitions not only succint but also conceptually more clear to define new modules – in this example we can tell that <code class="highlighter-rouge">shifted_normal</code> is essentially <code class="highlighter-rouge">normal</code> with different parameters.</p>

<p>Module inheritance can also be used to add parameters, eg,</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">normal</span><span class="pi">:</span> <span class="s">R( x = mu + rnorm(n) )</span>
  <span class="s">n</span><span class="pi">:</span> <span class="s">100, 1000</span>
  <span class="s">mu</span><span class="pi">:</span> <span class="s">0</span>
  <span class="s">$data</span><span class="pi">:</span> <span class="s">x</span>
  <span class="s">$true_mean</span><span class="pi">:</span> <span class="s">mu</span>

<span class="s">t(normal)</span><span class="pi">:</span> <span class="s">R( x = mu + rt(n,df) )</span>
  <span class="s">df</span><span class="pi">:</span> <span class="s">2</span>
</code></pre></div></div>

<p>Then <code class="highlighter-rouge">t</code> is inherited from <code class="highlighter-rouge">normal</code> with a different script and additional parameter, which will get expanded to:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">t</span><span class="pi">:</span> <span class="s">R( x = mu + rt(n,df) )</span>
  <span class="s">n</span><span class="pi">:</span> <span class="s">100, 1000</span>
  <span class="s">mu</span><span class="pi">:</span> <span class="s">0</span>
  <span class="s">df</span><span class="pi">:</span> <span class="s">2</span>
  <span class="s">$data</span><span class="pi">:</span> <span class="s">x</span>
  <span class="s">$true_mean</span><span class="pi">:</span> <span class="s">mu</span>
</code></pre></div></div>

<h3 id="module-parameters">Module parameters</h3>

<p>Each module parameter is an indented property under module property line. In the example above, <code class="highlighter-rouge">n</code> is module input parameter for both modules <code class="highlighter-rouge">normal</code> and <code class="highlighter-rouge">t</code>, corresponding to the variable <code class="highlighter-rouge">n</code> in both <a href="https://github.com/stephenslab/dsc/blob/master/vignettes/one_sample_location/R/scenarios/rnorm.R">rnorm.R</a> and <a href="https://github.com/stephenslab/dsc/blob/master/vignettes/one_sample_location/R/scenarios/rt.R">rt.R</a> scripts. Here <code class="highlighter-rouge">n</code> is set to <code class="highlighter-rouge">1000</code>. When set to an array-like value, eg <code class="highlighter-rouge">n: 100, 500, 1000</code> then effectively 3 modules are defined for <code class="highlighter-rouge">normal</code> and <code class="highlighter-rouge">t</code> each. Take <code class="highlighter-rouge">normal</code> for example:</p>

<ul>
  <li>module 1: <code class="highlighter-rouge">rnorm.R</code> with <code class="highlighter-rouge">n</code> set to 100</li>
  <li>module 2: <code class="highlighter-rouge">rnorm.R</code> with <code class="highlighter-rouge">n</code> set to 500</li>
  <li>module 3: <code class="highlighter-rouge">rnorm.R</code> with <code class="highlighter-rouge">n</code> set to 1000</li>
</ul>

<p>It is also possible to specify a parameter with groups of values, for example, <code class="highlighter-rouge">p: (0.1, 0.9), (0.2, 0.8)</code> will initialize 2 modules each with parameter <code class="highlighter-rouge">p</code> of length 2.</p>

<p>When multiple parameters are specified, eg:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="na">n</span><span class="pi">:</span> <span class="s">10, 20</span>
    <span class="na">p</span><span class="pi">:</span> <span class="s">0.1, 0.2</span>
</code></pre></div></div>

<p>Combinations of parameters (Cartesian product style by default) will be assigned to all modules unless otherwise instructed via <a href="#decorator-filter"><code class="highlighter-rouge">@FILTER</code></a> decorator. In the example above each module will take 4 sets of parameters : <code class="highlighter-rouge">(n = 10, p = 0.1), (n = 10, p = 0.2), (n = 20, p = 0.1), (n = 20, p = 0.2)</code>.</p>

<p>To get “paired” parameters instead, the <a href="#tuple-operator">Tuple operator</a> can be used on both sides of the property. For example,</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">(n, p)</span><span class="pi">:</span> <span class="s">(10, 0.1), (20, 0.2)</span>
</code></pre></div></div>

<p>results in <code class="highlighter-rouge">(n = 10, p = 0.1), (n = 20, p = 0.2)</code>.</p>

<p>Caution that module parameter names must match with variable names, or command-line arguments, for module executables. For example, module parameter <code class="highlighter-rouge">n</code> is specified at DSC level and passed to <a href="https://github.com/stephenslab/dsc/blob/master/vignettes/one_sample_location/R/scenarios/rnorm.R">rnorm.R</a> and <a href="https://github.com/stephenslab/dsc/blob/master/vignettes/one_sample_location/R/scenarios/rt.R">rt.R</a> – neither of these executables has definition for <code class="highlighter-rouge">n</code> because they rely on DSC to provide it. It is the user’s responsibility to ensure that they match.</p>

<h3 id="module-output">Module output</h3>

<p>Module output are pipeline variables that can be accessed by other downstream modules in the pipeline. These variables have a leading <code class="highlighter-rouge">$</code> symbol followed by variable names. For example:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">normal, t</span><span class="pi">:</span> <span class="s">rnorm.R, rt.R</span>
    <span class="s">n</span><span class="pi">:</span> <span class="s">1000</span>
    <span class="s">$x</span><span class="pi">:</span> <span class="s">x</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">$x</code> on the left hand side of <code class="highlighter-rouge">:</code> is a module output. Under the hood, the <a href="https://github.com/stephenslab/dsc/blob/master/vignettes/one_sample_location/R/scenarios/rnorm.R"><code class="highlighter-rouge">rnorm.R</code></a> script generates a variable <code class="highlighter-rouge">x</code>, which is an <code class="highlighter-rouge">n</code> vector of normally distributed numbers. By specifying <code class="highlighter-rouge">$x: x</code>, <code class="highlighter-rouge">x</code> becomes a “module output”. That is, other downstream steps will be able to use it via <code class="highlighter-rouge">$x</code> as their input, as will be discussed later in detail.</p>

<p>Language specific syntax can be used to extract specific data from objects for use as module output. For example <code class="highlighter-rouge">$beta: data$meta_info$beta</code> extracts <code class="highlighter-rouge">beta</code> from an <code class="highlighter-rouge">R</code> nested list and save it directly as module output <code class="highlighter-rouge">beta</code>.</p>

<p>For modules whose executables are R or Python scripts, a module output can match any arbitary variable name inside the script, thus may or may not appear in module parameters. In the above example, <code class="highlighter-rouge">x</code> is not a module parameter. For command-line executables module output will have to be files (see <a href="#file-generator"><code class="highlighter-rouge">file()</code> operator</a> below).</p>

<h3 id="module-input">Module input</h3>

<p>Module input are pipeline variables generated by other upstream modules in the pipeline. Same as module output, module input has the pipeline variable syntax <code class="highlighter-rouge">$</code> followed by variable names. What distinguishes module input and output syntactically is whether they appear on the left side or the right side of <code class="highlighter-rouge">:</code>. For example:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">normal, t</span><span class="pi">:</span> <span class="s">rnorm.R, rt.R</span>
    <span class="s">n</span><span class="pi">:</span> <span class="s">1000</span>
    <span class="s">$x</span><span class="pi">:</span> <span class="s">x</span>

<span class="na">shrink</span><span class="pi">:</span> <span class="s">method.R</span>
    <span class="s">x</span><span class="pi">:</span> <span class="s">$x</span>
</code></pre></div></div>

<p>Here in the <code class="highlighter-rouge">shrink</code> module, <code class="highlighter-rouge">$x</code> is a module input, whose value will be assigned to a variable <code class="highlighter-rouge">x</code> that will be used in <code class="highlighter-rouge">method.R</code> script. The runtime environment determines which module this variable comes from. For example if the pipeline is <code class="highlighter-rouge">normal -&gt; shrink</code> then module input <code class="highlighter-rouge">$x</code> of <code class="highlighter-rouge">shrink</code> is output <code class="highlighter-rouge">$x</code> of <code class="highlighter-rouge">normal</code> module.</p>

<h2 id="decorators">Decorators</h2>

<p>The word “decorator” is borrowed from the term “decorator pattern” in object-oriented programming (a design pattern that allows behavior to be added to an individual object without affecting the behavior of other objects from the same class). A DSC decorator, when applied, will modify behavior of modules specified without impacting other modules in the same syntax block. Available decorators are:</p>

<ul>
  <li>@ &lt; module &gt;</li>
  <li>@ALIAS</li>
  <li>@FILTER</li>
  <li>@CONF</li>
</ul>

<p><code class="highlighter-rouge">@&lt;module&gt;</code> is specifically used to adjust settings for one module, when multiple modules are specified in the same code block. The other 3 decorators can also be used even when only single module is present in a code block – this typically applies to derived modules whose behavior is adjusted by decorators to distinguish from the module they inherited.</p>

<h3 id="module-as-decorator">Module as decorator</h3>

<p>Module decorator sepcifies parameters or inputs unique to one module but not applicable to others. for example</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">normal, t</span><span class="pi">:</span> <span class="s">rnorm.R, rt.R</span>
    <span class="s">n</span><span class="pi">:</span> <span class="s">1000</span>
    <span class="s">@t</span><span class="pi">:</span>
        <span class="na">df</span><span class="pi">:</span> <span class="s">5, 10</span>
<span class="nn">...</span>
</code></pre></div></div>

<p>where <code class="highlighter-rouge">n</code> is shared by both modules but parameter <code class="highlighter-rouge">df</code> is only used by module <code class="highlighter-rouge">t</code>. Module decorator always took precedence over parameters / inputs shared by modules when assigning new variables or modify existing ones, that is:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">normal, t</span><span class="pi">:</span> <span class="s">rnorm.R, rt.R</span>
    <span class="s">n</span><span class="pi">:</span> <span class="s">1000</span>
    <span class="s">@t</span><span class="pi">:</span>
        <span class="na">n</span><span class="pi">:</span> <span class="s">200</span>
<span class="nn">...</span>
</code></pre></div></div>
<p>will set <code class="highlighter-rouge">n = 200</code> for <code class="highlighter-rouge">t</code>, rather than using <code class="highlighter-rouge">n = 1000</code>.</p>

<p>Bulk syntax is supported:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">normal, t, cauchy</span><span class="pi">:</span> <span class="s">rnorm.R, rt.R, rcauchy.R</span>
    <span class="s">n</span><span class="pi">:</span> <span class="s">1000</span>
    <span class="s">@t,cauchy</span><span class="pi">:</span>
        <span class="na">n</span><span class="pi">:</span> <span class="s">200</span>
</code></pre></div></div>

<p>Caution that module decorators cannot be used to configure module output variables, because module output are required to be the same for all modules specified in the same syntax block.</p>

<h3 id="decorator-alias">Decorator ALIAS</h3>

<p><code class="highlighter-rouge">@ALIAS</code> is used to adjust the way inputs and parameters are passed to modules. DSC module parameter are of “simple” types (single elements or an array of single elements). In practice parameters specification may get complicated. <code class="highlighter-rouge">@ALIAS</code> can be used to compose a commonly used parameter input theme: all parameters are nested inside a “key-value” system.</p>

<p>For example an R script <code class="highlighter-rouge">method.R</code> accepts one “List” variable <code class="highlighter-rouge">args</code> that contains <code class="highlighter-rouge">var_a</code> and <code class="highlighter-rouge">var_b</code>:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">f</span><span class="m">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">...</span><span class="w"> </span><span class="p">}</span><span class="w">
</span><span class="n">f</span><span class="m">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">...</span><span class="w"> </span><span class="p">}</span><span class="w">
</span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="m">1</span><span class="p">(</span><span class="n">args</span><span class="o">$</span><span class="n">var_a</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">f</span><span class="m">2</span><span class="p">(</span><span class="n">args</span><span class="o">$</span><span class="n">var_b</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>Then instead of modifying <code class="highlighter-rouge">method.R</code> to take “simple” parameters, we can use <code class="highlighter-rouge">@ALIAS</code>,</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">method</span><span class="pi">:</span> <span class="s">method.R</span>
    <span class="s">a</span><span class="pi">:</span> <span class="s">1</span>
    <span class="s">b</span><span class="pi">:</span> <span class="s">2</span>
    <span class="s">@ALIAS</span><span class="pi">:</span> <span class="s">args = List(var_a = a, var_b = b)</span>
</code></pre></div></div>

<p>such that <code class="highlighter-rouge">a</code> and <code class="highlighter-rouge">b</code> are properly consolidated into an R List <code class="highlighter-rouge">args</code> as <code class="highlighter-rouge">var_a</code> and <code class="highlighter-rouge">var_b</code> respectively. Currently we allow for <code class="highlighter-rouge">List()</code> and <code class="highlighter-rouge">Dict()</code> for R’s List and Python’s Dictionary though more object types may be supported as needed in future versions.</p>

<h3 id="alias-operators">ALIAS operators</h3>

<p>ALIAS operators, <code class="highlighter-rouge">List()</code> and <code class="highlighter-rouge">Dict()</code> are used in <code class="highlighter-rouge">@ALIAS</code> decorator to help construct variables of nested <code class="highlighter-rouge">List</code> or <code class="highlighter-rouge">dictionary</code> structures in <code class="highlighter-rouge">R</code> and <code class="highlighter-rouge">Python</code>. For example for <code class="highlighter-rouge">R</code> modules:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">@</span><span class="na">ALIAS</span><span class="pi">:</span> <span class="s">args = List()</span>
</code></pre></div></div>

<p>will convert all input / parameters the module has available, say <code class="highlighter-rouge">x,y,z</code> to <code class="highlighter-rouge">args &lt;- list(x = ..., y = ..., z = ...)</code>. Likewise, <code class="highlighter-rouge">List()</code> will convert parameters to <code class="highlighter-rouge">dictionary</code> in Python. Partial conversion is also supported, for example <code class="highlighter-rouge">args = List(x, y)</code> will only convert selected variables to R list which will be translated to R code <code class="highlighter-rouge">args &lt;- list(x = x, y = y)</code>.</p>

<p><strong>Note that when a variable is made into ALIAS operator it will no longer be available as is</strong>. For example,</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">n</span><span class="pi">:</span> <span class="s">1</span>
<span class="na">m</span><span class="pi">:</span> <span class="s">2</span>
<span class="err">@</span><span class="na">ALIAS</span><span class="pi">:</span> <span class="s">args = List()</span>
</code></pre></div></div>

<p>Then you cannot use <code class="highlighter-rouge">m</code> or <code class="highlighter-rouge">n</code> in the module script. Rather they become <code class="highlighter-rouge">args$m</code> and <code class="highlighter-rouge">args$n</code>. To exclude variables from being included,</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">n</span><span class="pi">:</span> <span class="s">1</span>
<span class="nn">...</span>
<span class="nn">...</span>
<span class="err">@</span><span class="na">ALIAS</span><span class="pi">:</span> <span class="s">args = List(!n)</span>
</code></pre></div></div>

<p>Then for an R module every other parameters will be consolidated into R list <code class="highlighter-rouge">args</code>, except for parameter <code class="highlighter-rouge">n</code>. Multiple <code class="highlighter-rouge">!</code> is supported, eg, <code class="highlighter-rouge">List(!n, !m)</code>.</p>

<p>Another <strong>important</strong> usage of <code class="highlighter-rouge">@ALIAS</code> is to adjust parameter names for the module specified. For example, suppose the variable <code class="highlighter-rouge">n</code> in script <code class="highlighter-rouge">rnorm.R</code> is <code class="highlighter-rouge">n</code> but in <code class="highlighter-rouge">rt.R</code> it is <code class="highlighter-rouge">n_samples</code>, then we can use <code class="highlighter-rouge">@ALIAS</code> to adjust module <code class="highlighter-rouge">t</code>:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">normal, t</span><span class="pi">:</span> <span class="s">rnorm.R, rt.R</span>
    <span class="s">n</span><span class="pi">:</span> <span class="s">1000</span>
    <span class="s">@ALIAS</span><span class="pi">:</span>
        <span class="na">t</span><span class="pi">:</span> <span class="s">n_samples = n</span>
</code></pre></div></div>

<p>Then <code class="highlighter-rouge">n</code> is renamed to <code class="highlighter-rouge">n_samples</code> for input to module <code class="highlighter-rouge">t</code>.</p>

<p>When both module specific <code class="highlighter-rouge">@ALIAS</code> and global <code class="highlighter-rouge">@ALIAS</code> are to be specified, one can either use module decorator in combination with <code class="highlighter-rouge">@ALIAS</code>, or use wildcard <code class="highlighter-rouge">*</code> in addition to module specific adjustment. For example the following two code blocks are equivalent:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">normal, t, rcauchy</span><span class="pi">:</span> <span class="s">rnorm.R, rt.R, rcauchy.R</span>
    <span class="s">n</span><span class="pi">:</span> <span class="s">1000</span>
    <span class="s">mu</span><span class="pi">:</span> <span class="s">5</span>
    <span class="s">@ALIAS</span><span class="pi">:</span>
        <span class="err">*</span><span class="pi">:</span> <span class="s">args = List(mu)</span>
        <span class="na">t</span><span class="pi">:</span> <span class="s">args = List(mu), n_samples = n</span>
</code></pre></div></div>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">normal, t, rcauchy</span><span class="pi">:</span> <span class="s">rnorm.R, rt.R, rcauchy.R</span>
    <span class="s">n</span><span class="pi">:</span> <span class="s">1000</span>
    <span class="s">mu</span><span class="pi">:</span> <span class="s">5</span>
    <span class="s">@ALIAS</span><span class="pi">:</span> <span class="s">args = List(mu)</span>
    <span class="s">@t</span><span class="pi">:</span>
        <span class="err">@</span><span class="na">ALIAS</span><span class="pi">:</span> <span class="s">args = List(mu), n_samples = n</span>
</code></pre></div></div>

<h3 id="decorator-filter">Decorator FILTER</h3>

<p><code class="highlighter-rouge">@FILTER</code> can be used to modify default logic that all parameters are combined the Cartesian product style. The <code class="highlighter-rouge">@FILTER</code> syntax is the same as the <code class="highlighter-rouge">condition</code> statement in <code class="highlighter-rouge">dsc-query</code> command; both <a href="DSC_Filtering">documented elsewhere</a>. Here we elaborate on some examples:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">normal, t</span><span class="pi">:</span> <span class="s">normal.R, t.R</span>
    <span class="s">n</span><span class="pi">:</span> <span class="s">100, 200, 300, 400, 500</span>
    <span class="s">k</span><span class="pi">:</span> <span class="s">0, 1</span>
    <span class="s">@FILTER</span><span class="pi">:</span>
        <span class="na">t</span><span class="pi">:</span> <span class="s">(n &lt;= 300 and k = 0) or (n &gt; 300 and k = 1)</span>
        <span class="na">normal</span><span class="pi">:</span> <span class="s">n = 500</span>
</code></pre></div></div>

<p>Without <code class="highlighter-rouge">@FILTER</code> DSC will exhaust all combinations of 5 values of <code class="highlighter-rouge">n</code> and 2 of <code class="highlighter-rouge">k</code> for both modules, creating a total of 20 parallel jobs. The <code class="highlighter-rouge">@FILTER</code> here states that instead of running all 20 jobs, DSC will run for <code class="highlighter-rouge">t</code> 3 values from <code class="highlighter-rouge">n</code> with <code class="highlighter-rouge">k = 0</code>, then run the rest 2 values of <code class="highlighter-rouge">n</code> with <code class="highlighter-rouge">k = 1</code>, which is a total of 5 jobs for <code class="highlighter-rouge">t</code>. Then it runs for <code class="highlighter-rouge">normal</code> with <code class="highlighter-rouge">n = 500</code> combined with 2 values from <code class="highlighter-rouge">k</code>, a total of 2 jobs. Therefore only 7 jobs will be executed after applying the <code class="highlighter-rouge">@FILTER</code>.</p>

<p>When no module name is specified, eg. <code class="highlighter-rouge">n</code>, then all modules will subject to the filter:</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="err">@</span><span class="na">FILTER</span><span class="pi">:</span> <span class="s">(n in [100,200,300] and k = 0)</span>
</code></pre></div></div>

<p>Wildcard <code class="highlighter-rouge">*</code> is also supported,</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="err">@</span><span class="na">FILTER</span><span class="pi">:</span> 
        <span class="err">*</span><span class="pi">:</span> <span class="s">n in [100,200,300]</span>
        <span class="na">t</span><span class="pi">:</span> <span class="s">n = 300</span>
</code></pre></div></div>

<p>then for <code class="highlighter-rouge">t</code> we restrict <code class="highlighter-rouge">n</code> to <code class="highlighter-rouge">300</code>, and for all other modules we set <code class="highlighter-rouge">n</code> to loop over <code class="highlighter-rouge">100,200,300</code>.</p>

<h3 id="decorator-conf">Decorator CONF</h3>

<p><code class="highlighter-rouge">@CONF</code> provides interface to override certain properties in benchmark configuration section (<code class="highlighter-rouge">DSC</code> section), including <code class="highlighter-rouge">work_dir</code>, <code class="highlighter-rouge">exec_path</code>, <code class="highlighter-rouge">lib_path</code>. See <a href="DSC_Execution">this document</a> for more details.</p>

<h2 id="operators">Operators</h2>

<h3 id="tuple-operator">Tuple operator</h3>
<p>When used to specify module parameters, tuple operator <code class="highlighter-rouge">()</code> simply creates grouped values as module parameters, for example</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">method</span><span class="pi">:</span> <span class="s">method.R</span>
    <span class="s">K</span><span class="pi">:</span> <span class="s">(1,2,3), (4,5,6)</span>
</code></pre></div></div>

<p>With <code class="highlighter-rouge">()</code>, <code class="highlighter-rouge">(1,2,3)</code> will be translated as a group to <code class="highlighter-rouge">c(1, 2, 3)</code> in <code class="highlighter-rouge">R</code>, <code class="highlighter-rouge">(1,2,3)</code> in <code class="highlighter-rouge">Python</code>, or space separated argument sequence <code class="highlighter-rouge">1 2 3</code> for command-line tools. Values will be assigned in groups defined by <code class="highlighter-rouge">()</code> instead of separately.</p>

<p>When used to define <a href="#module-property">module executables</a>, in conjunction with concatenating operator <code class="highlighter-rouge">+</code> it helps matching compound executables to each module in the same block.</p>

<h3 id="language-interpreters">Language interpreters</h3>

<p>Currently <code class="highlighter-rouge">R()/R{}</code>, <code class="highlighter-rouge">Python()/Python{}</code>, and <code class="highlighter-rouge">Shell()/Shell{}</code> are supported to specify module parameters. Codes inside these operators will be interpreted while DSC parses the configuration file; output will be evaluated as parameter values. For example <code class="highlighter-rouge">n: R((1:5)*10)</code> results in <code class="highlighter-rouge">n: (10, 20, 30, 40, 50)</code> and <code class="highlighter-rouge">n: R{(1:5)*10}</code> results in <code class="highlighter-rouge">n: 10, 20, 30, 40, 50</code>. This provides handy tool for generating input parameters with R, Python or Shell languages.</p>

<p><code class="highlighter-rouge">R()</code> and <code class="highlighter-rouge">Python()</code> can also be used to <a href="#module-property">create inline module executables</a>. They will be interpreted at runtime as part of the module executable scripts.</p>

<h3 id="raw-string-indicator">Raw string indicator</h3>

<p>In cases when we want to input a chunk of scripts as un-quoted string that may conflict with DSC parser behavior, <code class="highlighter-rouge">raw()</code> indicator can be used to “protect” the input content from being processed by DSC, for example:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">g</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">1</span><span class="pi">,</span><span class="nv">2</span><span class="pi">,</span><span class="nv">3</span><span class="pi">]</span>
</code></pre></div></div>

<p>will result in the <code class="highlighter-rouge">Python</code> code</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div></div>

<p>because vector-like atomic types are converted to python “tuples” from DSC interface. But with <code class="highlighter-rouge">raw()</code> it will result in <code class="highlighter-rouge">R</code> code</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">g</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
</code></pre></div></div>

<p>as initially specified.</p>

<p>Another example:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">normal</span><span class="pi">:</span> <span class="s">R(x &lt;- rnorm(n,mean = mu,sd = 1))</span>
  <span class="s">mu</span><span class="pi">:</span> <span class="s">raw(0.0)</span>
</code></pre></div></div>

<p>will result in</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rnorm</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.0</span><span class="p">,</span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>However replacing <code class="highlighter-rouge">raw(0.0)</code> with <code class="highlighter-rouge">0.0</code> it will result in</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rnorm</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>Caution that whatever goes into <code class="highlighter-rouge">raw()</code> will be treated as strings in the <code class="highlighter-rouge">condition</code> parameter of <a href="https://github.com/stephenslab/dsc/blob/master/dscrutils/man/dscquery.Rd"><code class="highlighter-rouge">dscrutils::dscquery</code></a>.</p>

<h3 id="file-generator">File generator</h3>

<p><strong>FIXME: multiple output file generator objects are not yet allowed, and will not be available until DSC 0.3.x. Convention of module output file will therefore subject to change.</strong></p>

<p>When a DSC module involves use of files yet to be created by a module instance, <code class="highlighter-rouge">file()</code> can be used to ensure a file is properly generated without racing with other module instances; or simply put, to generate unique file name strings per module instance.</p>

<p>File generator <code class="highlighter-rouge">file()</code> will generate unique files by the following conventions:</p>

<ol>
  <li>When used as module parameter and without an extension it generates a temporary file, eg, <code class="highlighter-rouge">cache: file()</code>.</li>
  <li>When used as module parameter with an extension it generates files with unique names into DSC output folder. eg, <code class="highlighter-rouge">cache: file(txt)</code> or equivalently <code class="highlighter-rouge">cache: file(.txt)</code>.</li>
  <li>When used as module output with an extension it generates files with unique name as the module output file.</li>
</ol>

<p>Before explaining in detail, here is a couple of simple DSC modules to demonstrate the usage:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">t1</span><span class="pi">:</span> <span class="s">R(print(paste("Parameter 'file1', an un-saved tmp file</span><span class="pi">:</span> <span class="s2">"</span><span class="s">,</span><span class="nv"> </span><span class="s">file1));</span>
      <span class="s">print(paste("Parameter 'file2', a saved tmp file</span><span class="pi">:</span> <span class="s2">"</span><span class="s">,</span><span class="nv"> </span><span class="s">file2));</span>
      <span class="s">print(paste("Module output 'out', a saved and tracked file</span><span class="pi">:</span> <span class="s2">"</span><span class="s">,</span><span class="nv"> </span><span class="s">out));</span>
      <span class="s">write(0,out))</span>
  <span class="s">file1:</span><span class="nv"> </span><span class="s">file()</span>
  <span class="s">file2:</span><span class="nv"> </span><span class="s">file(txt)</span>
  <span class="s">$out:</span><span class="nv"> </span><span class="s">file(txt)</span>

<span class="s">t2:</span><span class="nv"> </span><span class="s">R(print(paste("Module input 'data' is previous module output 'out'</span><span class="pi">:</span> <span class="s2">"</span><span class="s">,</span><span class="nv"> </span><span class="s">data));</span>
      <span class="s">out</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">read.table(data))</span>
  <span class="s">data:</span><span class="nv"> </span><span class="s">$out</span>
  <span class="s">$out:</span><span class="nv"> </span><span class="s">out</span>
</code></pre></div></div>

<p>Then run:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>dsc test.dsc <span class="nt">--target</span> <span class="s2">"t1*t2"</span>
<span class="nv">$ </span>find <span class="nb">test</span> <span class="nt">-name</span> <span class="s2">"*.stdout"</span> <span class="nt">-exec</span> tail <span class="nt">-vn</span> +1 <span class="o">{}</span> <span class="se">\;</span>

<span class="o">==&gt;</span> <span class="nb">test</span>/t2/t1_1_t2_1.stdout &lt;<span class="o">==</span>
<span class="o">[</span>1] <span class="s2">"Module input 'data' is previous module output 'out':  test/t1/t1_1.txt"</span>
<span class="o">==&gt;</span> <span class="nb">test</span>/t1/t1_1.stdout &lt;<span class="o">==</span>
<span class="o">[</span>1] <span class="s2">"Parameter 'file1', an un-saved tmp file:  /tmp/RtmpxetZNc/t1_1.file1"</span>
<span class="o">[</span>1] <span class="s2">"Parameter 'file2', a saved tmp file:  test/t1/t1_1.file2.txt"</span>
<span class="o">[</span>1] <span class="s2">"Module output 'out', a saved and tracked file:  test/t1/t1_1.txt"</span>
</code></pre></div></div>

<p>you see 3 types of file names printed to screen, corresponding to the 3 conventions previously introduced:</p>

<ol>
  <li><code class="highlighter-rouge">/tmp/RtmpxetZNc/t1_1.file1</code></li>
  <li><code class="highlighter-rouge">test/t1/t1_1.file2.txt</code></li>
  <li><code class="highlighter-rouge">test/t1/t1_1.txt</code></li>
</ol>

<h4 id="extension-not-specified">Extension not specified</h4>

<p>When using <code class="highlighter-rouge">file()</code> without specifing the extension, it generates a file path in the system <a href="https://en.wikipedia.org/wiki/Temporary_folder">temporary folder</a> and can be used as a “temp file”. It will not appear in users’ work directory, and as with other system temp files there is generally no need to worry about their management / maintenance. Itis useful when there is a need to create some intermediate file for a module to run, yet there is no need to keep it for trouble-shooting. In the example above, parameter <code class="highlighter-rouge">file1</code> is a temporary file.</p>

<h4 id="extension-specified">Extension specified</h4>

<p><code class="highlighter-rouge">file()</code> with extension will result in a unique and informative basename for use in a module instance, and will result in files under the DSC output directory. When used as a module parameter, intermediate file cache are generated and saved, but will not be tracked by DSC or used in other modules. This means deleting this file manually afterwards will not trigger rerun of the pipelines involved. When used as a module output, DSC will keep track of it as pipeline variable that other modules can use. For example:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">t1</span><span class="pi">:</span> <span class="s">R(print(cache); write(out, 0))</span>
  <span class="s">n</span><span class="pi">:</span> <span class="s">1, 2, 3, 4</span>
  <span class="s">cache</span><span class="pi">:</span> <span class="s">file(cache)</span>
  <span class="s">$out</span><span class="pi">:</span> <span class="s">file(txt)</span>
</code></pre></div></div>

<p>Here the output <code class="highlighter-rouge">out</code> is a file name string, generated by the module taking parameter <code class="highlighter-rouge">n</code> in 4 different values. This will result in 4 module instance each with an output. Names of these <code class="highlighter-rouge">out</code> files will be automatically assigned for use with the downstream pipelines.</p>

<p>Parameter <code class="highlighter-rouge">cache</code> is also a file name string, but it is not a module output. This will create a situation where a properly named file <code class="highlighter-rouge">*.cache</code> is generated to the output directory yet we do not keep track of it: We keep these files just in case we may want to examine them to debug.</p>

<p>One can also use the <code class="highlighter-rouge">.</code> notation for file extensions to enhance readability, for example <code class="highlighter-rouge">file(.txt)</code> is equivalent to <code class="highlighter-rouge">file(txt)</code>.</p>

<h2 id="load-modules-from-other-files">Load modules from other files</h2>

<p>We provide preliminary support to load modules from other files, using <code class="highlighter-rouge">%include</code>, eg.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">%</span><span class="s">include /path/to/other/file1</span>
<span class="err">%</span><span class="s">include /path/to/other/file2</span>
</code></pre></div></div>

<p>It will (recursively) load modules from other files. This feature is useful particularly in a collaborative development of a DSC that each developer can write their own module file and use a “master” DSC file to include them all.</p>

<h2 id="improving-dsc-script-readability">Improving DSC script readability</h2>
<h3 id="use-comments">Use comments</h3>
<p>As with many scripting languages (R, Python, shell), <code class="highlighter-rouge">#</code> can be used to make human-readable explanation to the contents of DSC script. We suggest using single <code class="highlighter-rouge">#</code> to distinguish between various types of syntax groups introduced in this document, and double <code class="highlighter-rouge">##</code> to annotate parameters. For example:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Various modules to estimate location parameter</span>
<span class="s">mean, median</span><span class="pi">:</span> <span class="s">mean.R, median.R</span>
    <span class="s"># parameters</span>
    <span class="s">## set to 0 for no winsorization</span>
    <span class="s">winsorize</span><span class="pi">:</span> <span class="s">0, 0.02</span>
    <span class="s"># input</span>
    <span class="s">x</span><span class="pi">:</span> <span class="s">$x</span>
    <span class="s"># output</span>
    <span class="s">$mean</span><span class="pi">:</span> <span class="s">mean</span>
    <span class="s"># decorators</span>
    <span class="s">@ALIAS</span><span class="pi">:</span>
        <span class="na">median</span><span class="pi">:</span> <span class="s">w = winsorize</span>
</code></pre></div></div>

<h3 id="turn-on-yaml-syntax-highlighter">Turn on YAML syntax highlighter</h3>
<p>Although DSC script is not compatible with YAML, the syntax highlighter for YAML is good enough to enhance readability of DSC scripts. You may turn on the YAML syntax highlighter in your text editor when composing DSC scripts.</p>

              <nav class="c-page__nav">
  
    
    <a id="js-page__nav__prev" class="c-page__nav__prev" href="/dsc-wiki/reference/Terminology">
      〈 <span class="u-margin-right-tiny"></span> Terminology
    </a>
  

  
    
    <a id="js-page__nav__next" class="c-page__nav__next" href="/dsc-wiki/reference/DSC_Execution">
      Running DSC <span class="u-margin-right-tiny"></span> 〉
    </a>
  
</nav>

            </div>
          </div>
        </div>
      </main>
    </div>

  </body>
</html>
