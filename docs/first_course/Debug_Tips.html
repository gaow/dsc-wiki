<!DOCTYPE html>
<html lang="en">
  

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">

  <title>Debug in DSC</title>
  <meta name="description" content="">

  <link rel="canonical" href="https://stephenslab.github.io/dsc-wiki/first_course/Debug_Tips.html">
  <link rel="alternate" type="application/rss+xml" title="DSC" href="https://stephenslab.github.io/dsc-wiki/feed.xml">

  <meta property="og:url"         content="https://stephenslab.github.io/dsc-wiki/first_course/Debug_Tips.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Debug in DSC" />
<meta property="og:description" content="" />
<meta property="og:image"       content="" />


  <script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage":
    "https://stephenslab.github.io/dsc-wiki/first_course/Debug_Tips.html",
  "headline":
    "Debug in DSC",
  "datePublished":
    "2020-01-04T10:23:40-06:00",
  "dateModified":
    "2020-01-04T10:23:40-06:00",
  "description":
    "",
  "author": {
    "@type": "Person",
    "name": "Stephens Lab, University of Chicago"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Data 100 at UC Berkeley",
    "logo": {
      "@type": "ImageObject",
      "url": "https://stephenslab.github.io/dsc-wiki",
      "width": 60,
      "height": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "https://stephenslab.github.io/dsc-wiki",
    "height": 60,
    "width": 60
  }
}

  </script>
  <link rel="stylesheet" href="/dsc-wiki/assets/css/styles.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css ">
  <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">

  <!-- <link rel="manifest" href="/manifest.json"> -->
  <!-- <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#efae0a"> -->
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#233947">

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="/dsc-wiki/images/favicon.ico">

  <!-- MathJax Config -->
  <!-- Allow inline math using $ and automatically break long math lines -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    CommonHTML: {
        linebreaks: {
            automatic: true,
        },
    },
});
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML' async></script>

  <!-- DOM updating function -->
  <script>
const runWhenDOMLoaded = cb => {
  if (document.readyState != 'loading') {
    cb()
  } else if (document.addEventListener) {
    document.addEventListener('DOMContentLoaded', cb)
  } else {
    document.attachEvent('onreadystatechange', function() {
      if (document.readyState == 'complete') cb()
    })
  }
}

// Helper function to init things quickly
initFunction = function(myfunc) {
  runWhenDOMLoaded(myfunc);
  document.addEventListener('turbolinks:load', myfunc);
};
</script>

  <!-- Define some javascript variables that will be useful in other javascript -->
  <script>
    const site_basename = '/dsc-wiki';
  </script>

  <!-- Add AnchorJS to let headers be linked -->
  <script src="/dsc-wiki/assets/js/anchor.min.js"  type="text/javascript"></script>
  <script>

initFunction(function () {
    anchors.add("main h1, main h2, main h3, main h4")
});

</script>

  <!-- Include Turbolinks to make page loads fast -->
  <!-- https://github.com/turbolinks/turbolinks -->
  <script src="/dsc-wiki/assets/js/turbolinks.js" async></script>
  <meta name="turbolinks-cache-control" content="no-cache">

  <!-- Load nbinteract for widgets -->
  

  <!-- Load Thebelab for interactive widgets -->
  <!-- Include Thebelab for interactive code if it's enabled -->



  <!-- Load the auto-generating TOC -->
  <script src="/dsc-wiki/assets/js/tocbot.min.js"  type="text/javascript"></script>
  <script>
var initToc = function () {
  tocbot.init({
    tocSelector: 'nav.onthispage',
    contentSelector: '.c-textbook__content',
    headingSelector: 'h2, h3',
    orderedList: false,
    collapseDepth: 6,
    listClass: 'toc__menu',
    activeListItemClass: "",  // Not using
    activeLinkClass: "", // Not using
  });
  tocbot.refresh();
}
initFunction(initToc);
</script>

  <!-- Google analytics -->
  <script src="/dsc-wiki/assets/js/ga.js" async></script>

  <!-- Clipboard copy button -->
  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" async></script>

  <!-- Load JS that depends on site variables -->
  <script>
/**
 * Set up copy/paste for code blocks
 */
const codeCellId = index => `codecell${index}`

const clipboardButton = id =>
  `<a id="copy-button-${id}" class="btn copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#${id}">
    <img src="/dsc-wiki/assets/images/copy-button.svg" alt="Copy to clipboard">
  </a>`

// Clears selected text since ClipboardJS will select the text when copying
const clearSelection = () => {
  if (window.getSelection) {
    window.getSelection().removeAllRanges()
  } else if (document.selection) {
    document.selection.empty()
  }
}

// Changes tooltip text for two seconds, then changes it back
const temporarilyChangeTooltip = (el, newText) => {
  const oldText = el.getAttribute('data-tooltip')
  el.setAttribute('data-tooltip', newText)
  setTimeout(() => el.setAttribute('data-tooltip', oldText), 2000)
}

const addCopyButtonToCodeCells = () => {
  // If ClipboardJS hasn't loaded, wait a bit and try again. This
  // happens because we load ClipboardJS asynchronously.
  if (window.ClipboardJS === undefined) {
    setTimeout(addCopyButtonToCodeCells, 250)
    return
  }

  const codeCells = document.querySelectorAll('div.c-textbook__content > div.highlighter-rouge > div.highlight > pre, div.input_area pre')
  codeCells.forEach((codeCell, index) => {
    const id = codeCellId(index)
    codeCell.setAttribute('id', id)
    if (document.getElementById("copy-button" + id) == null) {
      codeCell.insertAdjacentHTML('afterend', clipboardButton(id));
    }
  })

  const clipboard = new ClipboardJS('.copybtn')
  clipboard.on('success', event => {
    clearSelection()
    temporarilyChangeTooltip(event.trigger, 'Copied!')
  })

  clipboard.on('error', event => {
    temporarilyChangeTooltip(event.trigger, 'Failed to copy')
  })

  // Get rid of clipboard before the next page visit to avoid memory leak
  document.addEventListener('turbolinks:before-visit', () =>
    clipboard.destroy()
  )
}

initFunction(addCopyButtonToCodeCells);
</script>


  <!-- Hide cell code -->
  <script>
    /**
    Add buttons to hide code cells
    */


    var setCodeCellVisibility = function (inputField, kind) {
        // Update the image and class for hidden
        var id = inputField.getAttribute('data-id');
        var codeCell = document.querySelector(`#${id} div.highlight`);

        if (kind === "visible") {
            codeCell.classList.remove('hidden');
            inputField.checked = true;
        } else {
            codeCell.classList.add('hidden');
            inputField.checked = false;
        }
    }

    var toggleCodeCellVisibility = function (event) {
        // The label is clicked, and now we decide what to do based on the input field's clicked status
        if (event.target.tagName === "LABEL") {
            var inputField = event.target.previousElementSibling;
        } else {
            // It is the span inside the target
            var inputField = event.target.parentElement.previousElementSibling;
        }

        if (inputField.checked === true) {
            setCodeCellVisibility(inputField, "visible");
        } else {
            setCodeCellVisibility(inputField, "hidden");
        }
    }


    // Button constructor
    const hideCodeButton = id => `<input class="hidebtn" type="checkbox" id="hidebtn${id}" data-id="${id}"><label title="Toggle cell" for="hidebtn${id}" class="plusminus"><span class="pm_h"></span><span class="pm_v"></span></label>`

    var addHideButton = function () {
        // If a hide button is already added, don't add another
        if (document.querySelector('div.hidecode input') !== null) {
            return;
        }

        // Find the input cells and add a hide button
        document.querySelectorAll('div.input_area').forEach(function (item, index) {
            if (!item.classList.contains("hidecode")) {
                // Skip the cell if it doesn't have a hidecode class
                return;
            }

            const id = codeCellId(index)
            item.setAttribute('id', id);
            // Insert the button just inside the end of the next div
            item.querySelector('div').insertAdjacentHTML('beforeend', hideCodeButton(id))

            // Set up the visibility toggle
            hideLink = document.querySelector(`#${id} div.highlight + input + label`);
            hideLink.addEventListener('click', toggleCodeCellVisibility)
        });
    }


    // Initialize the hide buttos
    var initHiddenCells = function () {
        // Add hide buttons to the cells
        addHideButton();

        // Toggle the code cells that should be hidden
        document.querySelectorAll('div.hidecode input').forEach(function (item) {
            setCodeCellVisibility(item, 'hidden');
            item.checked = true;
        })
    }

    initFunction(initHiddenCells);

</script>

  <!-- Load custom website scripts -->
  <script src="/dsc-wiki/assets/js/scripts.js" async></script>

  <!-- Load custom user CSS and JS  -->
  <script src="/dsc-wiki/assets/custom/custom.js" async></script>
  <link rel="stylesheet" href="/dsc-wiki/assets/custom/custom.css">

  <!-- Update interact links w/ REST param, is defined in includes so we can use templates -->
  

  <!-- Lunr search code - will only be executed on the /search page -->
  <script src="/dsc-wiki/assets/js/lunr/lunr.min.js" type="text/javascript"></script>
  <script>var initQuery = function() {
  // See if we have a search box
  var searchInput = document.querySelector('input#lunr_search');
  if (searchInput === null) {
    return;
  }

  // Function to parse our lunr cache
  var idx = lunr(function () {
    this.field('title')
    this.field('excerpt')
    this.field('categories')
    this.field('tags')
    this.ref('id')

    this.pipeline.remove(lunr.trimmer)

    for (var item in store) {
      this.add({
        title: store[item].title,
        excerpt: store[item].excerpt,
        categories: store[item].categories,
        tags: store[item].tags,
        id: item
      })
    }
  });

  // Run search upon keyup
  searchInput.addEventListener('keyup', function () {
    var resultdiv = document.querySelector('#results');
    var query = document.querySelector("input#lunr_search").value.toLowerCase();
    var result =
      idx.query(function (q) {
        query.split(lunr.tokenizer.separator).forEach(function (term) {
          q.term(term, { boost: 100 })
          if(query.lastIndexOf(" ") != query.length-1){
            q.term(term, {  usePipeline: false, wildcard: lunr.Query.wildcard.TRAILING, boost: 10 })
          }
          if (term != ""){
            q.term(term, {  usePipeline: false, editDistance: 1, boost: 1 })
          }
        })
      });

      // Empty the results div
      while (resultdiv.firstChild) {
        resultdiv.removeChild(resultdiv.firstChild);
      }

    resultdiv.insertAdjacentHTML('afterbegin', '<p class="results__found">'+result.length+' Result(s) found</p>');
    for (var item in result) {
      var ref = result[item].ref;
      if(store[ref].teaser){
        var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<div class="archive__item-teaser">'+
                '<img src="'+store[ref].teaser+'" alt="">'+
              '</div>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      else{
    	  var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      resultdiv.insertAdjacentHTML('beforeend', searchitem);
    }
  });
};

initFunction(initQuery);
</script>
</head>

  <body>
    <!-- .js-show-sidebar shows sidebar by default -->
    <div id="js-textbook" class="c-textbook js-show-sidebar">
      



<nav id="js-sidebar" class="c-textbook__sidebar">
  <a href="https://github.com/stephenslab/dsc"><img src="/dsc-wiki/images/logo.png" class="textbook_logo" id="sidebar-logo" data-turbolinks-permanent/></a>
  <h2 class="c-sidebar__title">DSC</h2>
  <ul class="c-sidebar__chapters">
    
      
      
        <li class="c-sidebar__chapter"><a class="c-sidebar__entry" href="/dsc-wiki/search.html"><img src="/dsc-wiki/images/search.svg" alt="Search This Wiki"></a></li>
        
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsc-wiki/overview.html"
        >
          
          Home
        </a>

        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsc-wiki/installation.html"
        >
          
          Installation
        </a>

        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsc-wiki/faq.html"
        >
          
          FAQ
        </a>

        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsc-wiki/reference/reference.html"
        >
          
          Reference manual
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/reference/Terminology.html"
                >
                  
                  Terminology
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/reference/DSC_Configuration.html"
                >
                  
                  DSC configuration syntax
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/reference/DSC_Execution.html"
                >
                  
                  Running DSC
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/reference/DSC_Filtering.html"
                >
                  
                  Extracting DSC results
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/reference/Command_Options.html"
                >
                  
                  Command-line reference
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/reference/Road_Map.html"
                >
                  
                  Development roadmap
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/reference/Implementation_Details.html"
                >
                  
                  Implementation details
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/reference/Unsupported_Features.html"
                >
                  
                  Unsupported features
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      
        <li class="c-sidebar__divider"></li>
        
      
      
        <li><h2 class="c-sidebar__title">User guide</li>
        
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsc-wiki/first_course/first_course.html"
        >
          
          First course on DSC
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/first_course/Intro_DSC.html"
                >
                  
                  A brief introduction to DSC
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/first_course/Intro_Syntax_I.html"
                >
                  
                  DSC basics, part I
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/first_course/Intro_Syntax_II.html"
                >
                  
                  DSC basics, part II
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/first_course/Prototype_Tips.html"
                >
                  
                  Developing benchmarks
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry c-sidebar__entry--active"
                  href="/dsc-wiki/first_course/Debug_Tips.html"
                >
                  
                  Debug in DSC
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/first_course/Syntax_Tips.html"
                >
                  
                  Syntax tips
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsc-wiki/faq.html"
        >
          
          Other tutorials
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/advanced_course/5_Minutes_Python.html"
                >
                  
                  Working with Python
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/advanced_course/DSC_Data.html"
                >
                  
                  DSC data flow
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/advanced_course/5_Minutes_RPY.html"
                >
                  
                  Working with R and Python
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/advanced_course/Multiple_Pipelines.html"
                >
                  
                  Running multiple pipelines
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/advanced_course/Rmd_Executable.html"
                >
                  
                  Using Rmd files as module executables
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/advanced_course/Remote_Computations.html"
                >
                  
                  Running DSC on remote computers
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/advanced_course/DSC_Docker.html"
                >
                  
                  Running DSC in Docker
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsc-wiki/examples.html"
        >
          
          Benchmark examples
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/examples/R_Example_1.html"
                >
                  
                  R Example 1
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/examples/R_Example_2.html"
                >
                  
                  R Example 2
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
  </ul>
  <p class="sidebar_footer">Copyright (c) 2016-2019 <br> <a href="http://home.uchicago.edu/gaow">Gao Wang</a>, <a href="http://stephenslab.uchicago.edu">Matthew Stephens</a>, <a href="https://pcarbo.github.io">Peter Carbonetto</a> and contributors.<br></p>
</nav>

      
      <!-- Empty sidebar placeholder that we'll auto-fill with javascript -->
      <aside class="sidebar__right">
          <header><h4 class="nav__title"><i class="fa fa-list"></i>   Contents</h4></header>
          <nav class="onthispage">
          </nav>
      </aside>
      
      <main class="c-textbook__page" tabindex="-1">
          <div class="o-wrapper">
            <div class="c-sidebar-toggle">
  <!-- We show the sidebar by default so we use .is-active -->
  <button
    id="js-sidebar-toggle"
    class="hamburger hamburger--arrowalt is-active"
  >
    <span class="hamburger-box">
      <span class="hamburger-inner"></span>
    </span>
    <span class="c-sidebar-toggle__label">Toggle Sidebar</span>
  </button>
</div>

            

            <div class="c-textbook__content">
              <h1 id="debug-in-dsc">Debug in DSC</h1>

<h2 id="module-executable-and-generated-script">Module executable and generated script</h2>

<p>As seen from previous tutorials, <a href="../external/dsc_results.html">module executables in DSC</a> are in fact incomplete code chunks due to lack of input data and parameter specifications to run. Under the hood, DSC generates R, Python or Shell scripts based on module executable scripts, adding to it specification of module parameters and pipeline variables, then executes the complete script. This generated script is subject to two types of errors:</p>

<ol>
  <li>Inconsistency between DSC interface and module executables</li>
  <li>Error from module executables as provided</li>
</ol>

<p>In the presence of errors DSC will fail. However the automatically generated script will be saved to disk and will be pointed to you as part of the error prompt on the command console so that you can reproduce and fix the bugs.</p>

<p>Here we look at <a href="https://github.com/stephenslab/dsc/tree/master/vignettes/one_sample_location_debug">this toy example</a>. We undermine the setup to demonstrate the 2 types of errors we have discussed.</p>

<h2 id="buggy-dsc-interface">Buggy DSC interface</h2>

<p>To demonstrate inconsistency between interface and module we change the first block of DSC script from:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">normal</span><span class="pi">:</span> <span class="s">R(x &lt;- rnorm(n,mean = mu,sd = 1))</span>
  <span class="s">mu</span><span class="pi">:</span> <span class="m">0</span>
  <span class="na">n</span><span class="pi">:</span> <span class="m">100</span>
  <span class="s">$data</span><span class="pi">:</span> <span class="s">x</span>
  <span class="s">$true_mean</span><span class="pi">:</span> <span class="s">mu</span>
</code></pre></div></div>

<p>to:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">normal</span><span class="pi">:</span> <span class="s">R(x &lt;- rnorm(n,mean = mu,sd = 1))</span>
  <span class="s">nu</span><span class="pi">:</span> <span class="m">0</span>
  <span class="na">n</span><span class="pi">:</span> <span class="m">100</span>
  <span class="s">$data</span><span class="pi">:</span> <span class="s">x</span>
  <span class="s">$true_mean</span><span class="pi">:</span> <span class="s">mu</span>
</code></pre></div></div>

<p>creating a parameter <code class="language-plaintext highlighter-rouge">nu</code>, a typo of <code class="language-plaintext highlighter-rouge">mu</code>, that does not exist in <code class="language-plaintext highlighter-rouge">normal</code> module <code class="language-plaintext highlighter-rouge">rt.R</code>. Consequently the required <code class="language-plaintext highlighter-rouge">mu</code> variable for these routines will not be provided by DSC interface. We save this configuration file as <code class="language-plaintext highlighter-rouge">first_error_v1.dsc</code> and run it:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> ~/GIT/dsc/vignettes/one_sample_location_debug
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dsc first_error_v1.dsc <span class="nt">-o</span> dsc_result
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>INFO: DSC script exported to dsc_result.html
INFO: Constructing DSC from first_error_v1.dsc ...
INFO: Building execution graph &amp; running DSC ...
[ERROR: Command 'Rscript .sos/normal_0_0_5b69d818.R' returned non-zero exit status 1.
##############] 15 steps processed (15 jobs completed)
ERROR: [21ba7975-8686-4984-af28-09f2b8c83fa3]: [normal]: 
Failed to execute Rscript .sos/normal_0_0_5b69d818.R
exitcode=1, workdir=/home/gaow/Documents/GIT/dsc/vignettes/one_sample_location_debug, stderr=dsc_result/normal/normal_1.stderr
---------------------------------------------------------------------------
[DSC]: Workflow exited due to failed step a_normal (a_normal).
WARNING: Files in green in the error prompt above contains codes and error info to help debug.
Scripts upstream of the error can be found in dsc_result.scripts.html.
INFO: Elapsed time 4.896 seconds.
</code></pre></div></div>

<p>The error message is a bit wordy but the part most relevant to debugging are highlighted in green color on your terminal. In this case multiple generated scripts have failed, but the cause is likely the same. You can try to resolve the problem starting from the last error message and see if the fix will help with other errors.</p>

<p>You can also see that a file called <code class="language-plaintext highlighter-rouge">dsc_result.scripts.html</code> is generated. It bundles generated scripts from all module instances involved in the benchmark up to the point the errors occur.</p>

<h3 id="debug-with-the-problematic-script">Debug with the problematic script</h3>

<p>As prompted in the error message, let’s see what’s inside <code class="language-plaintext highlighter-rouge">dsc_result/normal/normal_1.stderr</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat </span>dsc_result/normal/normal_1.stderr
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Error in rnorm(n, mean = mu, sd = 1) : object 'mu' not found
Execution halted
</code></pre></div></div>

<p>Okey so what’s going on? Let’s take a look at this script:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> .sos/normal_0_0_5b69d818.R
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## r script UUID: 89241936</span><span class="w">

</span><span class="n">DSC_REPLICATE</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="w">
</span><span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">100</span><span class="w">
</span><span class="n">nu</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0</span><span class="w">
</span><span class="n">TIC_C1997B87</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">proc.time</span><span class="p">()</span><span class="w">
</span><span class="n">set.seed</span><span class="p">(</span><span class="n">DSC_REPLICATE</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">89241936</span><span class="p">)</span><span class="w">

</span><span class="c1">## BEGIN DSC CORE</span><span class="w">
</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rnorm</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mu</span><span class="p">,</span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">
</span><span class="c1">## END DSC CORE</span><span class="w">

</span><span class="n">saveRDS</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">true_mean</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="n">DSC_DEBUG</span><span class="o">=</span><span class="n">dscrutils</span><span class="o">::</span><span class="n">save_session</span><span class="p">(</span><span class="n">TIC_C1997B87</span><span class="p">,</span><span class="w"> </span><span class="n">DSC_REPLICATE</span><span class="p">)),</span><span class="w"> </span><span class="s1">'dsc_result/normal/normal_1.rds'</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>It seems like the line <code class="language-plaintext highlighter-rouge">x &lt;- rnorm(n,mean = mu,sd = 1)</code> looks for variable <code class="language-plaintext highlighter-rouge">mu</code>, which was not previously defined in the script. We know from the <a href="https://github.com/stephenslab/dsc/blob/master/vignettes/one_sample_location_debug/first_error_v1.dsc">DSC script</a> that we had set <code class="language-plaintext highlighter-rouge">nu</code> not <code class="language-plaintext highlighter-rouge">mu</code>. So obviously there is a glitch on the interface which can be fixed by changing <code class="language-plaintext highlighter-rouge">nu</code> to <code class="language-plaintext highlighter-rouge">mu</code> in the DSC script.</p>

<p>In practice when you run into problems that you cannot immediately tell what is going on from <code class="language-plaintext highlighter-rouge">err</code> file or script file, you should load the problematic script <code class="language-plaintext highlighter-rouge">.sos/normal_0_0_5b69d818.R</code> to some interactive session, try to debug and fix the script from there (do not worry about changing this script), test until it works. Then you should have learned where the problem is, and you can apply what you’ve learned to patching DSC script or the original module code. <em>Fixing these generated scripts is not enough as they will be overwritten next time DSC runs</em>.</p>

<h2 id="buggy-module-script">Buggy module script</h2>

<p>Now let’s undermine the module code instead. We change from:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mean</span><span class="o">:</span><span class="w"> </span><span class="n">R</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<p>to</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mean</span><span class="o">:</span><span class="w"> </span><span class="n">R</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"meow"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>As you can probably tell, this will not result an error for this module, but may impact downstream ones. So let’s find it out!</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dsc first_error_v2.dsc <span class="nt">-o</span> dsc_result
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>INFO: DSC script exported to dsc_result.html
INFO: Constructing DSC from first_error_v2.dsc ...
INFO: Building execution graph &amp; running DSC ...
[################ERROR: Command 'Rscript .sos/sq_err_0_9fcb14a9.R' returned non-zero exit status 1.
##ERROR: Command 'Rscript .sos/abs_err_0_c33b79b0.R' returned non-zero exit status 1.
WARNING: Removing dsc_result/abs_err/t_1_mean_1_abs_err_1.rds generated by failed step abs_err.
#ERROR: Command 'Rscript .sos/abs_err_0_afedb9d0.R' returned non-zero exit status 1.
#ERROR: Command 'Rscript .sos/sq_err_0_4888d737.R' returned non-zero exit status 1.
WARNING: Removing dsc_result/sq_err/t_1_mean_1_sq_err_1.rds generated by failed step sq_err.
] 24 steps processed (20 jobs completed, 4 jobs ignored)
ERROR: [38a1aade-66fd-45e5-a87d-5ecc8710eb7e]: [sq_err]: 
Failed to execute Rscript .sos/sq_err_0_9fcb14a9.R
exitcode=1, workdir=/home/gaow/Documents/GIT/dsc/vignettes/one_sample_location_debug, stderr=dsc_result/sq_err/normal_2_mean_2_sq_err_2.stderr
---------------------------------------------------------------------------
[8e70c4f4-ef5e-4957-88e6-e352cd3e0f81]: [abs_err]: 
Failed to execute Rscript .sos/abs_err_0_c33b79b0.R
exitcode=1, workdir=/home/gaow/Documents/GIT/dsc/vignettes/one_sample_location_debug, stderr=dsc_result/abs_err/t_1_mean_1_abs_err_1.stderr
---------------------------------------------------------------------------
[c8dc53a9-e837-44ae-9c29-43eaa4361e47]: [abs_err]: 
Failed to execute Rscript .sos/abs_err_0_afedb9d0.R
exitcode=1, workdir=/home/gaow/Documents/GIT/dsc/vignettes/one_sample_location_debug, stderr=dsc_result/abs_err/normal_2_mean_2_abs_err_2.stderr
---------------------------------------------------------------------------
[651ba0a5-fed0-49e3-8824-de7110f233a2]: [sq_err]: 
Failed to execute Rscript .sos/sq_err_0_4888d737.R
exitcode=1, workdir=/home/gaow/Documents/GIT/dsc/vignettes/one_sample_location_debug, stderr=dsc_result/sq_err/t_1_mean_1_sq_err_1.stderr
---------------------------------------------------------------------------
[DSC]: Workflow exited due to failed steps a_abs_err (a_abs_err), b_sq_err (b_sq_err), e_abs_err (e_abs_err), f_sq_err (f_sq_err).
WARNING: Files in green in the error prompt above contains codes and error info to help debug.
Scripts upstream of the error can be found in dsc_result.scripts.html.
INFO: Elapsed time 4.544 seconds.
</code></pre></div></div>

<p>So there are multiple module failures. In case like this we should check and fix the first one first. Same as before, we check:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat </span>dsc_result/abs_err/t_1_mean_1_abs_err_1.stderr
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Error in x - y : non-numeric argument to binary operator
Execution halted
</code></pre></div></div>

<p>It is not immediately clear what is going on, so we examine the code <code class="language-plaintext highlighter-rouge">.sos/abs_err_0_0_73c4c826.R</code> by adding a couple of <code class="language-plaintext highlighter-rouge">print</code> commands before the line in question:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## r script UUID: 90107557</span><span class="w">

</span><span class="n">DSC_A0BFA20F</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">list</span><span class="p">()</span><span class="w">
</span><span class="n">DSC_A0BFA20F</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dscrutils</span><span class="o">::</span><span class="n">load_inputs</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s1">'dsc_result/normal/normal_1.rds'</span><span class="p">,</span><span class="s1">'dsc_result/mean/normal_1_mean_1.rds'</span><span class="p">),</span><span class="w"> </span><span class="n">dscrutils</span><span class="o">::</span><span class="n">read_dsc</span><span class="p">)</span><span class="w">
</span><span class="n">DSC_REPLICATE</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">DSC_A0BFA20F</span><span class="o">$</span><span class="n">DSC_DEBUG</span><span class="o">$</span><span class="n">replicate</span><span class="w">
</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">DSC_A0BFA20F</span><span class="o">$</span><span class="n">est_mean</span><span class="w">
</span><span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">DSC_A0BFA20F</span><span class="o">$</span><span class="n">true_mean</span><span class="w">
</span><span class="n">TIC_A0BFA20F</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">proc.time</span><span class="p">()</span><span class="w">
</span><span class="n">set.seed</span><span class="p">(</span><span class="n">DSC_REPLICATE</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">90107557</span><span class="p">)</span><span class="w">

</span><span class="c1">## BEGIN DSC CORE</span><span class="w">

</span><span class="n">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">
</span><span class="n">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="w">
</span><span class="n">e</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">abs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w">
</span><span class="c1">## END DSC CORE</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] "meow"
[1] 0

Error in x - y: non-numeric argument to binary operator
Traceback:
</code></pre></div></div>

<p>It looks like <code class="language-plaintext highlighter-rouge">x</code>, instead of being a number, is a string <code class="language-plaintext highlighter-rouge">meow</code>. Therefore the line <code class="language-plaintext highlighter-rouge">e &lt;- abs(x - y)</code> is doomed to fail. We know from the DSC script that <code class="language-plaintext highlighter-rouge">x</code> comes from an upstream module group <code class="language-plaintext highlighter-rouge">analyze</code>, that somehow returned <code class="language-plaintext highlighter-rouge">meow</code> as output. We can also see from this script that the variable comes from one of <code class="language-plaintext highlighter-rouge">'dsc_result/normal/normal_1.rds','dsc_result/mean/normal_1_mean_1.rds'</code>. From our knowledge of the DSC script we know it should come from <code class="language-plaintext highlighter-rouge">'dsc_result/mean/normal_1_mean_1.rds'</code> the <code class="language-plaintext highlighter-rouge">mean</code> module. Therefore there is nothing we can do in the current script to fix the problem.</p>

<h3 id="debugging-with-upstream-scripts">Debugging with upstream scripts</h3>

<p>Now we want to find out what has produced the problematic <code class="language-plaintext highlighter-rouge">x</code> variable. That is, we want to find the module instance that generated <code class="language-plaintext highlighter-rouge">'dsc_result/mean/normal_1_mean_1.rds'</code> from which <code class="language-plaintext highlighter-rouge">x</code> is loaded. However the problematic script above did not tell us where this data comes from. This leads us to examine other scripts in the benchmark that leads to the error, in <a href="../external/dsc_result.scripts_e2.html"><code class="language-plaintext highlighter-rouge">dsc_result.scripts.html</code></a>.</p>

<p>You can open up <a href="../external/dsc_result.scripts_e2.html">this file</a> in your web browser, and <em>search</em> (<code class="language-plaintext highlighter-rouge">ctrl-F</code>) for the phrase <code class="language-plaintext highlighter-rouge">dsc_result/mean/normal_1_mean_1.rds</code>. This leads you to the following:</p>

<p><img src="../images/debug-tips-1.png" alt="debug-1" /></p>

<p>Unsurprisingly, running these code by itself produces no error message – this is expected because otherwise DSC would have failed at this stage. However we know from previous investigation that the output does not look right. For this example we can spot instantly that the <code class="language-plaintext highlighter-rouge">meow</code> string somehow 🐱 replaced the code for location parameter estimation; and we can fix it easily. In practice, one may need to load both this code chunk and the previous <code class="language-plaintext highlighter-rouge">.sos/abs_err_0_0_73c4c826.R</code> to an interactive session, fix it until <code class="language-plaintext highlighter-rouge">.sos/abs_err_0_0_73c4c826.R</code> works, and apply the knowledge learned to the original module line <code class="language-plaintext highlighter-rouge">mean: R(y &lt;- "meow")</code> in the DSC script.</p>

<h2 id="more-output-info">More output info</h2>

<p>The run-time information are kept in greater when running DSC with verbosity level greater than <code class="language-plaintext highlighter-rouge">2</code>. Though typically unnecessary, if you still cannot fix issues at this point it may help re-running benchmark with <code class="language-plaintext highlighter-rouge">-v 4</code> and look into the screen output (or, redirect them to a file) for more run-time information to help performing diagnostics.</p>

              <nav class="c-page__nav">
  
    
    <a id="js-page__nav__prev" class="c-page__nav__prev" href="/dsc-wiki/first_course/Prototype_Tips.html">
      〈 <span class="u-margin-right-tiny"></span> Developing benchmarks
    </a>
  

  
    
    <a id="js-page__nav__next" class="c-page__nav__next" href="/dsc-wiki/first_course/Syntax_Tips.html">
      Syntax tips <span class="u-margin-right-tiny"></span> 〉
    </a>
  
</nav>

            </div>
          </div>
        </div>
      </main>
    </div>

  </body>
</html>
