<!DOCTYPE html>
<html lang="en">
  

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">

  <title>DSC basics, part II</title>
  <meta name="description" content="DSC Basics, Part II">

  <link rel="canonical" href="https://stephenslab.github.io/dsc-wiki/first_course/Intro_Syntax_II.html">
  <link rel="alternate" type="application/rss+xml" title="DSC" href="https://stephenslab.github.io/dsc-wiki/feed.xml">

  <meta property="og:url"         content="https://stephenslab.github.io/dsc-wiki/first_course/Intro_Syntax_II.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="DSC basics, part II" />
<meta property="og:description" content="DSC Basics, Part II" />
<meta property="og:image"       content="" />


  <script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage":
    "https://stephenslab.github.io/dsc-wiki/first_course/Intro_Syntax_II.html",
  "headline":
    "DSC basics, part II",
  "datePublished":
    "2019-05-04T14:08:13-05:00",
  "dateModified":
    "2019-05-04T14:08:13-05:00",
  "description":
    "DSC Basics, Part II",
  "author": {
    "@type": "Person",
    "name": "Stephens Lab, University of Chicago"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Data 100 at UC Berkeley",
    "logo": {
      "@type": "ImageObject",
      "url": "https://stephenslab.github.io/dsc-wiki",
      "width": 60,
      "height": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "https://stephenslab.github.io/dsc-wiki",
    "height": 60,
    "width": 60
  }
}

  </script>
  <link rel="stylesheet" href="/dsc-wiki/assets/css/styles.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css ">
  <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">

  <!-- <link rel="manifest" href="/manifest.json"> -->
  <!-- <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#efae0a"> -->
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#233947">

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="/dsc-wiki/images/favicon.ico">

  <!-- MathJax Config -->
  <!-- Allow inline math using $ and automatically break long math lines -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    CommonHTML: {
        linebreaks: {
            automatic: true,
        },
    },
});
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML' async></script>

  <!-- DOM updating function -->
  <script>
const runWhenDOMLoaded = cb => {
  if (document.readyState != 'loading') {
    cb()
  } else if (document.addEventListener) {
    document.addEventListener('DOMContentLoaded', cb)
  } else {
    document.attachEvent('onreadystatechange', function() {
      if (document.readyState == 'complete') cb()
    })
  }
}

// Helper function to init things quickly
initFunction = function(myfunc) {
  runWhenDOMLoaded(myfunc);
  document.addEventListener('turbolinks:load', myfunc);
};
</script>

  <!-- Define some javascript variables that will be useful in other javascript -->
  <script>
    const site_basename = '/dsc-wiki';
  </script>

  <!-- Add AnchorJS to let headers be linked -->
  <script src="/dsc-wiki/assets/js/anchor.min.js"  type="text/javascript"></script>
  <script>

initFunction(function () {
    anchors.add("main h1, main h2, main h3, main h4")
});

</script>

  <!-- Include Turbolinks to make page loads fast -->
  <!-- https://github.com/turbolinks/turbolinks -->
  <script src="/dsc-wiki/assets/js/turbolinks.js" async></script>
  <meta name="turbolinks-cache-control" content="no-cache">

  <!-- Load nbinteract for widgets -->
  

  <!-- Load Thebelab for interactive widgets -->
  <!-- Include Thebelab for interactive code if it's enabled -->



  <!-- Load the auto-generating TOC -->
  <script src="/dsc-wiki/assets/js/tocbot.min.js"  type="text/javascript"></script>
  <script>
var initToc = function () {
  tocbot.init({
    tocSelector: 'nav.onthispage',
    contentSelector: '.c-textbook__content',
    headingSelector: 'h2, h3',
    orderedList: false,
    collapseDepth: 6,
    listClass: 'toc__menu',
    activeListItemClass: "",  // Not using
    activeLinkClass: "", // Not using
  });
  tocbot.refresh();
}
initFunction(initToc);
</script>

  <!-- Google analytics -->
  <script src="/dsc-wiki/assets/js/ga.js" async></script>

  <!-- Clipboard copy button -->
  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" async></script>

  <!-- Load JS that depends on site variables -->
  <script>
/**
 * Set up copy/paste for code blocks
 */
const codeCellId = index => `codecell${index}`

const clipboardButton = id =>
  `<a id="copy-button-${id}" class="btn copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#${id}">
    <img src="/dsc-wiki/assets/images/copy-button.svg" alt="Copy to clipboard">
  </a>`

// Clears selected text since ClipboardJS will select the text when copying
const clearSelection = () => {
  if (window.getSelection) {
    window.getSelection().removeAllRanges()
  } else if (document.selection) {
    document.selection.empty()
  }
}

// Changes tooltip text for two seconds, then changes it back
const temporarilyChangeTooltip = (el, newText) => {
  const oldText = el.getAttribute('data-tooltip')
  el.setAttribute('data-tooltip', newText)
  setTimeout(() => el.setAttribute('data-tooltip', oldText), 2000)
}

const addCopyButtonToCodeCells = () => {
  // If ClipboardJS hasn't loaded, wait a bit and try again. This
  // happens because we load ClipboardJS asynchronously.
  if (window.ClipboardJS === undefined) {
    setTimeout(addCopyButtonToCodeCells, 250)
    return
  }

  const codeCells = document.querySelectorAll('div.c-textbook__content > div.highlighter-rouge > div.highlight > pre, div.input_area pre')
  codeCells.forEach((codeCell, index) => {
    const id = codeCellId(index)
    codeCell.setAttribute('id', id)
    if (document.getElementById("copy-button" + id) == null) {
      codeCell.insertAdjacentHTML('afterend', clipboardButton(id));
    }
  })

  const clipboard = new ClipboardJS('.copybtn')
  clipboard.on('success', event => {
    clearSelection()
    temporarilyChangeTooltip(event.trigger, 'Copied!')
  })

  clipboard.on('error', event => {
    temporarilyChangeTooltip(event.trigger, 'Failed to copy')
  })

  // Get rid of clipboard before the next page visit to avoid memory leak
  document.addEventListener('turbolinks:before-visit', () =>
    clipboard.destroy()
  )
}

initFunction(addCopyButtonToCodeCells);
</script>


  <!-- Hide cell code -->
  
<script>
/**
Add buttons to hide code cells
*/


var setCodeCellVisibility = function(inputField, kind) {
    // Update the image and class for hidden
    var id = inputField.getAttribute('data-id');
    var codeCell = document.querySelector(`#${id} div.highlight`);

    if (kind === "visible") {
        codeCell.classList.remove('hidden');
        inputField.checked = true;
    } else {
        codeCell.classList.add('hidden');
        inputField.checked = false;
    }
}

var toggleCodeCellVisibility = function (event) {
    // The label is clicked, and now we decide what to do based on the input field's clicked status
    if (event.target.tagName === "LABEL") {
        var inputField = event.target.previousElementSibling;
    } else {
        // It is the span inside the target
        var inputField = event.target.parentElement.previousElementSibling;
    }

    if (inputField.checked === true) {
        setCodeCellVisibility(inputField, "visible");
    } else {
        setCodeCellVisibility(inputField, "hidden");
    }
}


// Button constructor
const hideCodeButton = id => `<input class="hidebtn" type="checkbox" id="hidebtn${id}" data-id="${id}"><label title="Toggle cell" for="hidebtn${id}" class="plusminus"><span class="pm_h"></span><span class="pm_v"></span></label>`

var addHideButton = function () {
  // If a hide button is already added, don't add another
  if (document.querySelector('div.hidecode input') !== null) {
      return;
  }

  // Find the input cells and add a hide button
  document.querySelectorAll('div.input_area').forEach(function (item, index) {
    if (!item.classList.contains("hidecode")) {
        // Skip the cell if it doesn't have a hidecode class
        return;
    }

    const id = codeCellId(index)
    item.setAttribute('id', id);
    // Insert the button just inside the end of the next div
    item.querySelector('div').insertAdjacentHTML('beforeend', hideCodeButton(id))

    // Set up the visibility toggle
    hideLink = document.querySelector(`#${id} div.highlight + input + label`);
    hideLink.addEventListener('click', toggleCodeCellVisibility)
  });
}


// Initialize the hide buttos
var initHiddenCells = function () {
    // Add hide buttons to the cells
    addHideButton();

    // Toggle the code cells that should be hidden
    document.querySelectorAll('div.hidecode input').forEach(function (item) {
        setCodeCellVisibility(item, 'hidden');
        item.checked = true;
    })
}

initFunction(initHiddenCells);

</script>


  <!-- Load custom website scripts -->
  <script src="/dsc-wiki/assets/js/scripts.js" async></script>

  <!-- Load custom user CSS and JS  -->
  <script src="/dsc-wiki/assets/custom/custom.js" async></script>
  <link rel="stylesheet" href="/dsc-wiki/assets/custom/custom.css">

  <!-- Update interact links w/ REST param, is defined in includes so we can use templates -->
  

  <!-- Lunr search code - will only be executed on the /search page -->
  <script src="/dsc-wiki/assets/js/lunr/lunr.min.js" type="text/javascript"></script>
  <script>var initQuery = function() {
  // See if we have a search box
  var searchInput = document.querySelector('input#lunr_search');
  if (searchInput === null) {
    return;
  }

  // Function to parse our lunr cache
  var idx = lunr(function () {
    this.field('title')
    this.field('excerpt')
    this.field('categories')
    this.field('tags')
    this.ref('id')

    this.pipeline.remove(lunr.trimmer)

    for (var item in store) {
      this.add({
        title: store[item].title,
        excerpt: store[item].excerpt,
        categories: store[item].categories,
        tags: store[item].tags,
        id: item
      })
    }
  });

  // Run search upon keyup
  searchInput.addEventListener('keyup', function () {
    var resultdiv = document.querySelector('#results');
    var query = document.querySelector("input#lunr_search").value.toLowerCase();
    var result =
      idx.query(function (q) {
        query.split(lunr.tokenizer.separator).forEach(function (term) {
          q.term(term, { boost: 100 })
          if(query.lastIndexOf(" ") != query.length-1){
            q.term(term, {  usePipeline: false, wildcard: lunr.Query.wildcard.TRAILING, boost: 10 })
          }
          if (term != ""){
            q.term(term, {  usePipeline: false, editDistance: 1, boost: 1 })
          }
        })
      });

      // Empty the results div
      while (resultdiv.firstChild) {
        resultdiv.removeChild(resultdiv.firstChild);
      }

    resultdiv.insertAdjacentHTML('afterbegin', '<p class="results__found">'+result.length+' Result(s) found</p>');
    for (var item in result) {
      var ref = result[item].ref;
      if(store[ref].teaser){
        var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<div class="archive__item-teaser">'+
                '<img src="'+store[ref].teaser+'" alt="">'+
              '</div>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      else{
    	  var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      resultdiv.insertAdjacentHTML('beforeend', searchitem);
    }
  });
};

initFunction(initQuery);
</script>
</head>

  <body>
    <!-- .js-show-sidebar shows sidebar by default -->
    <div id="js-textbook" class="c-textbook js-show-sidebar">
      



<nav id="js-sidebar" class="c-textbook__sidebar">
  <a href="https://github.com/stephenslab/dsc"><img src="/dsc-wiki/images/logo.png" class="textbook_logo" id="sidebar-logo" data-turbolinks-permanent/></a>
  <h2 class="c-sidebar__title">DSC</h2>
  <ul class="c-sidebar__chapters">
    
      
      
        <li class="c-sidebar__chapter"><a class="c-sidebar__entry" href="/dsc-wiki/search.html"><img src="/dsc-wiki/images/search.svg" alt="Search This Wiki"></a></li>
        
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsc-wiki/overview.html"
        >
          
          Home
        </a>

        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsc-wiki/installation.html"
        >
          
          Installation
        </a>

        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsc-wiki/faq.html"
        >
          
          FAQ
        </a>

        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsc-wiki/reference/reference.html"
        >
          
          Reference manual
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/reference/Terminology.html"
                >
                  
                  Terminology
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/reference/DSC_Configuration.html"
                >
                  
                  DSC configuration syntax
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/reference/DSC_Execution.html"
                >
                  
                  Running DSC
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/reference/DSC_Filtering.html"
                >
                  
                  Extracting DSC results
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/reference/Command_Options.html"
                >
                  
                  Command-line reference
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/reference/Road_Map.html"
                >
                  
                  Development roadmap
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/reference/Implementation_Details.html"
                >
                  
                  Implementation details
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/reference/Unsupported_Features.html"
                >
                  
                  Unsupported features
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      
        <li class="c-sidebar__divider"></li>
        
      
      
        <li><h2 class="c-sidebar__title">User guide</li>
        
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsc-wiki/first_course/first_course.html"
        >
          
          First course on DSC
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/first_course/Intro_DSC.html"
                >
                  
                  A brief introduction to DSC
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry c-sidebar__entry--active"
                  href="/dsc-wiki/first_course/Intro_Syntax_I.html"
                >
                  
                  DSC basics, part I
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry c-sidebar__entry--active"
                  href="/dsc-wiki/first_course/Intro_Syntax_II.html"
                >
                  
                  DSC basics, part II
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/first_course/Prototype_Tips.html"
                >
                  
                  Developing benchmarks
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/first_course/Debug_Tips.html"
                >
                  
                  Debug in DSC
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/first_course/Syntax_Tips.html"
                >
                  
                  Syntax tips
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsc-wiki/faq.html"
        >
          
          Other tutorials
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/advanced_course/5_Minutes_Python.html"
                >
                  
                  Working with Python
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/advanced_course/DSC_Data.html"
                >
                  
                  DSC data flow
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/advanced_course/5_Minutes_RPY.html"
                >
                  
                  Working with R and Python
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/advanced_course/Multiple_Pipelines.html"
                >
                  
                  Running multiple pipelines
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/advanced_course/Rmd_Executable.html"
                >
                  
                  Using Rmd files as module executables
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/advanced_course/Remote_Computations.html"
                >
                  
                  Running DSC on remote computers
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/advanced_course/DSC_Docker.html"
                >
                  
                  Running DSC in Docker
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsc-wiki/examples.html"
        >
          
          Benchmark examples
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/examples/R_Example_1.html"
                >
                  
                  R Example 1
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsc-wiki/examples/R_Example_2.html"
                >
                  
                  R Example 2
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
  </ul>
  <p class="sidebar_footer">Copyright (c) 2016-2018 <br> <a href="http://home.uchicago.edu/gaow">Gao Wang</a>, <a href="http://stephenslab.uchicago.edu">Matthew Stephens</a>, <a href="https://pcarbo.github.io">Peter Carbonetto</a> and contributors.<br></p>
</nav>

      
      <!-- Empty sidebar placeholder that we'll auto-fill with javascript -->
      <aside class="sidebar__right">
          <header><h4 class="nav__title"><i class="fa fa-list"></i>   Contents</h4></header>
          <nav class="onthispage">
          </nav>
      </aside>
      
      <main class="c-textbook__page" tabindex="-1">
          <div class="o-wrapper">
            <div class="c-sidebar-toggle">
  <!-- We show the sidebar by default so we use .is-active -->
  <button
    id="js-sidebar-toggle"
    class="hamburger hamburger--arrowalt is-active"
  >
    <span class="hamburger-box">
      <span class="hamburger-inner"></span>
    </span>
    <span class="c-sidebar-toggle__label">Toggle Sidebar</span>
  </button>
</div>

            
<div class="buttons">






</div>


            <div class="c-textbook__content">
              <h1 id="dsc-basics-part-ii">DSC Basics, Part II</h1>

<p>This is the second part of the “DSC Basics” tutorial. Before working through this tutorial, you should have already read <a href="Intro_Syntax_I">DSC Basics, Part I</a>. Here we build on the mean estimation example from the previous part to illustrate new concepts and syntax in DSC, with an emphasis on the use of <em>module parameters</em>.</p>

<p>Materials used in this tutorial can be found in the <a href="https://github.com/stephenslab/dsc/tree/master/vignettes/one_sample_location">DSC vignettes repository</a>. As before, you may choose to run this example DSC program as you read through the tutorial, but this is not required. For more details, consult the README in the <a href="https://github.com/stephenslab/dsc/tree/master/vignettes/one_sample_location">“one sample location” DSC vignette</a>.</p>

<h2 id="adding-a-module-parameter-to-normal">Adding a module parameter to <code class="highlighter-rouge">normal</code></h2>

<p>In our example DSC, recall we defined the <code class="highlighter-rouge">normal</code> module as follows:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">normal</span><span class="pi">:</span> <span class="s">R(x &lt;- rnorm(n = 100,mean = 0,sd = 1))</span>
  <span class="s">$data</span><span class="pi">:</span> <span class="s">x</span>
  <span class="s">$true_mean</span><span class="pi">:</span> <span class="s">0</span>
</code></pre></div></div>

<p>Here we propose to make a slight improvement to this module by adding a <em>module parameter</em>, <code class="highlighter-rouge">n</code>:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">normal</span><span class="pi">:</span> <span class="s">R(x &lt;- rnorm(n,mean = 0,sd = 1))</span>
  <span class="s">n</span><span class="pi">:</span> <span class="s">100</span>
  <span class="s">$data</span><span class="pi">:</span> <span class="s">x</span>
  <span class="s">$true_mean</span><span class="pi">:</span> <span class="s">0</span>
</code></pre></div></div>

<p>We have defined a module parameter <code class="highlighter-rouge">n</code> and set its value to 100. Once we have defined <code class="highlighter-rouge">n</code>, any of the R code may refer to this module parameter. In the R code, the first argument of <code class="highlighter-rouge">rnorm</code> is set to the value of <code class="highlighter-rouge">n</code> (which is 100).</p>

<p>In this first example, there is not much benefit to defining a module parameter <code class="highlighter-rouge">n</code>. In the examples below, the advantages of module parameters will become more apparent.</p>

<h2 id="adding-a-second-module-parameter-to-normal">Adding a second module parameter to <code class="highlighter-rouge">normal</code></h2>

<p>In our current design of <code class="highlighter-rouge">normal</code>, we made an unfortunate choice: the mean used to simulate the data is defined twice, once inside the call to <code class="highlighter-rouge">rnorm</code>, where we set <code class="highlighter-rouge">mean = 0</code>, and once when we set the module output <code class="highlighter-rouge">$true_mean</code> to zero. If we decide to use a different mean to simulate the data, then we would have to be careful to change the code in two different places.</p>

<p>It would be better if the mean of the data was defined once. This can be accomplished with a module parameter, which we will name <code class="highlighter-rouge">mu</code> (the Greek letter conventionally used to denote the mean):</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">normal</span><span class="pi">:</span> <span class="s">R(x &lt;- rnorm(n,mean = mu,sd = 1))</span>
  <span class="s">n</span><span class="pi">:</span> <span class="s">100</span>
  <span class="s">mu</span><span class="pi">:</span> <span class="s">0</span>
  <span class="s">$data</span><span class="pi">:</span> <span class="s">x</span>
  <span class="s">$true_mean</span><span class="pi">:</span> <span class="s">mu</span>
</code></pre></div></div>

<p>Here, we have defined a second module parameter <code class="highlighter-rouge">mu</code>, and set its value zero. Now the <code class="highlighter-rouge">mean</code> argument of <code class="highlighter-rouge">rnorm</code> can be set to the value of <code class="highlighter-rouge">mu</code>.</p>

<p>Additionally, since <code class="highlighter-rouge">mu</code> is also a script parameter, the module output <code class="highlighter-rouge">$true_mean</code> can be set to the value of (script parameter) <code class="highlighter-rouge">mu</code>. (In this example, the value of the module parameter happens to be the same as the value of the variable <code class="highlighter-rouge">mu</code> used in the R code, but in some cases the R code might modify the value of <code class="highlighter-rouge">mu</code>, in which case the module parameter and script parameter will be different. So it is important to keep these quantities distinct.)</p>

<p>With this change to the module definition, modifying the mean used to simulate the data only requires editing one line of code instead of two.</p>

<p>Likewise, we can use a module parameter to specify the mean of the data simulated from a <em>t</em> distribution:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">t</span><span class="pi">:</span> <span class="s">R(x &lt;- mu + rt(n,df = 2))</span>
  <span class="s">n</span><span class="pi">:</span> <span class="s">100</span>
  <span class="s">mu</span><span class="pi">:</span> <span class="s">3</span>
  <span class="s">$data</span><span class="pi">:</span> <span class="s">x</span>
  <span class="s">$true_mean</span><span class="pi">:</span> <span class="s">mu</span>
</code></pre></div></div>

<p>Note that there is no requirement that the module parameters for the <code class="highlighter-rouge">normal</code> and <code class="highlighter-rouge">t</code> modules have the same name, <code class="highlighter-rouge">mu</code>, but in this case makes sense to do so. One advantage of defining parameters with the same name is that makes it easier to query the results.</p>

<h2 id="the-order-of-evaluation-inside-a-module">The order of evaluation inside a module</h2>

<p>In the examples above, we informally introduced the notion of a <em>model parameter.</em> Below, we will give some more elaborate examples with module parameters, so here we take a moment to describe more formally how a module parameter behaves in relation to other components of a module:</p>

<ul>
  <li>
    <p>A module parameter cannot depend on any of the module inputs, and it can only depend on other module parameters previously specified.</p>
  </li>
  <li>
    <p>Module parameters are evaluated before the module script. The exact procedure for evaluating a module is as follows:</p>

    <ol>
      <li>
        <p>Evaluate any R code used to determine the values of the module parameters (we give an example of this below).</p>
      </li>
      <li>
        <p>Set the values of the module parameters.</p>
      </li>
      <li>
        <p>Initialize the module inputs according to the current stored values of the pipeline variables.</p>
      </li>
      <li>
        <p>For each module parameter and module input, define a <em>script variable</em> in the global environment in which the script is evaluated with the same name and same value as the module parameter or input.</p>
      </li>
      <li>
        <p>Evaluate the module script or inline source code. All script variables are retained for resolving any module outputs.</p>
      </li>
      <li>
        <p>Evaluate the expressions used to determine the values of the module outputs.</p>
      </li>
    </ol>
  </li>
</ul>

<p>To illustrate the evaluation procedure, consider the simple example of a module we gave above, repeated here for convenience:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">normal</span><span class="pi">:</span> <span class="s">R(x &lt;- rnorm(n,mean = mu,sd = 1))</span>
  <span class="s">n</span><span class="pi">:</span> <span class="s">100</span>
  <span class="s">mu</span><span class="pi">:</span> <span class="s">0</span>
  <span class="s">$data</span><span class="pi">:</span> <span class="s">x</span>
  <span class="s">$true_mean</span><span class="pi">:</span> <span class="s">mu</span>
</code></pre></div></div>

<p>The steps in evaluating the module are as follows:</p>

<ol>
  <li>
    <p>The first step is skipped because no R code needs to be run to evaluate the module parameters.</p>
  </li>
  <li>
    <p>The module parameters <code class="highlighter-rouge">n</code> and <code class="highlighter-rouge">mu</code> are set to 100 and 0, respectively.</p>
  </li>
  <li>
    <p>The third step is skipped because no inputs are defined for this module.</p>
  </li>
  <li>
    <p>In the global R environment, variables <code class="highlighter-rouge">n</code> and <code class="highlighter-rouge">mu</code> are defined and set to the values of the module parameters <code class="highlighter-rouge">n</code> and <code class="highlighter-rouge">mu</code> (in this case, 100 and 0).</p>
  </li>
  <li>
    <p>The expression <code class="highlighter-rouge">x &lt;- rnorm(n,mean = mu,sd = 1)</code> is parsed and evaluated in the same global R environment.</p>
  </li>
  <li>
    <p>Module output <code class="highlighter-rouge">$data</code> is assigned the value of R expression <code class="highlighter-rouge">x</code> (which is a vector of length 100), and module output <code class="highlighter-rouge">$true_mean</code> is assigned the value of R expresion <code class="highlighter-rouge">mu</code> (which is just zero because <code class="highlighter-rouge">mu</code> was unchanged when the R code was run). In both cases, the R expressions are simply variable names, but we point out that they can be more general R expressions.</p>
  </li>
</ol>

<p>We will refer back to this evaluation procedure in other examples below.</p>

<h2 id="a-single-module-parameter-with-multiple-alternative-values">A single module parameter with multiple alternative values</h2>

<p>Above, we gave a couple examples of defining module parameters. Here, we will demonstrate an important feature of module parameters: <em>they can be used to define multiple modules that are similar to each other.</em></p>

<p>Our current definition of the <code class="highlighter-rouge">normal</code> module simulates 100 random samples from a normal distribution. Suppose we would like to define a second module that simulates 1,000 random samples from the same normal distribution. This is easily done by defining a new module parameter <code class="highlighter-rouge">n</code> that takes on two different values:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">normal</span><span class="pi">:</span> <span class="s">R(x &lt;- rnorm(n,mean = mu,sd = 1))</span>
  <span class="s">n</span><span class="pi">:</span> <span class="s">100, 1000</span>
  <span class="s">mu</span><span class="pi">:</span> <span class="s">0</span>
  <span class="s">$data</span><span class="pi">:</span> <span class="s">x</span>
  <span class="s">$true_mean</span><span class="pi">:</span> <span class="s">mu</span>
</code></pre></div></div>

<p>The comma delimits the two possible values of model parameter <code class="highlighter-rouge">n</code>.</p>

<p>Now that we have defined <code class="highlighter-rouge">n</code> inside this module, we can refer to this module parameter inside the R code that simulates random draws from a normal distribution, as in the example above.</p>

<p>To be precise, this code defines a <em>module block</em> with two modules. It is equivalent to defining two modules, <code class="highlighter-rouge">normal_100</code> and <code class="highlighter-rouge">normal_1000</code>, that are identical in every way except that the first module includes parameter definition <code class="highlighter-rouge">n: 100</code> and the second defines <code class="highlighter-rouge">n: 100</code>. The module block above is of course much more succinct.</p>

<p>The line <code class="highlighter-rouge">n: 100, 1000</code> should not be interpreted as defining a vector or sequence with two entries, 100 and 1000. It defines a <em>set of alternative values</em>. To put it another way—and this is the terminology we use frequently—<code class="highlighter-rouge">n: 100, 1000</code> defines two <em>alternative values</em> for module parameter <code class="highlighter-rouge">n</code>, and therefore defines two <em>alternative modules</em> that are the same in every way (including their name, <code class="highlighter-rouge">normal</code>) except for the setting of <code class="highlighter-rouge">n</code>.</p>

<p>An important property of module parameters with multiple alternative values is that <em>their order does not matter</em>. For example, if we instead wrote <code class="highlighter-rouge">n: 1000, 100</code>, <em>the DSC results will be exactly the same as</em> <code class="highlighter-rouge">n: 100, 1000</code>. The only thing that will change is the order in which the results will appear in the tables, and the way in which the results are stored in files.</p>

<p>Although the two modules both have the same name, <code class="highlighter-rouge">normal</code>, their outputs can still be easily distinguished in the results; for example, if you want to compare the accuracy of the estimates in the larger (<code class="highlighter-rouge">n = 1000</code>) and smaller (<code class="highlighter-rouge">n = 100</code>) simulated data sets, the results from these two modules can be distinguished by the stored value of the module parameter <code class="highlighter-rouge">n</code>. We will see an example of this next.</p>

<h2 id="executing-the-dsc-with-four-simulate-modules">Executing the DSC with four <code class="highlighter-rouge">simulate</code> modules</h2>

<p>Let’s go ahead and generate results from our new “mean estimation” DSC. In the new DSC, the <code class="highlighter-rouge">simulate</code> modules are defined by two module blocks:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">normal</span><span class="pi">:</span> <span class="s">R(x &lt;- rnorm(n,mean = mu,sd = 1))</span>
  <span class="s">n</span><span class="pi">:</span> <span class="s">100, 1000</span>
  <span class="s">mu</span><span class="pi">:</span> <span class="s">0</span>
  <span class="s">$data</span><span class="pi">:</span> <span class="s">x</span>
  <span class="s">$true_mean</span><span class="pi">:</span> <span class="s">mu</span>

<span class="na">t</span><span class="pi">:</span> <span class="s">R(x &lt;- mu + rt(n,df = 2))</span>
  <span class="s">n</span><span class="pi">:</span> <span class="s">100, 1000</span>
  <span class="s">mu</span><span class="pi">:</span> <span class="s">3</span>
  <span class="s">$data</span><span class="pi">:</span> <span class="s">x</span>
  <span class="s">$true_mean</span><span class="pi">:</span> <span class="s">mu</span>
</code></pre></div></div>

<p>The rest of the DSC remains unchanged from before.</p>

<p>This new DSC is implemeted by <code class="highlighter-rouge">simulate_data_twice.dsc</code> inside the <a href="https://github.com/stephenslab/dsc/tree/master/vignettes/one_sample_location">one_sample_location</a> vignette folder.</p>

<p>To run the DSC benchmark, change the working directory (here we have assumed that the dsc repository is stored in the <code class="highlighter-rouge">git</code> subdirectory of your home directory),</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> ~/git/dsc/vignettes/one_sample_location
</code></pre></div></div>

<p>remove any previously generated results,</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rm <span class="nt">-Rf</span> first_investigation.html first_investigation.log first_investigation
</code></pre></div></div>

<p>then run 10 replicates of all the pipelines:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dsc simulate_data_twice.dsc <span class="nt">--replicate</span> 10
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>INFO: DSC script exported to first_investigation.html
INFO: Constructing DSC from simulate_data_twice.dsc ...
INFO: Building execution graph &amp; running DSC ...
[#############################] 29 steps processed (295 jobs completed)
INFO: Building DSC database ...
INFO: DSC complete!
INFO: Elapsed time 29.389 seconds.
</code></pre></div></div>

<h2 id="comparing-the-dsc-results-with-n100-and-n1000">Comparing the DSC results with <code class="highlighter-rouge">n=100</code> and <code class="highlighter-rouge">n=1000</code></h2>

<p>Now let’s inspect the DSC results in R. Change the R working directory to the location of the DSC file, and use the dscquery function from the <code class="highlighter-rouge">dscrutils</code> package to load the DSC results into R:</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">setwd</span><span class="p">(</span><span class="s2">"~/GIT/dsc/vignettes/one_sample_location"</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">dscrutils</span><span class="p">)</span><span class="w">
</span><span class="n">dscout</span><span class="w"> </span><span class="o">&lt;-</span><span class="w">
  </span><span class="n">dscquery</span><span class="p">(</span><span class="n">dsc.outdir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"dsc_result"</span><span class="p">,</span><span class="w">
           </span><span class="n">targets</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"simulate.n"</span><span class="p">,</span><span class="s2">"analyze"</span><span class="p">,</span><span class="s2">"score.error"</span><span class="p">))</span><span class="w">
</span><span class="n">nrow</span><span class="p">(</span><span class="n">dscout</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">
      <div class="output_stream highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Loading dsc-query output from CSV file.
Reading DSC outputs:
 - score.error: extracted atomic values
</code></pre></div>      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output_subarea">

      <div class="output output_html">
160
</div>

    </div>
  </div>
</div>

<p>The DSC command we ran above generated results for 10 replicates of 16 pipelines. We now have double the number of pipelines we had before, which is expected because we now have 4 <code class="highlighter-rouge">simulate</code> modules (2 <code class="highlighter-rouge">normal</code> modules and 2 <code class="highlighter-rouge">t</code> modules), whereas before we had 2 <code class="highlighter-rouge">simulate</code> modules. To confirm this, we see that each of the four <code class="highlighter-rouge">simulate</code> modules appears in 40 pipelines:</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">with</span><span class="p">(</span><span class="n">dscout</span><span class="p">,</span><span class="n">table</span><span class="p">(</span><span class="n">simulate</span><span class="p">,</span><span class="n">simulate.n</span><span class="p">))</span><span class="w">
</span></code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">
      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        simulate.n
simulate 100 1000
  normal  40   40
  t       40   40
</code></pre></div>      </div>

    </div>
  </div>
</div>

<p>The <code class="highlighter-rouge">"simulate.n"</code> column in the <code class="highlighter-rouge">dscout</code> data frame gives the value of module parameter <code class="highlighter-rouge">n</code> defined inside a <code class="highlighter-rouge">simulate</code> module.</p>

<p>We would expect that population mean estimates improve with more data. We can quickly check this by comparing the average squared error in the pipelines with 100 samples against the average error in the pipelines with 1,000 samples:</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">dscout</span><span class="p">,</span><span class="n">score</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"sq_err"</span><span class="p">)</span><span class="w">
</span><span class="n">as.table</span><span class="p">(</span><span class="n">by</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span><span class="w">
            </span><span class="n">with</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span><span class="nf">list</span><span class="p">(</span><span class="n">analyze</span><span class="p">,</span><span class="n">simulate.n</span><span class="p">)),</span><span class="w">
            </span><span class="k">function</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="o">$</span><span class="n">score.error</span><span class="p">)))</span><span class="w">
</span></code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">
      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>               100        1000
mean   0.032322738 0.006269221
median 0.018195606 0.001767654
</code></pre></div>      </div>

    </div>
  </div>
</div>

<p>Indeed, based on the results from these 10 replicates, we observe that the accuracy of both methods (mean and median) improves considerably with more data (on average), and in both cases the median is more accurate than the mean on average.</p>

<h2 id="two-module-parameters-with-multiple-alternatives">Two module parameters with multiple alternatives</h2>

<p>If you provide more than one value for multiple module parameters, DSC considers all combinations of the values.</p>

<p>For example, suppose we want to evaluate estimators of the population mean when the data are simulated from the <em>t</em> distribution with different numbers of degrees of freedom. In DSC, this can be succinctly expressed by defining another module parameter, <code class="highlighter-rouge">df</code>, with multiple values:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">t</span><span class="pi">:</span> <span class="s">R(x &lt;- mu + rt(n,df))</span>
  <span class="s">n</span><span class="pi">:</span> <span class="s">100, 1000</span>
  <span class="s">mu</span><span class="pi">:</span> <span class="s">3</span>
  <span class="s">df</span><span class="pi">:</span> <span class="s">2, 4, 10</span>
  <span class="s">$data</span><span class="pi">:</span> <span class="s">x</span>
  <span class="s">$true_mean</span><span class="pi">:</span> <span class="s">mu</span>
</code></pre></div></div>

<p>This new module block defines 6 <code class="highlighter-rouge">t</code> modules from the 6 different ways of setting both the <code class="highlighter-rouge">n</code> and <code class="highlighter-rouge">df</code> parameters.</p>

<p>Let’s clear the previous results and run the DSC benchmark with this new module:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rm <span class="nt">-Rf</span> first_investigation.html first_investigation.log first_investigation
dsc simulate_multiple_dfs.dsc <span class="nt">--replicate</span> 10
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>INFO: DSC script exported to first_investigation.html
INFO: Constructing DSC from simulate_multiple_dfs.dsc ...
INFO: Building execution graph &amp; running DSC ...
[#############################] 29 steps processed (575 jobs completed)
INFO: Building DSC database ...
INFO: DSC complete!
INFO: Elapsed time 57.557 seconds.
</code></pre></div></div>

<p>Now let’s load all the results generated with the <em>t</em>-simulated data:</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dscout2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w">
  </span><span class="n">dscquery</span><span class="p">(</span><span class="n">dsc.outdir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"dsc_result"</span><span class="p">,</span><span class="w">
           </span><span class="n">targets</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"t.n"</span><span class="p">,</span><span class="s2">"t.df"</span><span class="p">,</span><span class="s2">"analyze"</span><span class="p">,</span><span class="s2">"score.error"</span><span class="p">))</span><span class="w">
</span></code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">
      <div class="output_stream highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Loading dsc-query output from CSV file.
Reading DSC outputs:
 - score.error: extracted atomic values
</code></pre></div>      </div>
    </div>
  </div>
</div>

<p>In total, we have results from 240 pipelines, which we can break down as follows:</p>

<div class="cell code_cell">
  <div class="input_area">
    <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">with</span><span class="p">(</span><span class="n">dscout2</span><span class="p">,</span><span class="n">table</span><span class="p">(</span><span class="n">t.n</span><span class="p">,</span><span class="n">t.df</span><span class="p">))</span><span class="w">
</span></code></pre></div>    </div>
  </div>

  <div class="output_wrapper">
    <div class="output_subarea">
      <div class="output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      t.df
t.n     2  4 10
  100  40 40 40
  1000 40 40 40
</code></pre></div>      </div>

    </div>
  </div>
</div>

<p>Each of the six <code class="highlighter-rouge">t</code> modules was run 40 times: 2 analyze modules x 2 score modules x 10 replicates.</p>

<h2 id="using-a-module-parameter-to-set-the-seed">Using a module parameter to set the seed</h2>

<p>Here we illustrate another practical use of module parameters for defining modules with different “seeds”.</p>

<p>To ensure reproducible results, it is often necessary to initialize the state, or <em>seed</em>, of the  pseudorandom number generator. For example, in R the sequence of pseudorandom numbers is initialized by calling <code class="highlighter-rouge">set.seed(x)</code>, in which <code class="highlighter-rouge">x</code> is an integer. (Note that DSC provides a default seed setting in R.)</p>

<p>For example, we can define 10 modules that generate 10 normally distributed data sets:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">normal</span><span class="pi">:</span> <span class="s">R(set.seed(seed); x &lt;- rnorm(n,mean = mu,sd = 1))</span>
  <span class="s">seed</span><span class="pi">:</span> <span class="s">1, 2, 3, 4, 5, 6, 7, 8, 9, 10</span>
  <span class="s">n</span><span class="pi">:</span> <span class="s">100</span>
  <span class="s">mu</span><span class="pi">:</span> <span class="s">0</span>
  <span class="s">$data</span><span class="pi">:</span> <span class="s">x</span>
  <span class="s">$true_mean</span><span class="pi">:</span> <span class="s">mu</span>
</code></pre></div></div>

<p>The only difference in the 10 <code class="highlighter-rouge">normal</code> modules is the sequence of pseudorandom numbers used to simulate random draws from the normal distribution.</p>

<p>See <code class="highlighter-rouge">multiple_seeds.dsc</code> in the <code class="highlighter-rouge">one_sample_location</code> directory for the working example.</p>

<h2 id="combining-module-parameters-with-module-inputs">Combining module parameters with module inputs</h2>

<p>It is also possible to combine module parameters with module inputs.</p>

<p>Recall, in the <a href="Intro_DSC">initial tutorial</a> we defined a third <code class="highlighter-rouge">analyze</code> module that implemented the “Winsorized” mean. The <code class="highlighter-rouge">trim</code> argument to <code class="highlighter-rouge">winsor.mean</code> determined what proportion of data to “squish” from the top and bottom of the distribution.</p>

<p>Suppose we wanted to assess the impact of the trimming on the estimate accuracy. To do this, we could introduce a module parameter <code class="highlighter-rouge">trim</code> with multiple settings:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">winsor</span><span class="pi">:</span> <span class="s">R(y &lt;- psych::winsor.mean(x,trim,na.rm = TRUE))</span>
  <span class="s">trim</span><span class="pi">:</span> <span class="s">0.1, 0.2</span>
  <span class="s">x</span><span class="pi">:</span> <span class="s">$data</span>
  <span class="s">$est_mean</span><span class="pi">:</span> <span class="s">y</span>
</code></pre></div></div>

<p>Each time a data set <code class="highlighter-rouge">$data</code> is provided to the <code class="highlighter-rouge">simulate</code> module, DSC will run two different <code class="highlighter-rouge">winsor</code> modules: one with <code class="highlighter-rouge">trim = 0.1</code>, and a second with <code class="highlighter-rouge">trim = 0.2</code>.</p>

<p>Intuitively, one may want to adjust the trim setting <em>dynamically</em> based on the data (e.g., based on the fit to the normal distribution). However, this is not possible in DSC because module parameters must be set independently of the module inputs.</p>

<h2 id="more-complex-module-parameters">More complex module parameters</h2>

<p>Above, we illustrated the use of module parameters to succinctly define multiple similar modules. All the above examples used module parameters with simple (“atomic”) values. Here we illustrate defining module parameters in DSC with more complex values. We focus on the case when the module parameter is a vector of length 2. Although this example is still relatively simple, it is meant only to illustrate the capabilities of DSC—the features introduced in this section can be used to define much more complex module parameters than the ones illustrated in this example. [<em>TO DO: Add link here to appropriate place in the DSC Reference Manual talking about syntax for module parameters.</em>]</p>

<p>Suppose, for example, we would like to simulate data sets from the <em>t</em> distribution with different numbers of degrees of freedom and variances. This could be easily done by defining two module parameters which multiple alternative settings:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">t</span><span class="pi">:</span> <span class="s">R(x &lt;- mu + sd * rt(n,df))</span>
  <span class="s">n</span><span class="pi">:</span> <span class="s">100, 1000</span>
  <span class="s">mu</span><span class="pi">:</span> <span class="s">0</span>
  <span class="s">sd</span><span class="pi">:</span> <span class="s">0.2, 0.5, 1</span>
  <span class="s">df</span><span class="pi">:</span> <span class="s">4, 6, 8, 10</span>
  <span class="s">$data</span><span class="pi">:</span> <span class="s">x</span>
  <span class="s">$true_mean</span><span class="pi">:</span> <span class="s">mu</span>
</code></pre></div></div>

<p>DSC will define a module for each combination of the module settings; specifically, this module block defines $2 \times 3 \times 4 = 24$ modules, one for each combination of <code class="highlighter-rouge">n</code> (the number of samples), <code class="highlighter-rouge">sd</code> (the standard deviation) and <code class="highlighter-rouge">df</code> (the degrees of freedom).</p>

<h3 id="defining-vector-valued-module-parameters-in-dsc">Defining vector-valued module parameters in DSC</h3>

<p>Now suppose that we want to have finer control over which combinations of <code class="highlighter-rouge">sd</code> and <code class="highlighter-rouge">df</code> are used to simulate the data; in other words, we do not want to simulate data sets for all combinations of <code class="highlighter-rouge">sd</code> and <code class="highlighter-rouge">df</code>. For example, suppose we want to simulate data from <em>t</em> distributions with these three settings of the standard deviation (<code class="highlighter-rouge">sd</code>) and degrees of freedom (<code class="highlighter-rouge">df</code>):</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">sd</th>
      <th style="text-align: right">df</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">0.5</td>
      <td style="text-align: right">4</td>
    </tr>
    <tr>
      <td style="text-align: center">0.6</td>
      <td style="text-align: right">6</td>
    </tr>
    <tr>
      <td style="text-align: center">0.8</td>
      <td style="text-align: right">10</td>
    </tr>
  </tbody>
</table>

<p>One way to accomplish this is to define a new module parameter that stores the settings for <em>both</em> the standard deviation and the degrees of freedom. DSC permits the use of parentheses to define vector-valued module parameters:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">t</span><span class="pi">:</span> <span class="s">R(x &lt;- mu + params[1] * rt(n,df = params[2]))</span>
  <span class="s">n</span><span class="pi">:</span> <span class="s">100, 1000</span>
  <span class="s">mu</span><span class="pi">:</span> <span class="s">0</span>
  <span class="s">params</span><span class="pi">:</span> <span class="s">(0.5, 4), (0.6, 6), (0.8, 10)</span>
  <span class="s">$data</span><span class="pi">:</span> <span class="s">x</span>
  <span class="s">$true_mean</span><span class="pi">:</span> <span class="s">mu</span>
</code></pre></div></div>

<p>This module block defines $2 \times 3 = 6$ modules, one for each combination of <code class="highlighter-rouge">n</code> and <code class="highlighter-rouge">params</code>; each setting of <code class="highlighter-rouge">params</code> is a vector of length 2, in which the first vector entry specifies the standard deviation parameter, and the second entry specifies the degrees of freedom.</p>

<h3 id="defining-module-parameters-with-un-quoted-code-strings">Defining module parameters with un-quoted code strings</h3>

<p>Another option for defining a module parameter is to input chunks of code directly. This is the best option for this example in terms of succinctness and readability, while maintaining complete input information (<code class="highlighter-rouge">sd</code> and <code class="highlighter-rouge">df</code> names). Here is the new <code class="highlighter-rouge">t</code> block using un-quoted string parameters</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">t</span><span class="pi">:</span> <span class="s">R(x &lt;- mu + params["sd"] * rt(n,df = params["df"]))</span>
  <span class="s">n</span><span class="pi">:</span> <span class="s">100, 1000</span>
  <span class="s">mu</span><span class="pi">:</span> <span class="s">0</span>
  <span class="s">params</span><span class="pi">:</span> <span class="s">c(sd = 0.5, df = 4),</span>
          <span class="s">c(sd = 0.6, df = 6),</span>
          <span class="s">c(sd = 0.8, df = 10)</span>
  <span class="s">$data</span><span class="pi">:</span> <span class="s">x</span>
  <span class="s">$true_mean</span><span class="pi">:</span> <span class="s">mu</span>
</code></pre></div></div>

<p>As before, this module block defines $2 \times 3 = 6$ modules, one for each combination of <code class="highlighter-rouge">n</code> and <code class="highlighter-rouge">params</code>. The end result is the same as the above. However, there are some fundamental differences in this version:</p>

<ul>
  <li>
    <p>In each module, the <code class="highlighter-rouge">params</code> module parameter is not a vector of length 2; rather it is a string value containing the R expression specified, e.g., <code class="highlighter-rouge">"c(sd = 0.5, df = 4)"</code>.</p>
  </li>
  <li>
    <p>In each module, the script parameter <code class="highlighter-rouge">params</code> is assigned to the value of expression evaluated in the R environment. In actual fact this is implemented by prepending R code here to the code inside the <code class="highlighter-rouge">R()</code> statement. Therefore, this module block is (for the most part) equivalent to the following three module blocks in which the only difference between the modules is the <code class="highlighter-rouge">params</code> assignment inside the R code:</p>
  </li>
</ul>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">t1</span><span class="pi">:</span> <span class="s">R(params &lt;- c(sd = 0.5, df = 4); x &lt;- mu + params["sd"] * rt(n,df = params["df"]))</span>
  <span class="s">n</span><span class="pi">:</span> <span class="s">100, 1000</span>
  <span class="s">mu</span><span class="pi">:</span> <span class="s">0</span>
  <span class="s">$data</span><span class="pi">:</span> <span class="s">x</span>
  <span class="s">$true_mean</span><span class="pi">:</span> <span class="s">mu</span>

<span class="na">t2</span><span class="pi">:</span> <span class="s">R(params &lt;- c(sd = 0.6, df = 6); x &lt;- mu + params["sd"] * rt(n,df = params["df"]))</span>
  <span class="s">n</span><span class="pi">:</span> <span class="s">100, 1000</span>
  <span class="s">mu</span><span class="pi">:</span> <span class="s">0</span>
  <span class="s">$data</span><span class="pi">:</span> <span class="s">x</span>
  <span class="s">$true_mean</span><span class="pi">:</span> <span class="s">mu</span>

<span class="na">t3</span><span class="pi">:</span> <span class="s">R(params &lt;- c(sd = 0.8, df = 10); x &lt;- mu + params["sd"] * rt(n,df = params["df"]))</span>
  <span class="s">n</span><span class="pi">:</span> <span class="s">100, 1000</span>
  <span class="s">mu</span><span class="pi">:</span> <span class="s">0</span>
  <span class="s">$data</span><span class="pi">:</span> <span class="s">x</span>
  <span class="s">$true_mean</span><span class="pi">:</span> <span class="s">mu</span>
</code></pre></div></div>

<p>In this example, using un-quoted code string provides several advantages:</p>

<ol>
  <li>
    <p>The code remains succinct.</p>
  </li>
  <li>
    <p>As before, the vector entries are labeled by <code class="highlighter-rouge">sd</code> and <code class="highlighter-rouge">df</code>, making the code more understandable.</p>
  </li>
  <li>
    <p>Because the code is evaluated in the same R environment as the module script, the labels are retained, and so we can write <code class="highlighter-rouge">params$sd</code> and <code class="highlighter-rouge">params$df</code> instead of <code class="highlighter-rouge">params[1]</code> and <code class="highlighter-rouge">params[2]</code> to access the settings of the standard deviation and degrees of freedom.</p>
  </li>
</ol>

<h3 id="defining-module-parameters-with-r">Defining module parameters with <code class="highlighter-rouge">R()</code></h3>

<p>This example has achieved our aim of directly specifying combinations of <code class="highlighter-rouge">sd</code> and <code class="highlighter-rouge">df</code>, but the <code class="highlighter-rouge">params</code> module parameter will now be more difficult to use when inspecting the results in query, because in order to match it in query one has to type in the exact code script eg <code class="highlighter-rouge">c(sd = 0.5, df = 4)</code> including spaces.</p>

<p>Instead of using code script strings, we can use <code class="highlighter-rouge">R()</code> operator to generate vectors of inputs yet maintaining readability:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">t</span><span class="pi">:</span> <span class="s">R(x &lt;- mu + params[1] * rt(n,df = params[2]))</span>
  <span class="s">n</span><span class="pi">:</span> <span class="s">100, 1000</span>
  <span class="s">mu</span><span class="pi">:</span> <span class="s">0</span>
  <span class="s">params</span><span class="pi">:</span> <span class="s">R(c(sd = 0.5, df = 4)),</span>
          <span class="s">R(c(sd = 0.6, df = 6)),</span>
          <span class="s">R(c(sd = 0.8, df = 10))</span>
  <span class="s">$data</span><span class="pi">:</span> <span class="s">x</span>
  <span class="s">$true_mean</span><span class="pi">:</span> <span class="s">mu</span>
</code></pre></div></div>

<p>In the “<code class="highlighter-rouge">params: ...</code>” statement, the code inside each <code class="highlighter-rouge">R(...)</code> is evaluated inside an R environment, then the outcome of each evaluation is used to assign a value to each setting of <code class="highlighter-rouge">params</code>. This achieves the same result as using vector-valued inputs, yet it is also a slight improvement because the intent of the first and second entries is now more clear from the code because the vector entries are labeled by <code class="highlighter-rouge">sd</code> and <code class="highlighter-rouge">df</code>.</p>

<p>In general, <code class="highlighter-rouge">R()</code> provides much more flexibility in defining complex module parameters because it provides access to the many features of R. (The only restriction is that none of the module inputs can be referenced within the R code.)</p>

<h3 id="defining-module-parameters-with-r-1">Defining module parameters with <code class="highlighter-rouge">R{}</code></h3>

<p>A third option for defining module parameters with R code is to use <code class="highlighter-rouge">R{}</code>:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">t</span><span class="pi">:</span> <span class="s">R(x &lt;- mu + params[1] * rt(n,df = params[2]))</span>
  <span class="s">n</span><span class="pi">:</span> <span class="s">100, 1000</span>
  <span class="s">mu</span><span class="pi">:</span> <span class="s">0</span>
  <span class="s">params</span><span class="pi">:</span> <span class="s">R{list(c(sd = 0.5, df = 4),</span>
                 <span class="s">c(sd = 0.6, df = 6),</span>
                 <span class="s">c(sd = 0.8, df = 10))}</span>
  <span class="s">$data</span><span class="pi">:</span> <span class="s">x</span>
  <span class="s">$true_mean</span><span class="pi">:</span> <span class="s">mu</span>
</code></pre></div></div>

<p>The <code class="highlighter-rouge">R{}</code> statement evaluates the code given inside the curly braces, then subdivides the elements of the top-level sequence (vector or list) among multiple settings of the module parameters. In other words, a single <code class="highlighter-rouge">R{}</code> statement defines a <em>set of alternatives.</em> In this example, the R code evaluates to a list with 3 elements, in which each list element is a vector of length 2. Therefore, <code class="highlighter-rouge">params</code> is assigned 3 alternative values, in which each value is a vector of length 2.</p>

<p>In this particular example, defining the module parameter with <code class="highlighter-rouge">R()</code> or <code class="highlighter-rouge">R{}</code> achieved the same result, and either way the code is equally understandable, so there is no particular advantage of one syntax over the other. The main utility of <code class="highlighter-rouge">R{}</code> is that it is able to succinctly define longer sets of alternative settings. For example, in the random seed example above, creating a module parameter that defines 10 different seeds was rather tedious. The same example using <code class="highlighter-rouge">R{}</code> is</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">normal</span><span class="pi">:</span> <span class="s">R(set.seed(seed); x &lt;- rnorm(n,mean = mu,sd = 1))</span>
  <span class="s">seed</span><span class="pi">:</span> <span class="s">R{1:10}</span>
  <span class="s">n</span><span class="pi">:</span> <span class="s">100</span>
  <span class="s">mu</span><span class="pi">:</span> <span class="s">0</span>
  <span class="s">$data</span><span class="pi">:</span> <span class="s">x</span>
  <span class="s">$true_mean</span><span class="pi">:</span> <span class="s">mu</span>
</code></pre></div></div>

<h2 id="recap">Recap</h2>

<p>In this tutorial, we showed how module parameters can be used to succinctly define multiple similar modules.</p>

<p>The multiple similar modules defined in a module block can be identified according to the name of the module and the module parameter settings.</p>

<p>The keywords <code class="highlighter-rouge">R()</code> and <code class="highlighter-rouge">R{}</code> are useful for defining more complex-valued module parameters.</p>

<h2 id="exploring-further">Exploring further</h2>

<p>In this tutorial, we introduced the features of DSC that are most essential to developing your own DSC benchmark. There are many other features of DSC that we did not have a chance to explore in these introductory tutorials—to learn more, visit…</p>

              <nav class="c-page__nav">
  
    
    <a id="js-page__nav__prev" class="c-page__nav__prev" href="/dsc-wiki/first_course/Intro_Syntax_I">
      〈 <span class="u-margin-right-tiny"></span> DSC basics, part I
    </a>
  

  
    
    <a id="js-page__nav__next" class="c-page__nav__next" href="/dsc-wiki/first_course/Prototype_Tips">
      Developing benchmarks <span class="u-margin-right-tiny"></span> 〉
    </a>
  
</nav>

            </div>
          </div>
        </div>
      </main>
    </div>

  </body>
</html>
