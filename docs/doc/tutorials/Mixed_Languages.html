<!DOCTYPE html>
<html>
<head><meta charset="utf-8" />
<title>Mixed_Languages</title><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>








<!-- Custom stylesheet, it must be in the same directory as the html file -->
<link rel="stylesheet" href="custom.css">

<!-- Loading mathjax macro -->
<!-- Load mathjax -->
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    <!-- End of mathjax configuration --></head>

<link rel="stylesheet" href="https://code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/jquery-ui.min.js"></script>

<style>  /* defined here in case the main.css below cannot be loaded */
.lev1 {margin-left: 80px}
.lev2 {margin-left: 100px}
.lev3 {margin-left: 120px}
.lev4 {margin-left: 140px}
.lev5 {margin-left: 160px}
.lev6 {margin-left: 180px}
</style>

<link rel="stylesheet" type="text/css" href="../../css/jt.css">
<link rel="stylesheet" type="text/css" href="../../css/toc2.css">

<script src="../../js/toc2.js"></script>
<script src="../../js/docs.js"></script>

<script>
$( document ).ready(function(){

            var cfg={'threshold':3,     // depth of toc (number of levels)
             'number_sections': false,  // sections numbering
             'toc_cell': false,          // useless here
             'toc_window_display': true, // display the toc window
             "toc_section_display": "block", // display toc contents in the window
             'sideBar':true,       // sidebar or floating window
             'navigate_menu':false       // navigation menu (only in liveNotebook -- do not change)
            }

            var st={};                  // some variables used in the script
            st.rendering_toc_cell = false;
            st.config_loaded = false;
            st.extension_initialized=false;
            st.nbcontainer_marginleft = $('#notebook-container').css('margin-left')
            st.nbcontainer_marginright = $('#notebook-container').css('margin-right')
            st.nbcontainer_width = $('#notebook-container').css('width')
            st.oldTocHeight = undefined
            st.cell_toc = undefined;
            st.toc_index=0;

            // fire the main function with these parameters


            table_of_contents(cfg,st);


            var file=tutorialsDict[$("h1:first").attr("id")];
            $("#toc-level0 a").css("color","#126dce");
            $('a[href="#'+$("h1:first").attr("id")+'"]').hide()
            
            var tuts=tutorials;
            var pos=tutorials.indexOf(file);
        
            for (var a=pos;a>=0;a--){
                  var name=tuts[a]
                  $('<li><a href="'+name+'.html">'+name.replace(/_/g," ")+'</a></li>').insertBefore("#toc-level0 li:eq(0)");
            }
            $('a[href="'+file+'.html'+'"]').css("color","#126dce");

            $('<li id="indexHome"><a href="../../tutorials.html"><b>Tutorials Home<b></a></li>').insertBefore("#toc-level0 li:eq(0)");
            for (var a=pos+1;a<tuts.length;a++){
                  var name=tuts[a]
                  $(".toc #toc-level0").append('<li><a href="'+name+'.html">'+name.replace(/_/g," ")+'</a></li>');
            }
            $("#toc-header").hide();


    });
</script>
<body>
  <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Working-in-Python">Working in Python<a class="anchor-link" href="#Working-in-Python">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="DSC-implementation-in-Python">DSC implementation in Python<a class="anchor-link" href="#DSC-implementation-in-Python">&#182;</a></h2><p>DSC2 can plug and run both R and Python codes. It also supports interaction between the two languages. Here we show a re-implementation of the <a href="quick_start.html">Quick Start example</a> in Python. Resource to run this example can be found <a href="https://github.com/stephenslab/dsc2/tree/master/vignettes/one_sample_location_python">here</a>.</p>
<p>The DSC script is almost identical to the Quick Start example:</p>
<div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">simulate</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">exec</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">rnorm.py, rt.py</span>
    <span class="l l-Scalar l-Scalar-Plain">seed</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">R(1:10)</span>
    <span class="l l-Scalar l-Scalar-Plain">params</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">n</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">1000</span>
        <span class="l l-Scalar l-Scalar-Plain">true_mean</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">0, 1</span>
    <span class="l l-Scalar l-Scalar-Plain">return</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">x, true_mean</span>

<span class="l l-Scalar l-Scalar-Plain">estimate</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">exec</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">mean.py, median.py</span>
    <span class="l l-Scalar l-Scalar-Plain">params</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">x</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">$x</span>
    <span class="l l-Scalar l-Scalar-Plain">return</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">mean</span>

<span class="l l-Scalar l-Scalar-Plain">mse</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">exec</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">MSE.py</span>
    <span class="l l-Scalar l-Scalar-Plain">params</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">mean_est</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">$mean</span>
        <span class="l l-Scalar l-Scalar-Plain">true_mean</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">$true_mean</span>
    <span class="l l-Scalar l-Scalar-Plain">return</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">mse</span>

<span class="l l-Scalar l-Scalar-Plain">DSC</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">run</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">simulate *</span>
         <span class="l l-Scalar l-Scalar-Plain">estimate *</span>
         <span class="l l-Scalar l-Scalar-Plain">mse</span>
    <span class="l l-Scalar l-Scalar-Plain">exec_path</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">PY/scenarios, PY/methods, PY/scores</span>
    <span class="l l-Scalar l-Scalar-Plain">output</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">dsc_result</span>
</pre></div>
<p>You may notice the only difference are the executables (and search path): the are now written in Python.</p>
<div class="highlight"><pre><span></span><span class="o">==&gt;</span> <span class="o">../</span><span class="n">vignettes</span><span class="o">/</span><span class="n">one_sample_location_python</span><span class="o">/</span><span class="n">PY</span><span class="o">/</span><span class="n">methods</span><span class="o">/</span><span class="n">mean</span><span class="o">.</span><span class="n">py</span> <span class="o">&lt;==</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="n">mean</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="o">==&gt;</span> <span class="o">../</span><span class="n">vignettes</span><span class="o">/</span><span class="n">one_sample_location_python</span><span class="o">/</span><span class="n">PY</span><span class="o">/</span><span class="n">methods</span><span class="o">/</span><span class="n">median</span><span class="o">.</span><span class="n">py</span> <span class="o">&lt;==</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="n">mean</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="o">==&gt;</span> <span class="o">../</span><span class="n">vignettes</span><span class="o">/</span><span class="n">one_sample_location_python</span><span class="o">/</span><span class="n">PY</span><span class="o">/</span><span class="n">scores</span><span class="o">/</span><span class="n">MSE</span><span class="o">.</span><span class="n">py</span> <span class="o">&lt;==</span>
<span class="n">mse</span> <span class="o">=</span> <span class="p">(</span><span class="n">mean_est</span><span class="o">-</span><span class="n">true_mean</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

<span class="o">==&gt;</span> <span class="o">../</span><span class="n">vignettes</span><span class="o">/</span><span class="n">one_sample_location_python</span><span class="o">/</span><span class="n">PY</span><span class="o">/</span><span class="n">scenarios</span><span class="o">/</span><span class="n">rnorm</span><span class="o">.</span><span class="n">py</span> <span class="o">&lt;==</span>
<span class="c1"># produces n random numbers from normal with specified mean</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="n">x</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">true_mean</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>

<span class="o">==&gt;</span> <span class="o">../</span><span class="n">vignettes</span><span class="o">/</span><span class="n">one_sample_location_python</span><span class="o">/</span><span class="n">PY</span><span class="o">/</span><span class="n">scenarios</span><span class="o">/</span><span class="n">rt</span><span class="o">.</span><span class="n">py</span> <span class="o">&lt;==</span>
<span class="c1"># produces n random numbers from t with df=2 and  with specified mean</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="n">x</span><span class="o">=</span><span class="n">true_mean</span><span class="o">+</span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_t</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
</pre></div>
<p>To run the DSC,</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="err">!</span> <span class="n">dsc</span> <span class="o">-</span><span class="n">x</span> <span class="n">settings</span><span class="o">.</span><span class="n">dsc</span> <span class="o">-</span><span class="n">j8</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO: DSC script exported to <span class="ansi-green-fg">settings.html</span>
INFO: Constructing DSC from <span class="ansi-green-fg">settings.dsc</span> ...
DSC:   0%|          | 0/4 [00:00&lt;?, ?it/s]
simulate:1+estimate:1+mse:1:   0%|          | 0/3 [00:00&lt;?, ?it/s]
simulate:1+estimate:1+mse:1:  33%|███▎      | 1/3 [00:06&lt;00:12,  6.03s/it]
simulate:1+estimate:1+mse:1:  67%|██████▋   | 2/3 [00:11&lt;00:05,  5.97s/it]
simulate:1+estimate:1+mse:1: 100%|██████████| 3/3 [00:18&lt;00:00,  6.08s/it]
DSC:  25%|██▌       | 1/4 [00:18&lt;00:54, 18.29s/it]
simulate:1+estimate:2+mse:1:   0%|          | 0/3 [00:00&lt;?, ?it/s]
simulate:1+estimate:2+mse:1:  33%|███▎      | 1/3 [00:06&lt;00:12,  6.23s/it]
simulate:1+estimate:2+mse:1:  67%|██████▋   | 2/3 [00:11&lt;00:06,  6.05s/it]
simulate:1+estimate:2+mse:1: 100%|██████████| 3/3 [00:17&lt;00:00,  5.95s/it]
DSC:  50%|█████     | 2/4 [00:35&lt;00:36, 18.10s/it]
simulate:2+estimate:1+mse:1:   0%|          | 0/3 [00:00&lt;?, ?it/s]
simulate:2+estimate:1+mse:1:  33%|███▎      | 1/3 [00:05&lt;00:11,  5.83s/it]
simulate:2+estimate:1+mse:1:  67%|██████▋   | 2/3 [00:11&lt;00:05,  5.80s/it]
simulate:2+estimate:1+mse:1: 100%|██████████| 3/3 [00:16&lt;00:00,  5.69s/it]
DSC:  75%|███████▌  | 3/4 [00:53&lt;00:17, 17.79s/it]
simulate:2+estimate:2+mse:1:   0%|          | 0/3 [00:00&lt;?, ?it/s]
simulate:2+estimate:2+mse:1:  33%|███▎      | 1/3 [00:05&lt;00:10,  5.43s/it]
simulate:2+estimate:2+mse:1:  67%|██████▋   | 2/3 [00:10&lt;00:05,  5.46s/it]
simulate:2+estimate:2+mse:1: 100%|██████████| 3/3 [00:16&lt;00:00,  5.45s/it]
DSC: 100%|██████████| 4/4 [01:09&lt;00:00, 17.39s/it]
INFO: Building output database <span class="ansi-green-fg">dsc_result.rds</span> ...
INFO: DSC complete!
INFO: Elapsed time <span class="ansi-green-fg">70.446</span> seconds.
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice that time consumed for Python version is much longer than the Quick Start example. This is result of a compromise to R users. We anticipate the majority of DSC2 users program in R, and as a result we adopt RDS file as the standard format to cache output data. In order for Python to communicate with R, we have implemented interface for Python to read and write RDS files. The interface is less efficient than R's native RDS support, thus increasing the execution time.</p>
<h2 id="Mixing-Python-and-R-codes">Mixing Python and R codes<a class="anchor-link" href="#Mixing-Python-and-R-codes">&#182;</a></h2><p>The example below shows mix-match style Python and R routines in the same DSC script:</p>
<div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">simulate</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">exec</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">rnorm.py, rt.R</span>
    <span class="l l-Scalar l-Scalar-Plain">seed</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">R(1:10)</span>
    <span class="l l-Scalar l-Scalar-Plain">params</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">n</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">1000</span>
        <span class="l l-Scalar l-Scalar-Plain">true_mean</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">0, 1</span>
    <span class="l l-Scalar l-Scalar-Plain">return</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">x, true_mean</span>

<span class="l l-Scalar l-Scalar-Plain">estimate</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">exec</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">mean.R, median.py</span>
    <span class="l l-Scalar l-Scalar-Plain">params</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">x</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">$x</span>
    <span class="l l-Scalar l-Scalar-Plain">return</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">mean</span>

<span class="l l-Scalar l-Scalar-Plain">mse</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">exec</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">MSE.py</span>
    <span class="l l-Scalar l-Scalar-Plain">params</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">mean_est</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">$mean</span>
        <span class="l l-Scalar l-Scalar-Plain">true_mean</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">$true_mean</span>
    <span class="l l-Scalar l-Scalar-Plain">return</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">mse</span>

<span class="l l-Scalar l-Scalar-Plain">DSC</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">run</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">simulate *</span>
         <span class="l l-Scalar l-Scalar-Plain">estimate *</span>
         <span class="l l-Scalar l-Scalar-Plain">mse</span>
    <span class="l l-Scalar l-Scalar-Plain">exec_path</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">PY/scenarios, PY/methods, PY/scores,</span>
               <span class="l l-Scalar l-Scalar-Plain">R/scenarios, R/methods</span>
    <span class="l l-Scalar l-Scalar-Plain">output</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">dsc_result</span>
</pre></div>
<p>To execute:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="err">!</span> <span class="n">dsc</span> <span class="o">-</span><span class="n">x</span> <span class="n">settings_mix</span><span class="o">.</span><span class="n">dsc</span> <span class="o">-</span><span class="n">j8</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO: Checking R library <span class="ansi-green-fg">psych</span> ...
INFO: DSC script exported to <span class="ansi-green-fg">settings_mix.html</span>
INFO: Constructing DSC from <span class="ansi-green-fg">settings_mix.dsc</span> ...
DSC:   0%|          | 0/4 [00:00&lt;?, ?it/s]
simulate:1+estimate:1+mse:1:   0%|          | 0/3 [00:00&lt;?, ?it/s]
simulate:1+estimate:1+mse:1:  33%|███▎      | 1/3 [00:05&lt;00:11,  5.75s/it]
simulate:1+estimate:1+mse:1:  67%|██████▋   | 2/3 [00:06&lt;00:04,  4.39s/it]
simulate:1+estimate:1+mse:1: 100%|██████████| 3/3 [00:13&lt;00:00,  4.97s/it]
DSC:  25%|██▌       | 1/4 [00:13&lt;00:40, 13.46s/it]
simulate:1+estimate:2+mse:1:   0%|          | 0/3 [00:00&lt;?, ?it/s]
simulate:1+estimate:2+mse:1:  33%|███▎      | 1/3 [00:05&lt;00:11,  5.64s/it]
simulate:1+estimate:2+mse:1:  67%|██████▋   | 2/3 [00:11&lt;00:05,  5.61s/it]
simulate:1+estimate:2+mse:1: 100%|██████████| 3/3 [00:16&lt;00:00,  5.52s/it]
DSC:  50%|█████     | 2/4 [00:30&lt;00:28, 14.42s/it]
simulate:2+estimate:1+mse:1:   0%|          | 0/3 [00:00&lt;?, ?it/s]
simulate:2+estimate:1+mse:1:  33%|███▎      | 1/3 [00:01&lt;00:02,  1.01s/it]
simulate:2+estimate:1+mse:1:  67%|██████▋   | 2/3 [00:02&lt;00:01,  1.01s/it]
simulate:2+estimate:1+mse:1: 100%|██████████| 3/3 [00:07&lt;00:00,  2.33s/it]
DSC:  75%|███████▌  | 3/4 [00:37&lt;00:12, 12.35s/it]
simulate:2+estimate:2+mse:1:   0%|          | 0/3 [00:00&lt;?, ?it/s]
simulate:2+estimate:2+mse:1:  33%|███▎      | 1/3 [00:01&lt;00:02,  1.01s/it]
simulate:2+estimate:2+mse:1:  67%|██████▋   | 2/3 [00:06&lt;00:02,  2.31s/it]
simulate:2+estimate:2+mse:1: 100%|██████████| 3/3 [00:11&lt;00:00,  3.21s/it]
DSC: 100%|██████████| 4/4 [00:49&lt;00:00, 12.17s/it]
INFO: Building output database <span class="ansi-green-fg">dsc_result.rds</span> ...
INFO: DSC complete!
INFO: Elapsed time <span class="ansi-green-fg">50.566</span> seconds.
</pre>
</div>
</div>

</div>
</div>

</div>
    </div>
  </div>
</body>

 


</html>
